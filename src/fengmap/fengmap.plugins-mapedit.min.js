/**Released Version v3.1.0,BUILD 1329,Time 1666271059423. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.fengmap=i():t.fengmap=i()}(this,function(){return s={},h.m=n=[function(t,i,n){"use strict";n.r(i);for(var h=[],s=0;s<256;s++)h[s]=(s<16?"0":"")+s.toString(16);var d={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(h[255&t]+h[t>>8&255]+h[t>>16&255]+h[t>>24&255]+"-"+h[255&i]+h[i>>8&255]+"-"+h[i>>16&15|64]+h[i>>24&255]+"-"+h[63&n|128]+h[n>>8&255]+"-"+h[n>>16&255]+h[n>>24&255]+h[255&s]+h[s>>8&255]+h[s>>16&255]+h[s>>24&255]).toUpperCase()},clamp:function(t,i,n){return Math.max(i,Math.min(n,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,n,s,h){return s+(t-i)*(h-s)/(n-i)},lerp:function(t,i,n){return(1-n)*t+n*i},smoothstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*(3-2*t)},smootherstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*d.DEG2RAD},radToDeg:function(t){return t*d.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,n,s,h){var e=Math.cos,r=Math.sin,o=e(n/2),u=r(n/2),a=e((i+s)/2),c=r((i+s)/2),f=e((i-s)/2),n=r((i-s)/2),e=e((s-i)/2),i=r((s-i)/2);"XYX"===h?t.set(o*c,u*f,u*n,o*a):"YZY"===h?t.set(u*n,o*c,u*f,o*a):"ZXZ"===h?t.set(u*f,u*n,o*c,o*a):"XZX"===h?t.set(o*c,u*i,u*e,o*a):"YXY"===h?t.set(u*e,o*c,u*i,o*a):"ZYZ"===h?t.set(u*i,u*e,o*c,o*a):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function e(t,i,n,s){this.e=t||0,this.u=i||0,this.f=n||0,this.v=void 0!==s?s:1}Object.assign(e,{slerp:function(t,i,n,s){return n.copy(t).slerp(i,s)},slerpFlat:function(t,i,n,s,h,e,r){var o=n[s+0],u=n[s+1],a=n[s+2],c=n[s+3],f=h[e+0],l=h[e+1],v=h[e+2],d=h[e+3];c===d&&o===f&&u===l&&a===v||(n=1-r,h=0<=(s=o*f+u*l+a*v+c*d)?1:-1,(e=1-s*s)>Number.EPSILON&&(e=Math.sqrt(e),s=Math.atan2(e,s*h),n=Math.sin(n*s)/e,r=Math.sin(r*s)/e),o=o*n+f*(h=r*h),u=u*n+l*h,a=a*n+v*h,c=c*n+d*h,n===1-r&&(o*=r=1/Math.sqrt(o*o+u*u+a*a+c*c),u*=r,a*=r,c*=r)),t[i]=o,t[i+1]=u,t[i+2]=a,t[i+3]=c}}),Object.defineProperties(e.prototype,{x:{get:function(){return this.e},set:function(t){this.e=t,this.M()}},y:{get:function(){return this.u},set:function(t){this.u=t,this.M()}},z:{get:function(){return this.f},set:function(t){this.f=t,this.M()}},w:{get:function(){return this.v},set:function(t){this.v=t,this.M()}}}),Object.assign(e.prototype,{isQuaternion:!0,set:function(t,i,n,s){return this.e=t,this.u=i,this.f=n,this.v=s,this.M(),this},clone:function(){return new this.constructor(this.e,this.u,this.f,this.v)},copy:function(t){return this.e=t.x,this.u=t.y,this.f=t.z,this.v=t.w,this.M(),this},setFromEuler:function(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t.e,s=t.u,h=t.f,e=t.order,r=Math.cos,o=Math.sin,u=r(n/2),t=r(s/2),r=r(h/2),n=o(n/2),s=o(s/2),h=o(h/2);return"XYZ"===e?(this.e=n*t*r+u*s*h,this.u=u*s*r-n*t*h,this.f=u*t*h+n*s*r,this.v=u*t*r-n*s*h):"YXZ"===e?(this.e=n*t*r+u*s*h,this.u=u*s*r-n*t*h,this.f=u*t*h-n*s*r,this.v=u*t*r+n*s*h):"ZXY"===e?(this.e=n*t*r-u*s*h,this.u=u*s*r+n*t*h,this.f=u*t*h+n*s*r,this.v=u*t*r-n*s*h):"ZYX"===e?(this.e=n*t*r-u*s*h,this.u=u*s*r+n*t*h,this.f=u*t*h-n*s*r,this.v=u*t*r+n*s*h):"YZX"===e?(this.e=n*t*r+u*s*h,this.u=u*s*r+n*t*h,this.f=u*t*h-n*s*r,this.v=u*t*r-n*s*h):"XZY"===e&&(this.e=n*t*r-u*s*h,this.u=u*s*r-n*t*h,this.f=u*t*h+n*s*r,this.v=u*t*r+n*s*h),!1!==i&&this.M(),this},setFromAxisAngle:function(t,i){var n=i/2,i=Math.sin(n);return this.e=t.x*i,this.u=t.y*i,this.f=t.z*i,this.v=Math.cos(n),this.M(),this},setFromRotationMatrix:function(t){var i,n=t.elements,s=n[0],h=n[4],e=n[8],r=n[1],o=n[5],u=n[9],a=n[2],c=n[6],t=n[10],n=s+o+t;return 0<n?(i=.5/Math.sqrt(n+1),this.v=.25/i,this.e=(c-u)*i,this.u=(e-a)*i,this.f=(r-h)*i):o<s&&t<s?(i=2*Math.sqrt(1+s-o-t),this.v=(c-u)/i,this.e=.25*i,this.u=(h+r)/i,this.f=(e+a)/i):t<o?(i=2*Math.sqrt(1+o-s-t),this.v=(e-a)/i,this.e=(h+r)/i,this.u=.25*i,this.f=(u+c)/i):(i=2*Math.sqrt(1+t-s-o),this.v=(r-h)/i,this.e=(e+a)/i,this.u=(u+c)/i,this.f=.25*i),this.M(),this},setFromUnitVectors:function(t,i){var n=t.dot(i)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.e=-t.y,this.u=t.x,this.f=0):(this.e=0,this.u=-t.z,this.f=t.y)):(this.e=t.y*i.z-t.z*i.y,this.u=t.z*i.x-t.x*i.z,this.f=t.x*i.y-t.y*i.x),this.v=n,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(d.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,i){var n=this.angleTo(t);if(0===n)return this;n=Math.min(1,i/n);return this.slerp(t,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.e*=-1,this.u*=-1,this.f*=-1,this.M(),this},dot:function(t){return this.e*t.e+this.u*t.u+this.f*t.f+this.v*t.v},lengthSq:function(){return this.e*this.e+this.u*this.u+this.f*this.f+this.v*this.v},length:function(){return Math.sqrt(this.e*this.e+this.u*this.u+this.f*this.f+this.v*this.v)},normalize:function(){var t=this.length();return 0===t?(this.e=0,this.u=0,this.f=0,this.v=1):(this.e=this.e*(t=1/t),this.u=this.u*t,this.f=this.f*t,this.v=this.v*t),this.M(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var n=t.e,s=t.u,h=t.f,e=t.v,r=i.e,o=i.u,t=i.f,i=i.v;return this.e=n*i+e*r+s*t-h*o,this.u=s*i+e*o+h*r-n*t,this.f=h*i+e*t+n*o-s*r,this.v=e*i-n*r-s*o-h*t,this.M(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var n=this.e,s=this.u,h=this.f,e=this.v,r=e*t.v+n*t.e+s*t.u+h*t.f;if(r<0?(this.v=-t.v,this.e=-t.e,this.u=-t.u,this.f=-t.f,r=-r):this.copy(t),1<=r)return this.v=e,this.e=n,this.u=s,this.f=h,this;t=1-r*r;if(t<=Number.EPSILON){var o=1-i;return this.v=o*e+i*this.v,this.e=o*n+i*this.e,this.u=o*s+i*this.u,this.f=o*h+i*this.f,this.normalize(),this.M(),this}o=Math.sqrt(t),t=Math.atan2(o,r),r=Math.sin((1-i)*t)/o,o=Math.sin(i*t)/o;return this.v=e*r+this.v*o,this.e=n*r+this.e*o,this.u=s*r+this.u*o,this.f=h*r+this.f*o,this.M(),this},equals:function(t){return t.e===this.e&&t.u===this.u&&t.f===this.f&&t.v===this.v},fromArray:function(t,i){return this.e=t[i=void 0===i?0:i],this.u=t[i+1],this.f=t[i+2],this.v=t[i+3],this.M(),this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.e,t[i+1]=this.u,t[i+2]=this.f,t[i+3]=this.v,t},fromBufferAttribute:function(t,i){return this.e=t.getX(i),this.u=t.getY(i),this.f=t.getZ(i),this.v=t.getW(i),this},A:function(t){return this.M=t,this},M:function(){}});var r=new g,o=new e;function g(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0}Object.assign(g.prototype,{isVector3:!0,set:function(t,i,n){return this.x=t,this.y=i,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(o.setFromEuler(t))},applyAxisAngle:function(t,i){return this.applyQuaternion(o.setFromAxisAngle(t,i))},applyMatrix3:function(t){var i=this.x,n=this.y,s=this.z,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6]*s,this.y=t[1]*i+t[4]*n+t[7]*s,this.z=t[2]*i+t[5]*n+t[8]*s,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var i=this.x,n=this.y,s=this.z,h=t.elements,t=1/(h[3]*i+h[7]*n+h[11]*s+h[15]);return this.x=(h[0]*i+h[4]*n+h[8]*s+h[12])*t,this.y=(h[1]*i+h[5]*n+h[9]*s+h[13])*t,this.z=(h[2]*i+h[6]*n+h[10]*s+h[14])*t,this},applyQuaternion:function(t){var i=this.x,n=this.y,s=this.z,h=t.x,e=t.y,r=t.z,o=t.w,u=o*i+e*s-r*n,a=o*n+r*i-h*s,t=o*s+h*n-e*i,s=-h*i-e*n-r*s;return this.x=u*o+s*-h+a*-r-t*-e,this.y=a*o+s*-e+t*-h-u*-r,this.z=t*o+s*-r+u*-e-a*-h,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var i=this.x,n=this.y,s=this.z,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*s,this.y=t[1]*i+t[5]*n+t[9]*s,this.z=t[2]*i+t[6]*n+t[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},cross:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)},crossVectors:function(t,i){var n=t.x,s=t.y,h=t.z,e=i.x,t=i.y,i=i.z;return this.x=s*i-h*t,this.y=h*e-n*i,this.z=n*t-s*e,this},projectOnVector:function(t){var i=t.lengthSq();if(0===i)return this.set(0,0,0);i=t.dot(this)/i;return this.copy(t).multiplyScalar(i)},projectOnPlane:function(t){return r.copy(this).projectOnVector(t),this.sub(r)},reflect:function(t){return this.sub(r.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===i)return Math.PI/2;i=this.dot(t)/i;return Math.acos(d.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return i*i+n*n+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,i,n){var s=Math.sin(i)*t;return this.x=s*Math.sin(n),this.y=Math.cos(i)*t,this.z=s*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this},setFromMatrixPosition:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},setFromMatrix3Column:function(t,i){return this.fromArray(t.elements,3*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}});var u=new g,a=new p,c=new g(0,0,0),f=new g(1,1,1),l=new g,v=new g,M=new g;function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function y(){this.type="Curve",this.arcLengthDivisions=200}function R(t,i){this.x=t||0,this.y=i||0}function m(t,i,n,s,h,e,r,o){y.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=i||0,this.xRadius=n||1,this.yRadius=s||1,this.aStartAngle=h||0,this.aEndAngle=e||2*Math.PI,this.aClockwise=r||!1,this.aRotation=o||0}Object.assign(p.prototype,{isMatrix4:!0,set:function(t,i,n,s,h,e,r,o,u,a,c,f,l,v,d,M){var p=this.elements;return p[0]=t,p[4]=i,p[8]=n,p[12]=s,p[1]=h,p[5]=e,p[9]=r,p[13]=o,p[2]=u,p[6]=a,p[10]=c,p[14]=f,p[3]=l,p[7]=v,p[11]=d,p[15]=M,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new p).fromArray(this.elements)},copy:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],this},copyPosition:function(t){var i=this.elements,t=t.elements;return i[12]=t[12],i[13]=t[13],i[14]=t[14],this},extractBasis:function(t,i,n){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,n){return this.set(t.x,i.x,n.x,0,t.y,i.y,n.y,0,t.z,i.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var i=this.elements,n=t.elements,s=1/u.setFromMatrixColumn(t,0).length(),h=1/u.setFromMatrixColumn(t,1).length(),t=1/u.setFromMatrixColumn(t,2).length();return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=0,i[4]=n[4]*h,i[5]=n[5]*h,i[6]=n[6]*h,i[7]=0,i[8]=n[8]*t,i[9]=n[9]*t,i[10]=n[10]*t,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i,n,s,h,e,r,o,u,a,c,f,l,v=this.elements,d=t.x,M=t.y,p=t.z,y=Math.cos(d),m=Math.sin(d),w=Math.cos(M),d=Math.sin(M),M=Math.cos(p),p=Math.sin(p);return"XYZ"===t.order?(e=y*M,r=y*p,o=m*M,u=m*p,v[0]=w*M,v[4]=-w*p,v[8]=d,v[1]=r+o*d,v[5]=e-u*d,v[9]=-m*w,v[2]=u-e*d,v[6]=o+r*d,v[10]=y*w):"YXZ"===t.order?(n=w*p,s=d*M,v[0]=(i=w*M)+(h=d*p)*m,v[4]=s*m-n,v[8]=y*d,v[1]=y*p,v[5]=y*M,v[9]=-m,v[2]=n*m-s,v[6]=h+i*m,v[10]=y*w):"ZXY"===t.order?(n=w*p,s=d*M,v[0]=(i=w*M)-(h=d*p)*m,v[4]=-y*p,v[8]=s+n*m,v[1]=n+s*m,v[5]=y*M,v[9]=h-i*m,v[2]=-y*d,v[6]=m,v[10]=y*w):"ZYX"===t.order?(e=y*M,r=y*p,o=m*M,u=m*p,v[0]=w*M,v[4]=o*d-r,v[8]=e*d+u,v[1]=w*p,v[5]=u*d+e,v[9]=r*d-o,v[2]=-d,v[6]=m*w,v[10]=y*w):"YZX"===t.order?(a=y*w,c=y*d,f=m*w,l=m*d,v[0]=w*M,v[4]=l-a*p,v[8]=f*p+c,v[1]=p,v[5]=y*M,v[9]=-m*M,v[2]=-d*M,v[6]=c*p+f,v[10]=a-l*p):"XZY"===t.order&&(a=y*w,c=y*d,f=m*w,l=m*d,v[0]=w*M,v[4]=-p,v[8]=d*M,v[1]=a*p+l,v[5]=y*M,v[9]=c*p-f,v[2]=f*p-c,v[6]=m*M,v[10]=l*p+a),v[3]=0,v[7]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(c,t,f)},lookAt:function(t,i,n){var s=this.elements;return M.subVectors(t,i),0===M.lengthSq()&&(M.z=1),M.normalize(),l.crossVectors(n,M),0===l.lengthSq()&&(1===Math.abs(n.z)?M.x+=1e-4:M.z+=1e-4,M.normalize(),l.crossVectors(n,M)),l.normalize(),v.crossVectors(M,l),s[0]=l.x,s[4]=v.x,s[8]=M.x,s[1]=l.y,s[5]=v.y,s[9]=M.y,s[2]=l.z,s[6]=v.z,s[10]=M.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var n=t.elements,s=i.elements,h=this.elements,e=n[0],r=n[4],o=n[8],u=n[12],a=n[1],c=n[5],f=n[9],l=n[13],v=n[2],d=n[6],M=n[10],p=n[14],y=n[3],m=n[7],w=n[11],g=n[15],b=s[0],A=s[4],E=s[8],R=s[12],x=s[1],T=s[5],S=s[9],O=s[13],j=s[2],k=s[6],B=s[10],I=s[14],t=s[3],i=s[7],n=s[11],s=s[15];return h[0]=e*b+r*x+o*j+u*t,h[4]=e*A+r*T+o*k+u*i,h[8]=e*E+r*S+o*B+u*n,h[12]=e*R+r*O+o*I+u*s,h[1]=a*b+c*x+f*j+l*t,h[5]=a*A+c*T+f*k+l*i,h[9]=a*E+c*S+f*B+l*n,h[13]=a*R+c*O+f*I+l*s,h[2]=v*b+d*x+M*j+p*t,h[6]=v*A+d*T+M*k+p*i,h[10]=v*E+d*S+M*B+p*n,h[14]=v*R+d*O+M*I+p*s,h[3]=y*b+m*x+w*j+g*t,h[7]=y*A+m*T+w*k+g*i,h[11]=y*E+m*S+w*B+g*n,h[15]=y*R+m*O+w*I+g*s,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[4],s=t[8],h=t[12],e=t[1],r=t[5],o=t[9],u=t[13],a=t[2],c=t[6],f=t[10],l=t[14];return t[3]*(+h*o*c-s*u*c-h*r*f+n*u*f+s*r*l-n*o*l)+t[7]*(+i*o*l-i*u*f+h*e*f-s*e*l+s*u*a-h*o*a)+t[11]*(+i*u*c-i*r*l-h*e*c+n*e*l+h*r*a-n*u*a)+t[15]*(-s*r*a-i*o*c+i*r*f+s*e*c-n*e*f+n*o*a)},transpose:function(){var t=this.elements,i=t[1];return t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this},setPosition:function(t,i,n){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=i,s[14]=n),this},getInverse:function(t,i){void 0!==i&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,s=t.elements,h=s[0],e=s[1],r=s[2],o=s[3],u=s[4],a=s[5],c=s[6],f=s[7],l=s[8],v=s[9],d=s[10],M=s[11],p=s[12],y=s[13],m=s[14],w=s[15],g=v*m*f-y*d*f+y*c*M-a*m*M-v*c*w+a*d*w,b=p*d*f-l*m*f-p*c*M+u*m*M+l*c*w-u*d*w,i=l*y*f-p*v*f+p*a*M-u*y*M-l*a*w+u*v*w,t=p*v*c-l*y*c-p*a*d+u*y*d+l*a*m-u*v*m,s=h*g+e*b+r*i+o*t;if(0==s)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);s=1/s;return n[0]=g*s,n[1]=(y*d*o-v*m*o-y*r*M+e*m*M+v*r*w-e*d*w)*s,n[2]=(a*m*o-y*c*o+y*r*f-e*m*f-a*r*w+e*c*w)*s,n[3]=(v*c*o-a*d*o-v*r*f+e*d*f+a*r*M-e*c*M)*s,n[4]=b*s,n[5]=(l*m*o-p*d*o+p*r*M-h*m*M-l*r*w+h*d*w)*s,n[6]=(p*c*o-u*m*o-p*r*f+h*m*f+u*r*w-h*c*w)*s,n[7]=(u*d*o-l*c*o+l*r*f-h*d*f-u*r*M+h*c*M)*s,n[8]=i*s,n[9]=(p*v*o-l*y*o-p*e*M+h*y*M+l*e*w-h*v*w)*s,n[10]=(u*y*o-p*a*o+p*e*f-h*y*f-u*e*w+h*a*w)*s,n[11]=(l*a*o-u*v*o-l*e*f+h*v*f+u*e*M-h*a*M)*s,n[12]=t*s,n[13]=(l*y*r-p*v*r+p*e*d-h*y*d-l*e*m+h*v*m)*s,n[14]=(p*a*r-u*y*r-p*e*c+h*y*c+u*e*m-h*a*m)*s,n[15]=(u*v*r-l*a*r+l*e*c-h*v*c-u*e*d+h*a*d)*s,this},scale:function(t){var i=this.elements,n=t.x,s=t.y,t=t.z;return i[0]*=n,i[4]*=s,i[8]*=t,i[1]*=n,i[5]*=s,i[9]*=t,i[2]*=n,i[6]*=s,i[10]*=t,i[3]*=n,i[7]*=s,i[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,n,t))},makeTranslation:function(t,i,n){return this.set(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,i,-t,0,0,t,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,0,t,0,0,1,0,0,-t,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,-t,0,0,t,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var n=Math.cos(i),s=Math.sin(i),h=1-n,e=t.x,r=t.y,o=t.z,i=h*e,t=h*r;return this.set(i*e+n,i*r-s*o,i*o+s*r,0,i*r+s*o,t*r+n,t*o-s*e,0,i*o-s*r,t*o+s*e,h*o*o+n,0,0,0,0,1),this},makeScale:function(t,i,n){return this.set(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,i,n){return this.set(1,i,n,0,t,1,n,0,t,i,1,0,0,0,0,1),this},compose:function(t,i,n){var s=this.elements,h=i.e,e=i.u,r=i.f,o=i.v,u=h+h,a=e+e,c=r+r,f=h*u,l=h*a,v=h*c,i=e*a,h=e*c,e=r*c,r=o*u,u=o*a,a=o*c,o=n.x,c=n.y,n=n.z;return s[0]=(1-(i+e))*o,s[1]=(l+a)*o,s[2]=(v-u)*o,s[3]=0,s[4]=(l-a)*c,s[5]=(1-(f+e))*c,s[6]=(h+r)*c,s[7]=0,s[8]=(v+u)*n,s[9]=(h-r)*n,s[10]=(1-(f+i))*n,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:function(t,i,n){var s=this.elements,h=u.set(s[0],s[1],s[2]).length(),e=u.set(s[4],s[5],s[6]).length(),r=u.set(s[8],s[9],s[10]).length();this.determinant()<0&&(h=-h),t.x=s[12],t.y=s[13],t.z=s[14],a.copy(this);var o=1/h,t=1/e,s=1/r;return a.elements[0]*=o,a.elements[1]*=o,a.elements[2]*=o,a.elements[4]*=t,a.elements[5]*=t,a.elements[6]*=t,a.elements[8]*=s,a.elements[9]*=s,a.elements[10]*=s,i.setFromRotationMatrix(a),n.x=h,n.y=e,n.z=r,this},makePerspective:function(t,i,n,s,h,e){void 0===e&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var r=this.elements,o=2*h/(n-s),u=(i+t)/(i-t),n=(n+s)/(n-s),s=-(e+h)/(e-h),e=-2*e*h/(e-h);return r[0]=2*h/(i-t),r[4]=0,r[8]=u,r[12]=0,r[1]=0,r[5]=o,r[9]=n,r[13]=0,r[2]=0,r[6]=0,r[10]=s,r[14]=e,r[3]=0,r[7]=0,r[11]=-1,r[15]=0,this},makeOrthographic:function(t,i,n,s,h,e){var r=this.elements,o=1/(i-t),u=1/(n-s),a=1/(e-h),t=(i+t)*o,s=(n+s)*u,h=(e+h)*a;return r[0]=2*o,r[4]=0,r[8]=0,r[12]=-t,r[1]=0,r[5]=2*u,r[9]=0,r[13]=-s,r[2]=0,r[6]=0,r[10]=-2*a,r[14]=-h,r[3]=0,r[7]=0,r[11]=0,r[15]=1,this},equals:function(t){for(var i=this.elements,n=t.elements,s=0;s<16;s++)if(i[s]!==n[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<16;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){var n=this.elements;return(t=void 0===t?[]:t)[i=void 0===i?0:i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t[i+9]=n[9],t[i+10]=n[10],t[i+11]=n[11],t[i+12]=n[12],t[i+13]=n[13],t[i+14]=n[14],t[i+15]=n[15],t}}),Object.assign(y.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,i){t=this.getUtoTmapping(t);return this.getPoint(t,i)},getPoints:function(t){void 0===t&&(t=5);for(var i=[],n=0;n<=t;n++)i.push(this.getPoint(n/t));return i},getSpacedPoints:function(t){void 0===t&&(t=5);for(var i=[],n=0;n<=t;n++)i.push(this.getPointAt(n/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,n,s=[],h=this.getPoint(0),e=0;for(s.push(0),n=1;n<=t;n++)e+=(i=this.getPoint(n/t)).distanceTo(h),s.push(e),h=i;return this.cacheArcLengths=s},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){for(var n,s=this.getLengths(),h=0,e=s.length,r=i||t*s[e-1],o=0,u=e-1;o<=u;)if((n=s[h=Math.floor(o+(u-o)/2)]-r)<0)o=h+1;else{if(!(0<n)){u=h;break}u=h-1}if(s[h=u]===r)return h/(e-1);t=s[h];return(h+(r-t)/(s[h+1]-t))/(e-1)},getTangent:function(t){var i=t-1e-4,t=t+1e-4;1<t&&(t=1);i=this.getPoint(i=i<0?0:i);return this.getPoint(t).clone().sub(i).normalize()},getTangentAt:function(t){t=this.getUtoTmapping(t);return this.getTangent(t)},computeFrenetFrames:function(t,i){for(var n,s=new g,h=[],e=[],r=[],o=new g,u=new p,a=0;a<=t;a++)h[a]=this.getTangentAt(a/t),h[a].normalize();e[0]=new g,r[0]=new g;var c=Number.MAX_VALUE,f=Math.abs(h[0].x),l=Math.abs(h[0].y),v=Math.abs(h[0].z);for(f<=c&&(c=f,s.set(1,0,0)),l<=c&&(c=l,s.set(0,1,0)),v<=c&&s.set(0,0,1),o.crossVectors(h[0],s).normalize(),e[0].crossVectors(h[0],o),r[0].crossVectors(h[0],e[0]),a=1;a<=t;a++)e[a]=e[a-1].clone(),r[a]=r[a-1].clone(),o.crossVectors(h[a-1],h[a]),o.length()>Number.EPSILON&&(o.normalize(),n=Math.acos(d.clamp(h[a-1].dot(h[a]),-1,1)),e[a].applyMatrix4(u.makeRotationAxis(o,n))),r[a].crossVectors(h[a],e[a]);if(!0===i)for(n=Math.acos(d.clamp(e[0].dot(e[t]),-1,1)),n/=t,0<h[0].dot(o.crossVectors(e[0],e[t]))&&(n=-n),a=1;a<=t;a++)e[a].applyMatrix4(u.makeRotationAxis(h[a],n*a)),r[a].crossVectors(h[a],e[a]);return{tangents:h,normals:e,binormals:r}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Object.defineProperties(R.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(R.prototype,{isVector2:!0,set:function(t,i){return this.x=t,this.y=i,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var i=this.x,n=this.y,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6],this.y=t[1]*i+t[4]*n+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,t=this.y-t.y;return i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this},rotateAround:function(t,i){var n=Math.cos(i),s=Math.sin(i),h=this.x-t.x,i=this.y-t.y;return this.x=h*n-i*s+t.x,this.y=h*s+i*n+t.y,this}}),((m.prototype=Object.create(y.prototype)).constructor=m).prototype.isEllipseCurve=!0,m.prototype.getPoint=function(t,i){for(var n=i||new R,s=2*Math.PI,h=this.aEndAngle-this.aStartAngle,e=Math.abs(h)<Number.EPSILON;h<0;)h+=s;for(;s<h;)h-=s;h<Number.EPSILON&&(h=e?0:s),!0!==this.aClockwise||e||(h===s?h=-s:h-=s);var r=this.aStartAngle+t*h,o=this.aX+this.xRadius*Math.cos(r),u=this.aY+this.yRadius*Math.sin(r);return 0!==this.aRotation&&(i=Math.cos(this.aRotation),e=Math.sin(this.aRotation),o=(t=o-this.aX)*i-(r=u-this.aY)*e+this.aX,u=t*e+r*i+this.aY),n.set(o,u)},m.prototype.copy=function(t){return y.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this};var w={FULL:0,DOTTED:2,DOT_DASH:4,CENTER:8,DASH:16,DOUBLE_DOT_DASH:32,TRI_DOT_DASH:64,FMARROW:128,ARROW:256},b=new g,A=new g,E=new g,x=new g,T=new g,S=new g,O=new g;function j(t,i){this.origin=void 0!==t?t:new g,this.direction=void 0!==i?i:new g(0,0,-1)}function k(){this.mask=1}function B(t,i,n,s){this.ray=new j(t,i),this.near=n||0,this.far=s||1/0,this.camera=null,this.layers=new k,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function I(t,i){return t.distance-i.distance}function V(t,i,n,s){if(t.layers.test(i.layers)&&t.raycast(i,n),!0===s)for(var h=t.children,e=0,r=h.length;e<r;e++)V(h[e],i,n,!0)}Object.assign(j.prototype,{set:function(t,i){return this.origin.copy(t),this.direction.copy(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,i){return void 0===i&&(console.warn("THREE.Ray: .at() target is now required"),i=new g),i.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,b)),this},closestPointToPoint:function(t,i){void 0===i&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),i=new g),i.subVectors(t,this.origin);t=i.dot(this.direction);return t<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var i=b.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(b.copy(this.direction).multiplyScalar(i).add(this.origin),b.distanceToSquared(t))},distanceSqToSegment:function(t,i,n,s){A.copy(t).add(i).multiplyScalar(.5),E.copy(i).sub(t).normalize(),x.copy(this.origin).sub(A);var h,e,r=.5*t.distanceTo(i),o=-this.direction.dot(E),u=x.dot(this.direction),a=-x.dot(E),c=x.lengthSq(),t=Math.abs(1-o*o);return c=0<t?(e=o*u-a,i=r*t,0<=(h=o*a-u)?-i<=e?e<=i?(h*=t=1/t)*(h+o*(e*=t)+2*u)+e*(o*h+e+2*a)+c:(e=r,-(h=Math.max(0,-(o*e+u)))*h+e*(e+2*a)+c):(e=-r,-(h=Math.max(0,-(o*e+u)))*h+e*(e+2*a)+c):e<=-i?-(h=Math.max(0,-(-o*r+u)))*h+(e=0<h?-r:Math.min(Math.max(-r,-a),r))*(e+2*a)+c:e<=i?(h=0,(e=Math.min(Math.max(-r,-a),r))*(e+2*a)+c):-(h=Math.max(0,-(o*r+u)))*h+(e=0<h?r:Math.min(Math.max(-r,-a),r))*(e+2*a)+c):(e=0<o?-r:r,-(h=Math.max(0,-(o*e+u)))*h+e*(e+2*a)+c),n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),s&&s.copy(E).multiplyScalar(e).add(A),c},intersectSphere:function(t,i){b.subVectors(t.center,this.origin);var n=b.dot(this.direction),s=b.dot(b)-n*n,t=t.radius*t.radius;if(t<s)return null;t=Math.sqrt(t-s),s=n-t,t=n+t;return s<0&&t<0?null:s<0?this.at(t,i):this.at(s,i)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var i=t.normal.dot(this.direction);if(0===i)return 0===t.distanceToPoint(this.origin)?0:null;i=-(this.origin.dot(t.normal)+t.constant)/i;return 0<=i?i:null},intersectPlane:function(t,i){t=this.distanceToPlane(t);return null===t?null:this.at(t,i)},intersectsPlane:function(t){var i=t.distanceToPoint(this.origin);return 0===i||t.normal.dot(this.direction)*i<0},intersectBox:function(t,i){var n,s,h,e=1/this.direction.x,r=1/this.direction.y,o=1/this.direction.z,u=this.origin,e=0<=e?(n=(t.min.x-u.x)*e,(t.max.x-u.x)*e):(n=(t.max.x-u.x)*e,(t.min.x-u.x)*e),r=0<=r?(s=(t.min.y-u.y)*r,(t.max.y-u.y)*r):(s=(t.max.y-u.y)*r,(t.min.y-u.y)*r);return r<n||e<s?null:((r<e||e!=e)&&(e=r),(o=0<=o?(h=(t.min.z-u.z)*o,(t.max.z-u.z)*o):(h=(t.max.z-u.z)*o,(t.min.z-u.z)*o))<(n=n<s||n!=n?s:n)||e<h?null:((n<h||n!=n)&&(n=h),(e=o<e||e!=e?o:e)<0?null:this.at(0<=n?n:e,i)))},intersectsBox:function(t){return null!==this.intersectBox(t,b)},intersectTriangle:function(t,i,n,s,h){T.subVectors(i,t),S.subVectors(n,t),O.crossVectors(T,S);n=this.direction.dot(O);if(0<n){if(s)return null;e=1}else{if(!(n<0))return null;e=-1,n=-n}x.subVectors(this.origin,t);s=e*this.direction.dot(S.crossVectors(x,S));if(s<0)return null;t=e*this.direction.dot(T.cross(x));if(t<0)return null;if(n<s+t)return null;var e=-e*x.dot(O);return e<0?null:this.at(e/n,h)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(k.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(B.prototype,{set:function(t,i){this.ray.set(t,i)},setFromCamera:function(t,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,i,n){n=n||[];return V(t,this,n,i),n.sort(I),n},intersectObjects:function(t,i,n){var s=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),s;for(var h=0,e=t.length;h<e;h++)V(t[h],this,s,i);return s.sort(I),s}});var C={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},H={h:0,s:0,l:0},F={h:0,s:0,l:0};function P(t,i,n){return void 0===i&&void 0===n?this.set(t):this.setRGB(t,i,n)}function L(t,i,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(i-t)*n:n<.5?i:n<2/3?t+6*(i-t)*(2/3-n):t}function Y(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function D(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}Object.assign(P.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,i,n){return this.r=t,this.g=i,this.b=n,this},setHSL:function(t,i,n){return t=d.euclideanModulo(t,1),i=d.clamp(i,0,1),n=d.clamp(n,0,1),0===i?this.r=this.g=this.b=n:(this.r=L(i=2*n-(n=n<=.5?n*(1+i):n+i-n*i),n,t+1/3),this.g=L(i,n,t),this.b=L(i,n,t-1/3)),this},setStyle:function(i){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}if(u=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(i)){var n,s=u[1],h=u[2];switch(s){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(h)){var e=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(e,r,o)}}}else if(u=/^\#([A-Fa-f0-9]+)$/.exec(i)){var s=u[1],u=s.length;if(3===u)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return i&&0<i.length?this.setColorName(i):this},setColorName:function(t){var i=C[t];return void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,i){return void 0===i&&(i=2),this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},copyLinearToGamma:function(t,i){i=0<(i=void 0===i?2:i)?1/i:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Y(t.r),this.g=Y(t.g),this.b=Y(t.b),this},copyLinearToSRGB:function(t){return this.r=D(t.r),this.g=D(t.g),this.b=D(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var i,n=this.r,s=this.g,h=this.b,e=Math.max(n,s,h),r=Math.min(n,s,h),o=(r+e)/2;if(r===e)a=i=0;else{var u=e-r,a=o<=.5?u/(e+r):u/(2-e-r);switch(e){case n:i=(s-h)/u+(s<h?6:0);break;case s:i=(h-n)/u+2;break;case h:i=(n-s)/u+4}i/=6}return t.h=i,t.s=a,t.l=o,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,i,n){return this.getHSL(H),H.h+=t,H.s+=i,H.l+=n,this.setHSL(H.h,H.s,H.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this},lerpHSL:function(t,i){this.getHSL(H),t.getHSL(F);var n=d.lerp(H.h,F.h,i),t=d.lerp(H.s,F.s,i),i=d.lerp(H.l,F.l,i);return this.setHSL(n,t,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,i){return this.r=t[i=void 0===i?0:i],this.g=t[i+1],this.b=t[i+2],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}}),P.NAMES=C;var _=[new g,new g,new g,new g,new g,new g,new g,new g],X=new g,N=new tt,U=new g,Z=new g,G=new g,q=new g,Q=new g,z=new g,W=new g,J=new g,K=new g,$=new g;function tt(t,i){this.min=void 0!==t?t:new g(1/0,1/0,1/0),this.max=void 0!==i?i:new g(-1/0,-1/0,-1/0)}function it(t,i,n,s,h){for(var e=0,r=t.length-3;e<=r;e+=3){$.fromArray(t,e);var o=h.x*Math.abs($.x)+h.y*Math.abs($.y)+h.z*Math.abs($.z),u=i.dot($),a=n.dot($),c=s.dot($);if(Math.max(-Math.max(u,a,c),Math.min(u,a,c))>o)return!1}return!0}function nt(){}function st(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1}Object.assign(tt.prototype,{isBox3:!0,set:function(t,i){return this.min.copy(t),this.max.copy(i),this},setFromArray:function(t){for(var i=1/0,n=1/0,s=1/0,h=-1/0,e=-1/0,r=-1/0,o=0,u=t.length;o<u;o+=3){var a=t[o],c=t[o+1],f=t[o+2];a<i&&(i=a),c<n&&(n=c),f<s&&(s=f),h<a&&(h=a),e<c&&(e=c),r<f&&(r=f)}return this.min.set(i,n,s),this.max.set(h,e,r),this},setFromBufferAttribute:function(t){for(var i=1/0,n=1/0,s=1/0,h=-1/0,e=-1/0,r=-1/0,o=0,u=t.count;o<u;o++){var a=t.getX(o),c=t.getY(o),f=t.getZ(o);a<i&&(i=a),c<n&&(n=c),f<s&&(s=f),h<a&&(h=a),e<c&&(e=c),r<f&&(r=f)}return this.min.set(i,n,s),this.max.set(h,e,r),this},setFromPoints:function(t){this.makeEmpty();for(var i=0,n=t.length;i<n;i++)this.expandByPoint(t[i]);return this},setFromCenterAndSize:function(t,i){i=X.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new g),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new g),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var i=t.geometry;void 0!==i&&(null===i.boundingBox&&i.computeBoundingBox(),N.copy(i.boundingBox),N.applyMatrix4(t.matrixWorld),this.union(N));for(var n=t.children,s=0,h=n.length;s<h;s++)this.expandByObject(n[s]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,i){return void 0===i&&(console.warn("THREE.Box3: .getParameter() target is now required"),i=new g),i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,X),X.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var i,n=0<t.normal.x?(i=t.normal.x*this.min.x,t.normal.x*this.max.x):(i=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(i+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(i+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),i<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(W),J.subVectors(this.max,W),U.subVectors(t.a,W),Z.subVectors(t.b,W),G.subVectors(t.c,W),q.subVectors(Z,U),Q.subVectors(G,Z),z.subVectors(U,G);t=[0,-q.z,q.y,0,-Q.z,Q.y,0,-z.z,z.y,q.z,0,-q.x,Q.z,0,-Q.x,z.z,0,-z.x,-q.y,q.x,0,-Q.y,Q.x,0,-z.y,z.x,0];return!!it(t,U,Z,G,J)&&(!!it(t=[1,0,0,0,1,0,0,0,1],U,Z,G,J)&&(K.crossVectors(q,Q),it(t=[K.x,K.y,K.z],U,Z,G,J)))},clampPoint:function(t,i){return void 0===i&&(console.warn("THREE.Box3: .clampPoint() target is now required"),i=new g),i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return X.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(X).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(_)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(nt.prototype,{addEventListener:function(t,i){void 0===this.R&&(this.R={});var n=this.R;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(i)&&n[t].push(i)},hasEventListener:function(t,i){if(void 0===this.R)return!1;var n=this.R;return void 0!==n[t]&&-1!==n[t].indexOf(i)},removeEventListener:function(t,i){void 0!==this.R&&(void 0===(t=this.R[t])||-1!==(i=t.indexOf(i))&&t.splice(i,1))},dispatchEvent:function(t){if(void 0!==this.R){var i=this.R[t.type];if(void 0!==i){t.target=this;for(var n=i.slice(0),s=0,h=n.length;s<h;s++)n[s].call(this,t)}}}}),Object.defineProperties(st.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(st.prototype,{isVector4:!0,set:function(t,i,n,s){return this.x=t,this.y=i,this.z=n,this.w=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var i=this.x,n=this.y,s=this.z,h=this.w,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*s+t[12]*h,this.y=t[1]*i+t[5]*n+t[9]*s+t[13]*h,this.z=t[2]*i+t[6]*n+t[10]*s+t[14]*h,this.w=t[3]*i+t[7]*n+t[11]*s+t[15]*h,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,n,s,h=t.elements,e=h[0],r=h[4],o=h[8],u=h[1],a=h[5],c=h[9],f=h[2],l=h[6],v=h[10];if(Math.abs(r-u)<.01&&Math.abs(o-f)<.01&&Math.abs(c-l)<.01){if(Math.abs(r+u)<.1&&Math.abs(o+f)<.1&&Math.abs(c+l)<.1&&Math.abs(e+a+v-3)<.1)return this.set(1,0,0,0),this;var d=Math.PI,M=(e+1)/2,p=(a+1)/2,y=(v+1)/2,m=(r+u)/4,t=(o+f)/4,h=(c+l)/4;return p<M&&y<M?s=M<.01?(i=0,n=.707106781):(n=m/(i=Math.sqrt(M)),t/i):y<p?s=p<.01?(n=0,i=.707106781):(i=m/(n=Math.sqrt(p)),h/n):y<.01?(n=i=.707106781,s=0):(i=t/(s=Math.sqrt(y)),n=h/s),this.set(i,n,s,d),this}d=Math.sqrt((l-c)*(l-c)+(o-f)*(o-f)+(u-r)*(u-r));return Math.abs(d)<.001&&(d=1),this.x=(l-c)/d,this.y=(o-f)/d,this.z=(u-r)/d,this.w=Math.acos((e+a+v-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}});var ht=0,et=1,rt=100,ot=204,ut=205,at=3,ct=7680,ft=519,lt=35044,vt=new g;function dt(t,i,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=i,this.count=void 0!==t?t.length/i:0,this.normalized=!0===n,this.usage=lt,this.updateRange={offset:0,count:-1},this.version=0}function Mt(t,i,n){dt.call(this,new Int8Array(t),i,n)}function pt(t,i,n){dt.call(this,new Uint8Array(t),i,n)}function yt(t,i,n){dt.call(this,new Uint8ClampedArray(t),i,n)}function mt(t,i,n){dt.call(this,new Int16Array(t),i,n)}function wt(t,i,n){dt.call(this,new Uint16Array(t),i,n)}function gt(t,i,n){dt.call(this,new Int32Array(t),i,n)}function bt(t,i,n){dt.call(this,new Uint32Array(t),i,n)}function At(t,i,n){dt.call(this,new Float32Array(t),i,n)}function Et(t,i,n){dt.call(this,new Float64Array(t),i,n)}Object.defineProperty(dt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(dt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,i,n){t*=this.itemSize,n*=i.itemSize;for(var s=0,h=this.itemSize;s<h;s++)this.array[t+s]=i.array[n+s];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var e=t[s];void 0===e&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),e=new P),i[n++]=e.r,i[n++]=e.g,i[n++]=e.b}return this},copyVector2sArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var e=t[s];void 0===e&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),e=new R),i[n++]=e.x,i[n++]=e.y}return this},copyVector3sArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var e=t[s];void 0===e&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),e=new g),i[n++]=e.x,i[n++]=e.y,i[n++]=e.z}return this},copyVector4sArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var e=t[s];void 0===e&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),e=new st),i[n++]=e.x,i[n++]=e.y,i[n++]=e.z,i[n++]=e.w}return this},applyMatrix3:function(t){for(var i=0,n=this.count;i<n;i++)vt.x=this.getX(i),vt.y=this.getY(i),vt.z=this.getZ(i),vt.applyMatrix3(t),this.setXYZ(i,vt.x,vt.y,vt.z);return this},applyMatrix4:function(t){for(var i=0,n=this.count;i<n;i++)vt.x=this.getX(i),vt.y=this.getY(i),vt.z=this.getZ(i),vt.applyMatrix4(t),this.setXYZ(i,vt.x,vt.y,vt.z);return this},applyNormalMatrix:function(t){for(var i=0,n=this.count;i<n;i++)vt.x=this.getX(i),vt.y=this.getY(i),vt.z=this.getZ(i),vt.applyNormalMatrix(t),this.setXYZ(i,vt.x,vt.y,vt.z);return this},transformDirection:function(t){for(var i=0,n=this.count;i<n;i++)vt.x=this.getX(i),vt.y=this.getY(i),vt.z=this.getZ(i),vt.transformDirection(t),this.setXYZ(i,vt.x,vt.y,vt.z);return this},set:function(t,i){return this.array.set(t,i=void 0===i?0:i),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,i){return this.array[t*this.itemSize]=i,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,i){return this.array[t*this.itemSize+1]=i,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,i){return this.array[t*this.itemSize+2]=i,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,i){return this.array[t*this.itemSize+3]=i,this},setXY:function(t,i,n){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this},setXYZ:function(t,i,n,s){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=s,this},setXYZW:function(t,i,n,s,h){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=s,this.array[t+3]=h,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(Mt.prototype=Object.create(dt.prototype)).constructor=Mt,(pt.prototype=Object.create(dt.prototype)).constructor=pt,(yt.prototype=Object.create(dt.prototype)).constructor=yt,(mt.prototype=Object.create(dt.prototype)).constructor=mt,wt.prototype=Object.create(dt.prototype),wt.prototype.constructor=wt,(gt.prototype=Object.create(dt.prototype)).constructor=gt,bt.prototype=Object.create(dt.prototype),bt.prototype.constructor=bt,(At.prototype=Object.create(dt.prototype)).constructor=At,(Et.prototype=Object.create(dt.prototype)).constructor=Et;var Rt=new tt;function xt(t,i){this.center=void 0!==t?t:new g,this.radius=void 0!==i?i:0}function Tt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(xt.prototype,{set:function(t,i){return this.center.copy(t),this.radius=i,this},setFromPoints:function(t,i){var n=this.center;void 0!==i?n.copy(i):Rt.setFromPoints(t).getCenter(n);for(var s=0,h=0,e=t.length;h<e;h++)s=Math.max(s,n.distanceToSquared(t[h]));return this.radius=Math.sqrt(s),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,i){var n=this.center.distanceToSquared(t);return void 0===i&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),i=new g),i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new tt),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(Tt.prototype,{computeGroups:function(t){for(var i,n=[],s=void 0,h=t.faces,e=0;e<h.length;e++){var r=h[e];r.materialIndex!==s&&(s=r.materialIndex,void 0!==i&&(i.count=3*e-i.start,n.push(i)),i={start:3*e,materialIndex:s})}void 0!==i&&(i.count=3*e-i.start,n.push(i)),this.groups=n},fromGeometry:function(t){var i=t.faces,n=t.vertices,s=t.faceVertexUvs,h=s[0]&&0<s[0].length,e=s[1]&&0<s[1].length,r=t.morphTargets,o=r.length;if(0<o){for(var u=[],a=0;a<o;a++)u[a]={name:r[a].name,data:[]};this.morphTargets.position=u}var c=t.morphNormals,f=c.length;if(0<f){for(var l=[],a=0;a<f;a++)l[a]={name:c[a].name,data:[]};this.morphTargets.normal=l}var v=t.skinIndices,d=t.skinWeights,M=v.length===n.length,p=d.length===n.length;0<n.length&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(a=0;a<i.length;a++){var y=i[a];this.vertices.push(n[y.a],n[y.b],n[y.c]);var m=y.vertexNormals;3===m.length?this.normals.push(m[0],m[1],m[2]):(g=y.normal,this.normals.push(g,g,g));var w,g=y.vertexColors;3===g.length?this.colors.push(g[0],g[1],g[2]):(g=y.color,this.colors.push(g,g,g)),!0===h&&(void 0!==(w=s[0][a])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",a),this.uvs.push(new R,new R,new R))),!0===e&&(void 0!==(w=s[1][a])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",a),this.uvs2.push(new R,new R,new R)));for(var b=0;b<o;b++){var A=r[b].vertices;u[b].data.push(A[y.a],A[y.b],A[y.c])}for(b=0;b<f;b++){var E=c[b].vertexNormals[a];l[b].data.push(E.a,E.b,E.c)}M&&this.skinIndices.push(v[y.a],v[y.b],v[y.c]),p&&this.skinWeights.push(d[y.a],d[y.b],d[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var St=new p,Ot=new e;function jt(t,i,n,s){this.e=t||0,this.u=i||0,this.f=n||0,this.T=s||jt.DefaultOrder}function kt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}jt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],jt.DefaultOrder="XYZ",Object.defineProperties(jt.prototype,{x:{get:function(){return this.e},set:function(t){this.e=t,this.M()}},y:{get:function(){return this.u},set:function(t){this.u=t,this.M()}},z:{get:function(){return this.f},set:function(t){this.f=t,this.M()}},order:{get:function(){return this.T},set:function(t){this.T=t,this.M()}}}),Object.assign(jt.prototype,{isEuler:!0,set:function(t,i,n,s){return this.e=t,this.u=i,this.f=n,this.T=s||this.T,this.M(),this},clone:function(){return new this.constructor(this.e,this.u,this.f,this.T)},copy:function(t){return this.e=t.e,this.u=t.u,this.f=t.f,this.T=t.T,this.M(),this},setFromRotationMatrix:function(t,i,n){var s=d.clamp,h=t.elements,e=h[0],r=h[4],o=h[8],u=h[1],a=h[5],c=h[9],f=h[2],t=h[6],h=h[10];return"XYZ"===(i=i||this.T)?(this.u=Math.asin(s(o,-1,1)),Math.abs(o)<.9999999?(this.e=Math.atan2(-c,h),this.f=Math.atan2(-r,e)):(this.e=Math.atan2(t,a),this.f=0)):"YXZ"===i?(this.e=Math.asin(-s(c,-1,1)),Math.abs(c)<.9999999?(this.u=Math.atan2(o,h),this.f=Math.atan2(u,a)):(this.u=Math.atan2(-f,e),this.f=0)):"ZXY"===i?(this.e=Math.asin(s(t,-1,1)),Math.abs(t)<.9999999?(this.u=Math.atan2(-f,h),this.f=Math.atan2(-r,a)):(this.u=0,this.f=Math.atan2(u,e))):"ZYX"===i?(this.u=Math.asin(-s(f,-1,1)),Math.abs(f)<.9999999?(this.e=Math.atan2(t,h),this.f=Math.atan2(u,e)):(this.e=0,this.f=Math.atan2(-r,a))):"YZX"===i?(this.f=Math.asin(s(u,-1,1)),Math.abs(u)<.9999999?(this.e=Math.atan2(-c,a),this.u=Math.atan2(-f,e)):(this.e=0,this.u=Math.atan2(o,h))):"XZY"===i?(this.f=Math.asin(-s(r,-1,1)),Math.abs(r)<.9999999?(this.e=Math.atan2(t,a),this.u=Math.atan2(o,e)):(this.e=Math.atan2(-c,h),this.u=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this.T=i,!1!==n&&this.M(),this},setFromQuaternion:function(t,i,n){return St.makeRotationFromQuaternion(t),this.setFromRotationMatrix(St,i,n)},setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this.T)},reorder:function(t){return Ot.setFromEuler(this),this.setFromQuaternion(Ot,t)},equals:function(t){return t.e===this.e&&t.u===this.u&&t.f===this.f&&t.T===this.T},fromArray:function(t){return this.e=t[0],this.u=t[1],this.f=t[2],void 0!==t[3]&&(this.T=t[3]),this.M(),this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.e,t[i+1]=this.u,t[i+2]=this.f,t[i+3]=this.T,t},toVector3:function(t){return t?t.set(this.e,this.u,this.f):new g(this.e,this.u,this.f)},A:function(t){return this.M=t,this},M:function(){}}),Object.assign(kt.prototype,{isMatrix3:!0,set:function(t,i,n,s,h,e,r,o,u){var a=this.elements;return a[0]=t,a[1]=s,a[2]=r,a[3]=i,a[4]=h,a[5]=o,a[6]=n,a[7]=e,a[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],this},extractBasis:function(t,i,n){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){t=t.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var n=t.elements,s=i.elements,h=this.elements,e=n[0],r=n[3],o=n[6],u=n[1],a=n[4],c=n[7],f=n[2],l=n[5],v=n[8],d=s[0],M=s[3],p=s[6],y=s[1],m=s[4],t=s[7],i=s[2],n=s[5],s=s[8];return h[0]=e*d+r*y+o*i,h[3]=e*M+r*m+o*n,h[6]=e*p+r*t+o*s,h[1]=u*d+a*y+c*i,h[4]=u*M+a*m+c*n,h[7]=u*p+a*t+c*s,h[2]=f*d+l*y+v*i,h[5]=f*M+l*m+v*n,h[8]=f*p+l*t+v*s,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[1],s=t[2],h=t[3],e=t[4],r=t[5],o=t[6],u=t[7],t=t[8];return i*e*t-i*r*u-n*h*t+n*r*o+s*h*u-s*e*o},getInverse:function(t,i){void 0!==i&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,s=this.elements,h=n[0],e=n[1],r=n[2],o=n[3],u=n[4],a=n[5],c=n[6],f=n[7],l=n[8],v=l*u-a*f,i=a*c-l*o,t=f*o-u*c,n=h*v+e*i+r*t;if(0==n)return this.set(0,0,0,0,0,0,0,0,0);n=1/n;return s[0]=v*n,s[1]=(r*f-l*e)*n,s[2]=(a*e-r*u)*n,s[3]=i*n,s[4]=(l*h-r*c)*n,s[5]=(r*o-a*h)*n,s[6]=t*n,s[7]=(e*c-f*h)*n,s[8]=(u*h-e*o)*n,this},transpose:function(){var t=this.elements,i=t[1];return t[1]=t[3],t[3]=i,i=t[2],t[2]=t[6],t[6]=i,i=t[5],t[5]=t[7],t[7]=i,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},setUvTransform:function(t,i,n,s,h,e,r){var o=Math.cos(h),h=Math.sin(h);this.set(n*o,n*h,-n*(o*e+h*r)+e+t,-s*h,s*o,-s*(-h*e+o*r)+r+i,0,0,1)},scale:function(t,i){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=i,n[4]*=i,n[7]*=i,this},rotate:function(t){var i=Math.cos(t),n=Math.sin(t),s=this.elements,h=s[0],e=s[3],r=s[6],o=s[1],u=s[4],t=s[7];return s[0]=i*h+n*o,s[3]=i*e+n*u,s[6]=i*r+n*t,s[1]=-n*h+i*o,s[4]=-n*e+i*u,s[7]=-n*r+i*t,this},translate:function(t,i){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=i*n[2],n[4]+=i*n[5],n[7]+=i*n[8],this},equals:function(t){for(var i=this.elements,n=t.elements,s=0;s<9;s++)if(i[s]!==n[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<9;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){var n=this.elements;return(t=void 0===t?[]:t)[i=void 0===i?0:i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t}});var Bt=0,It=new g,Vt=new e,Ct=new p,Ht=new g,Ft=new g,Pt=new g,Lt=new e,Yt=new g(1,0,0),Dt=new g(0,1,0),_t=new g(0,0,1),Xt={type:"added"},Nt={type:"removed"};function Ut(){Object.defineProperty(this,"id",{value:Bt++}),this.uuid=d.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ut.DefaultUp.clone();var t=new g,i=new jt,n=new e,s=new g(1,1,1);i.A(function(){n.setFromEuler(i,!1)}),n.A(function(){i.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new p},normalMatrix:{value:new kt}}),this.matrix=new p,this.matrixWorld=new p,this.matrixAutoUpdate=Ut.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new k,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Ut.DefaultUp=new g(0,1,0),Ut.DefaultMatrixAutoUpdate=!0,Ut.prototype=Object.assign(Object.create(nt.prototype),{constructor:Ut,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,i){this.quaternion.setFromAxisAngle(t,i)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,i){return Vt.setFromAxisAngle(t,i),this.quaternion.multiply(Vt),this},rotateOnWorldAxis:function(t,i){return Vt.setFromAxisAngle(t,i),this.quaternion.premultiply(Vt),this},rotateX:function(t){return this.rotateOnAxis(Yt,t)},rotateY:function(t){return this.rotateOnAxis(Dt,t)},rotateZ:function(t){return this.rotateOnAxis(_t,t)},translateOnAxis:function(t,i){return It.copy(t).applyQuaternion(this.quaternion),this.position.add(It.multiplyScalar(i)),this},translateX:function(t){return this.translateOnAxis(Yt,t)},translateY:function(t){return this.translateOnAxis(Dt,t)},translateZ:function(t){return this.translateOnAxis(_t,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Ct.getInverse(this.matrixWorld))},lookAt:function(t,i,n){t.isVector3?Ht.copy(t):Ht.set(t,i,n);n=this.parent;this.updateWorldMatrix(!0,!1),Ft.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ct.lookAt(Ft,Ht,this.up):Ct.lookAt(Ht,Ft,this.up),this.quaternion.setFromRotationMatrix(Ct),n&&(Ct.extractRotation(n.matrixWorld),Vt.setFromRotationMatrix(Ct),this.quaternion.premultiply(Vt.inverse()))},add:function(t){if(1<arguments.length){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(Xt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Nt)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Ct.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ct.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ct),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,i){if(this[t]===i)return this;for(var n=0,s=this.children.length;n<s;n++){var h=this.children[n].getObjectByProperty(t,i);if(void 0!==h)return h}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new g),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new e),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ft,t,Pt),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new g),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ft,Lt,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new g),this.updateMatrixWorld(!0);var i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var i=this.children,n=0,s=i.length;n<s;n++)i[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var i=this.children,n=0,s=i.length;n<s;n++)i[n].traverseVisible(t)}},traverseAncestors:function(t){var i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var i=this.children,n=0,s=i.length;n<s;n++)i[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,i){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i)for(var s=this.children,h=0,e=s.length;h<e;h++)s[h].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,i){if(void 0===i&&(i=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(var n=0;n<t.children.length;n++){var s=t.children[n];this.add(s.clone())}return this}});var Zt=1,Gt=new p,qt=new Ut,Qt=new g,zt=new tt,Wt=new tt,Jt=new g;function Kt(){Object.defineProperty(this,"id",{value:Zt+=2}),this.uuid=d.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Kt.prototype=Object.assign(Object.create(nt.prototype),{constructor:Kt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<function(t){if(0===t.length)return-1/0;for(var i=t[0],n=1,s=t.length;n<s;++n)t[n]>i&&(i=t[n]);return i}(t)?bt:wt)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,i){return this.attributes[t]=i,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,i,n){this.groups.push({start:t,count:i,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,i){this.drawRange.start=t,this.drawRange.count=i},applyMatrix4:function(t){var i=this.attributes.position;void 0!==i&&(i.applyMatrix4(t),i.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&(i=(new kt).getNormalMatrix(t),n.applyNormalMatrix(i),n.needsUpdate=!0);n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Gt.makeRotationX(t),this.applyMatrix4(Gt),this},rotateY:function(t){return Gt.makeRotationY(t),this.applyMatrix4(Gt),this},rotateZ:function(t){return Gt.makeRotationZ(t),this.applyMatrix4(Gt),this},translate:function(t,i,n){return Gt.makeTranslation(t,i,n),this.applyMatrix4(Gt),this},scale:function(t,i,n){return Gt.makeScale(t,i,n),this.applyMatrix4(Gt),this},lookAt:function(t){return qt.lookAt(t),qt.updateMatrix(),this.applyMatrix4(qt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qt).negate(),this.translate(Qt.x,Qt.y,Qt.z),this},setFromObject:function(t){var i,n,s=t.geometry;return t.isPoints||t.isLine?(i=new At(3*s.vertices.length,3),n=new At(3*s.colors.length,3),this.setAttribute("position",i.copyVector3sArray(s.vertices)),this.setAttribute("color",n.copyColorsArray(s.colors)),s.lineDistances&&s.lineDistances.length===s.vertices.length&&(n=new At(s.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(s.lineDistances))),null!==s.boundingSphere&&(this.boundingSphere=s.boundingSphere.clone()),null!==s.boundingBox&&(this.boundingBox=s.boundingBox.clone())):t.isMesh&&s&&s.isGeometry&&this.fromGeometry(s),this},setFromPoints:function(t){for(var i=[],n=0,s=t.length;n<s;n++){var h=t[n];i.push(h.x,h.y,h.z||0)}return this.setAttribute("position",new At(i,3)),this},updateFromObject:function(t){var i,n=t.geometry;if(t.isMesh){var s=n.S;if(!0===n.elementsNeedUpdate&&(s=void 0,n.elementsNeedUpdate=!1),void 0===s)return this.fromGeometry(n);s.verticesNeedUpdate=n.verticesNeedUpdate,s.normalsNeedUpdate=n.normalsNeedUpdate,s.colorsNeedUpdate=n.colorsNeedUpdate,s.uvsNeedUpdate=n.uvsNeedUpdate,s.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=s}return!0===n.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(n.vertices),i.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(n.normals),i.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(n.colors),i.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(n.uvs),i.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(n.lineDistances),i.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.S=(new Tt).fromGeometry(t),this.fromDirectGeometry(t.S)},fromDirectGeometry:function(t){var i,n,s,h,e=new Float32Array(3*t.vertices.length);for(s in this.setAttribute("position",new dt(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(i=new Float32Array(3*t.normals.length),this.setAttribute("normal",new dt(i,3).copyVector3sArray(t.normals))),0<t.colors.length&&(i=new Float32Array(3*t.colors.length),this.setAttribute("color",new dt(i,3).copyColorsArray(t.colors))),0<t.uvs.length&&(n=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new dt(n,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(n=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new dt(n,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var r=[],o=t.morphTargets[s],u=0,a=o.length;u<a;u++){var c=o[u],f=new At(3*c.data.length,3);f.name=c.name,r.push(f.copyVector3sArray(c.data))}this.morphAttributes[s]=r}return 0<t.skinIndices.length&&(h=new At(4*t.skinIndices.length,4),this.setAttribute("skinIndex",h.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(h=new At(4*t.skinWeights.length,4),this.setAttribute("skinWeight",h.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new tt);var t=this.attributes.position,i=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),i)for(var n=0,s=i.length;n<s;n++){var h=i[n];zt.setFromBufferAttribute(h),this.morphTargetsRelative?(Jt.addVectors(this.boundingBox.min,zt.min),this.boundingBox.expandByPoint(Jt),Jt.addVectors(this.boundingBox.max,zt.max),this.boundingBox.expandByPoint(Jt)):(this.boundingBox.expandByPoint(zt.min),this.boundingBox.expandByPoint(zt.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new xt);var t=this.attributes.position,i=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(zt.setFromBufferAttribute(t),i)for(var s=0,h=i.length;s<h;s++){var e=i[s];Wt.setFromBufferAttribute(e),this.morphTargetsRelative?(Jt.addVectors(zt.min,Wt.min),zt.expandByPoint(Jt),Jt.addVectors(zt.max,Wt.max),zt.expandByPoint(Jt)):(zt.expandByPoint(Wt.min),zt.expandByPoint(Wt.max))}zt.getCenter(n);for(var r=0,s=0,h=t.count;s<h;s++)Jt.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(Jt));if(i)for(s=0,h=i.length;s<h;s++)for(var e=i[s],o=this.morphTargetsRelative,u=0,a=e.count;u<a;u++)Jt.fromBufferAttribute(e,u),o&&(Qt.fromBufferAttribute(t,u),Jt.add(Qt)),r=Math.max(r,n.distanceToSquared(Jt));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,i=this.attributes;if(i.position){var n=i.position.array;if(void 0===i.normal)this.setAttribute("normal",new dt(new Float32Array(n.length),3));else for(var s=i.normal.array,h=0,e=s.length;h<e;h++)s[h]=0;var r,o,u,a=i.normal.array,c=new g,f=new g,l=new g,v=new g,d=new g;if(t)for(var M=t.array,h=0,e=t.count;h<e;h+=3)r=3*M[h+0],o=3*M[h+1],u=3*M[h+2],c.fromArray(n,r),f.fromArray(n,o),l.fromArray(n,u),v.subVectors(l,f),d.subVectors(c,f),v.cross(d),a[r]+=v.x,a[1+r]+=v.y,a[2+r]+=v.z,a[o]+=v.x,a[1+o]+=v.y,a[2+o]+=v.z,a[u]+=v.x,a[1+u]+=v.y,a[2+u]+=v.z;else for(h=0,e=n.length;h<e;h+=9)c.fromArray(n,h),f.fromArray(n,h+3),l.fromArray(n,h+6),v.subVectors(l,f),d.subVectors(c,f),v.cross(d),a[h]=v.x,a[h+1]=v.y,a[h+2]=v.z,a[h+3]=v.x,a[h+4]=v.y,a[h+5]=v.z,a[h+6]=v.x,a[h+7]=v.y,a[h+8]=v.z;this.normalizeNormals(),i.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,i=0,n=t.count;i<n;i++)Jt.x=t.getX(i),Jt.y=t.getY(i),Jt.z=t.getZ(i),Jt.normalize(),t.setXYZ(i,Jt.x,Jt.y,Jt.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}});var $t=0;function ti(){Object.defineProperty(this,"id",{value:$t++}),this.uuid=d.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=et,this.side=ht,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ot,this.blendDst=ut,this.blendEquation=rt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=at,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ft,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ct,this.stencilZFail=ct,this.stencilZPass=ct,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function ii(t){ti.call(this),this.type="LineBasicMaterial",this.color=new P(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}ti.prototype=Object.assign(Object.create(nt.prototype),{constructor:ti,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var i in t){var n,s=t[i];void 0!==s?"shading"!==i?void 0!==(n=this[i])?n&&n.isColor?n.set(s):n&&n.isVector3&&s&&s.isVector3?n.copy(s):this[i]=s:console.warn("THREE."+this.type+": '"+i+"' is not a property of this material."):(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===s):console.warn("THREE.Material: '"+i+"' parameter is undefined.")}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var i=t.clippingPlanes,n=null;if(null!==i)for(var s=i.length,n=new Array(s),h=0;h!==s;++h)n[h]=i[h].clone();return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ti.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((ii.prototype=Object.create(ti.prototype)).constructor=ii).prototype.isLineBasicMaterial=!0,ii.prototype.copy=function(t){return ti.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var ni=new g,si=new g,hi=new p,ei=new j,ri=new xt;function oi(t,i,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Ut.call(this),this.type="Line",this.geometry=void 0!==t?t:new Kt,this.material=void 0!==i?i:new ii}oi.prototype=Object.assign(Object.create(Ut.prototype),{constructor:oi,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var i=t.attributes.position,n=[0],s=1,h=i.count;s<h;s++)ni.fromBufferAttribute(i,s-1),si.fromBufferAttribute(i,s),n[s]=n[s-1],n[s]+=ni.distanceTo(si);t.setAttribute("lineDistance",new At(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var e=t.vertices;(n=t.lineDistances)[0]=0;for(s=1,h=e.length;s<h;s++)n[s]=n[s-1],n[s]+=e[s-1].distanceTo(e[s])}return this},raycast:function(t,i){var n=this.geometry,s=this.matrixWorld,h=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ri.copy(n.boundingSphere),ri.applyMatrix4(s),ri.radius+=h,!1!==t.ray.intersectsSphere(ri)){hi.getInverse(s),ei.copy(t.ray).applyMatrix4(hi);var h=h/((this.scale.x+this.scale.y+this.scale.z)/3),e=h*h,r=new g,o=new g,u=new g,a=new g,c=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var h=n.index,f=n.attributes.position.array;if(null!==h)for(var l=h.array,v=0,d=l.length-1;v<d;v+=c){var M=l[v],p=l[v+1];r.fromArray(f,3*M),o.fromArray(f,3*p),e<ei.distanceSqToSegment(r,o,a,u)||(a.applyMatrix4(this.matrixWorld),(y=t.ray.origin.distanceTo(a))<t.near||y>t.far||i.push({distance:y,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else for(v=0,d=f.length/3-1;v<d;v+=c)r.fromArray(f,3*v),o.fromArray(f,3*v+3),e<ei.distanceSqToSegment(r,o,a,u)||(a.applyMatrix4(this.matrixWorld),(y=t.ray.origin.distanceTo(a))<t.near||y>t.far||i.push({distance:y,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else if(n.isGeometry)for(var y,m=n.vertices,w=m.length,v=0;v<w-1;v+=c)e<ei.distanceSqToSegment(m[v],m[v+1],a,u)||(a.applyMatrix4(this.matrixWorld),(y=t.ray.origin.distanceTo(a))<t.near||y>t.far||i.push({distance:y,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ui=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.R={}};Object.assign(ui.prototype,{O:function(t,i){this.j(t,i)||(void 0===this.R[t]&&(this.R[t]=[]),this.R[t].push(i))},j:function(t,i){return i?void 0!==this.R[t]&&-1!==this.R[t].indexOf(i):void 0!==this.R[t]&&0<this.R[t].length},k:function(t,i){void 0===this.R[t]||-1!==(i=this.R[t].indexOf(i))&&this.R[t].splice(i,1)},B:function(t){if(void 0!==this.R[t.type])for(var i=this.R[t.type].slice(0),n=0,s=i.length;n<s;n++)i[n].call(this,t)}});var ai=ui;function ci(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var fi=function(){function i(t){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),this.I=t,this.V="none",this.currentobj=null,this.C={url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QoOAiAd1TTTFgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABfElEQVRYw81XO26EMBB9poAIrBwh2hPgMt1WS7cSN+AonAXtIahSpfLWVNtFewXLkG7SeCVIbH5rBZ40jYGZ8fjxPMOwDAcARwAnAO8A3sz6HcAVwAeATwBf8IgIQAGgA0AzrTPfRM8GPy8I6rLz2l1fPAR/2GVJNV4B3DwGf9jN+J7cuTM4Y4yEEFSWJUkpSWtNWmuSUlJZliSEIMbYVBKjlXCWPcsyUkrRFJRSlGXZ1HHMJ1wYhlRVFS1FVVUUhuFsYkau4FJKWgsp5VgSg6MobC+t2bmtEo4Ein4Cne3MfcHBia4vr3/YPodwc6GUcv0dh8Bo+wBpmoJz7k3LOedI09T26BiYi2WAPM/hGw6fJ9iE5xnmj/0RNmFihgwv/bS01ojj2GsF2rZFkiS/l78DbIzANBMDNE3jPZDD5z0wncwAdV17T8Dh82pVQSGEdxIKIZxquKkQ7UKKd3EZbX4db96Q7KIl20VTunlbvovBZBej2b8Np2zr8fwHFGE/6k/Mu0oAAAAASUVORK5CYII=",size:32,height:1,collision:!1},this.H={width:5,type:w.FULL,color:"#FF0000",height:3},this.F={color:"#FF0000",borderWidth:3,borderColor:"#0000FF",opacity:.5,height:3},this.P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QocCDgHXcqo9wAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAEQ0lEQVRYw71XTWhcVRg9584kVGzHZKYlTFpsJ/PeKBaKMjN05aYIKgguupASqaKCC1cFVxaSaQW7dSW4KRFBEETEje5qtWK1SdP409L0zZgpJrEtvqY/qebNe/e46KSZDMkkmSR9mwdz35zv3O8737nfJdbxuG7xdQp7EfCj8au//NkORqzd4Lls8S0SgzR8UTHbm0qlr/r+9ORDIZDLFt6B4SDJXQBAci/AbHeyd8L3p6qbSsB1C++SLJHc0fg7yQyFbFd37z83b05d3hQCrls8SrBEcutS6yR3k8wnU713fH9qbEMJuG7hPYIDAAyAGsl447qk6wDmACQIPJVMpWd8f/r3lXDjqwne07PvUQmXBfUbKQS5U8AAyZ568LNW0RGJAalOyRgTRbN1srYVNtsR4Z49hSc6O3iKZBoArPTjzMzsCzduXLy7VizTDgGSAqCGXdDaqK3NmI0S6PYVSrgmAq6bP+S6+cKyzGI2WlxbsRWDbds6D7hu/vCqCOScwquAGaSNpZcDrNXCCEDYWJQoeowtSpYizIDrFl9rScBxiv0gBwn2yWhZwI4OGy4ioNZilhAA2G2AweZMxBvs9RVQA6RxJNQAPJ3LFW8jVCeoTruo77mjqYUTgD3oOIXbS6dZ++9LlRnKDDhOMfS8c589aEPHKRw0xDHS7G0wlrsADSBTz5RpSmuzEYUrdE584Vt7EVZHx8sjXzGXzb8sY44bch8e4mOlc5I9akA+u1xwafG7YWXdBAxZNOBLcYvwpLEdvTQ8tCiE1Q8wGJMQSYoEhhRrov6jkAD1Jsnk/Dkg4AsCNUgEDAFRBAGQQo6GzzWV7DsLfFnXQD5rYAZoeHh+h7I6Mu4Nf7gU+76+/ONxY07RsK9O9ufQ2ucrlZFbS33vOMV+Q3xCMvYguFTyvOHTBgA8b6Q8VwsGZe3QfHrZIs9RZAIRwarTfb+rVK/9mcja4543fHqRD1SrYxNBGJUEDa0IaMyaRGCpCKBk7RgjfVAuj5xa0ogmJkarsVhUkrVDUYtTlPxXBKM1HF5WUhnCifHK8DctrfjSpdFqENpSLDTfLgcYBGEIaG61BKRoGrTHx8vDn69qIJmYGG05WG7ZsjUEtGoNeN75cwDOtj0RAUAms79nYUfBNjIeNQnzkXQ6XwMAa2sEgGvXfp2dX17XROQ4ToLsehvgGw1/dObtVcI9wf5kAAokYI3A74Hax1eujE2ueyj1fX8ukeiZjMXMk4Y8QHI7SbMgMnSQ6AOZIZERUJEw5Hmjv23YVDwz8/etVGJXBUZZktkmVwPJusfbr62N3i+Xz5/Z8HuBPzN5rTvZe5VAhuSehjabD/4pYEued2F0025Gvj9VTXalrwvMk9y+cHbYoaAWliqVC96m3w39m9NXUqn0HYDPkOiywslaGB2rVi9U14rV9u3Y96fHkqmd92T1x1ygE9Xq+b/awfkfmzntCAO/rwcAAAAASUVORK5CYII=",this.L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QoOAiAd1TTTFgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABfElEQVRYw81XO26EMBB9poAIrBwh2hPgMt1WS7cSN+AonAXtIahSpfLWVNtFewXLkG7SeCVIbH5rBZ40jYGZ8fjxPMOwDAcARwAnAO8A3sz6HcAVwAeATwBf8IgIQAGgA0AzrTPfRM8GPy8I6rLz2l1fPAR/2GVJNV4B3DwGf9jN+J7cuTM4Y4yEEFSWJUkpSWtNWmuSUlJZliSEIMbYVBKjlXCWPcsyUkrRFJRSlGXZ1HHMJ1wYhlRVFS1FVVUUhuFsYkau4FJKWgsp5VgSg6MobC+t2bmtEo4Ein4Cne3MfcHBia4vr3/YPodwc6GUcv0dh8Bo+wBpmoJz7k3LOedI09T26BiYi2WAPM/hGw6fJ9iE5xnmj/0RNmFihgwv/bS01ojj2GsF2rZFkiS/l78DbIzANBMDNE3jPZDD5z0wncwAdV17T8Dh82pVQSGEdxIKIZxquKkQ7UKKd3EZbX4db96Q7KIl20VTunlbvovBZBej2b8Np2zr8fwHFGE/6k/Mu0oAAAAASUVORK5CYII=",this.objectArray=[],this.Y=[],this.D=[],this._=[],this.X=[],this.N=null,this.U=null,this.Z=null,this.G=null,this.q=void 0,this.Q="#FF0000",this.W=this.I.getContainer().childNodes[0],this.J=this.J.bind(this),this.K=this.K.bind(this),this.$=this.$.bind(this),this.tt=this.tt.bind(this),this.it=new B,this.nt=new ai,this.st=null,this.ht=null,this.et()}var t,n,s;return t=i,(n=[{key:"editUrl",get:function(){return this.L},set:function(t){this.L=t}},{key:"centerUrl",get:function(){return this.P},set:function(t){this.P=t}},{key:"PointStyle",get:function(){return this.C},set:function(t){this.C=t}},{key:"operate",get:function(){return this.q},set:function(t){this.q=t;for(var i=0;i<this._.length;i++)this._[i].visible=!1,"move"===t?"center"===this._[i].rt&&(this._[i].visible=!0):"center"!==this._[i].rt&&(this._[i].visible=!0)}},{key:"LineStyle",get:function(){return this.H},set:function(t){this.H=t}},{key:"PolygonStyle",get:function(){return this.F},set:function(t){this.F=t}},{key:"DrawTool",get:function(){return this.V},set:function(t){if(this.V=t,"edit"!==this.V){for(var i=0;i<this._.length;i++)this._[i].remove();null!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.I.enableUpdateRender()),this.Y.length=0,this.D.length=0,this._.length=0,this.U=null,this.N=null}}},{key:"edit",value:function(t,i){if("none"===this.DrawTool||"edit"===this.DrawTool){if(!t||!t.shapetype){for(var n=0;n<this._.length;n++)this._[n].remove();return this._.length=0,void((this.U=null)!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.I.enableUpdateRender()))}if(!(0<this._.length||null!==this.ht)&&(i||null==this.U||this.U.id!==t.id)&&(!t.opetype||"no"===t.opetype.type)){for(var s=0;s<this._.length;s++)this._[s].remove();null!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.I.enableUpdateRender()),this._.length=0,this.N=null,this.U=t,i||(this.G=t.id),t.type===fengmap.FMType.POLYGON_MARKER?(this.ot(t),this.DrawTool="edit"):t.type===fengmap.FMType.LINE_MARKER?(this.ut(t),this.DrawTool="edit"):t.type===fengmap.FMType.IMAGE_MARKER&&(this.DrawTool="edit",this.Z=null,this.ct(t))}}}},{key:"on",value:function(t,i){this.nt.O(t,i)}},{key:"dispose",value:function(){this.W.removeEventListener("mousedown",this.J,!1),this.W.removeEventListener("mousemove",this.K,!1),this.W.removeEventListener("mouseup",this.$,!1),this.I.off("click",this.tt)}},{key:"createMarkerByInfo",value:function(t){if("circle"===t.shapetype||"ellipse"===t.shapetype||"rect"===t.shapetype||"polygon"===t.shapetype){var i=new fengmap.FMPolygonMarkerEdit(t),n=this.I.getFloor(t.level);return i.addTo(n),i.mapEdit=this,t.id&&(i.id=t.id),i}if("line"===t.shapetype){var s=new fengmap.FMSegment;s.points=[];for(var h=0;h<t.points.length;h++)s.points.push({x:t.points[h].x,y:t.points[h].y,z:t.points[h].z});s.level=t.level,t.segments=[s];var e=new fengmap.FMLineMarkerEdit(t);return e.addTo(this.I),e.mapEdit=this,t.id&&(e.id=t.id),e}i=this.I.getFloor(t.level),e=new fengmap.FMImageMarkerEdit(t);return e.addTo(i),e.mapEdit=this,t.id&&(e.id=t.id),e}}])&&ci(t.prototype,n),s&&ci(t,s),i}();Object.assign(fi.prototype,{et:function(){this.I.on("click",this.tt),this.W.addEventListener("mousedown",this.J,!1),this.W.addEventListener("mousemove",this.K,!1),this.W.addEventListener("mouseup",this.$,!1)},ft:function(t,i){if(("none"===this.DrawTool||"edit"===this.DrawTool)&&(null!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.I.enableUpdateRender()),t&&(i||null==this.U||this.U.id!==t.id)&&(!t.opetype||"no"===t.opetype.type))){for(var n=0;n<this._.length;n++)this._[n].remove();this._.length=0,this.N=null,this.U=t,i||(this.G=t.id),t.type===fengmap.FMType.POLYGON_MARKER?(this.ot(t),this.DrawTool="edit"):t.type===fengmap.FMType.LINE_MARKER?(this.ut(t),this.DrawTool="edit"):t.type===fengmap.FMType.IMAGE_MARKER&&(this.DrawTool="edit",this.Z=null,this.ct(t))}},lt:function(t,i){var n=new R;if(n.x=t/this.W.getBoundingClientRect().width*2-1,n.y=2*-(i/this.W.getBoundingClientRect().height)+1,"point"!==this.U.shapetype){for(var s=[],h=0;h<this._.length;h++)this._[h].opetype.node.visible&&s.push(this._[h].opetype.node);this.it.setFromCamera(n,this.I.camera);var e=this.it.intersectObjects(s,!0);return 0<e.length?e[0].object:null}e=[this.U.getRenderNode()];this.it.setFromCamera(n,this.I.camera);e=this.it.intersectObjects(e,!0);return 0<e.length?e[0].object:null},vt:function(i){var n=this,s=null;!function t(){null===n.st?s=setTimeout(t,5):(null!==s&&clearTimeout(s),i&&i())}()},J:function(s){var h=this;this.vt(function(){if("none"!==h.DrawTool){if(2===s.button)return"edit"!==h.DrawTool?h.dt():(null!==h.N||null!==h.U&&"point"===h.U.shapetype)&&h.Mt(),void(h.N=null);var t=s.clientX-h.W.getBoundingClientRect().left,i=s.clientY-h.W.getBoundingClientRect().top;if("edit"!==h.DrawTool){var n=fengmap.FMUtil.coordsScreenToMap(h.I,{x:t,y:i});"point"===h.DrawTool?(h.pt(n),h.nt.B({type:"drawend",info:h.currentobj.info,object:h.currentobj}),h.currentobj=null,h.st=null):"line"===h.DrawTool?h.Y.push(n):"circle"===h.DrawTool?0===h.D.length?h.D.push(n):(h.yt(n),h.nt.B({type:"drawend",info:h.currentobj.info,object:h.currentobj}),h.D.length=0,h.currentobj=null,h.st=null):"rect"===h.DrawTool?0===h.D.length?h.D.push(n):(h.mt(n),h.nt.B({type:"drawend",info:h.currentobj.info,object:h.currentobj}),h.D.length=0,h.currentobj=null,h.st=null):"polygon"===h.DrawTool?h.D.push(n):"ellipse"===h.DrawTool&&(0===h.D.length?h.D.push(n):(h.wt(n),h.nt.B({type:"drawend",info:h.currentobj.info,object:h.currentobj}),h.D.length=0,h.currentobj=null,h.st=null))}else if(null===h.N){if(null===h.U)return;i=h.lt(t,i);"point"!==h.U.shapetype?null!==i&&(h.N=i.mapNode,h.gt(!1)):null!==i&&(h.Z={x:h.U.x,y:h.U.y},h.gt(!1))}}})},K:function(t){if("none"!==this.DrawTool){var i=t.clientX-this.W.getBoundingClientRect().left,t=t.clientY-this.W.getBoundingClientRect().top,t=fengmap.FMUtil.coordsScreenToMap(this.I,{x:i,y:t});if("edit"===this.DrawTool)return null!==this.U&&"point"===this.U.shapetype&&null!==this.Z?(this.U.moveTo({animate:!1,x:t.x,y:t.y}),void this.nt.B({type:"drawing",info:this.U.info,object:this.U})):void(null!==this.U&&null!==this.N&&(this.bt(t),this.U.id=this.G,this.nt.B({type:"drawing",info:this.U.info,object:this.U})));"line"===this.DrawTool?this.At(t):"circle"===this.DrawTool?this.yt(t):"rect"===this.DrawTool?this.mt(t):"polygon"===this.DrawTool?this.Et(t):"ellipse"===this.DrawTool&&this.wt(t),this.I.enableUpdateRender(),null!==this.currentobj&&this.nt.B({type:"drawing",info:this.currentobj.info,object:this.currentobj})}},$:function(t){if("edit"===this.DrawTool&&null!==this.U&&("point"===this.U.shapetype||null!==this.N)){if("point"===this.U.shapetype)this.ft(this.U,!0);else if("center"!==this.N.opetype.type){if("ellipse"===this.U.shapetype||"circle"===this.U.shapetype)this.Z=this.Rt(this.U.points);else if("rect"===this.U.shapetype){this.Z=this.U.points;var i=this.xt("center");i.visible=!0,void 0!==this.q&&"edit"===this.q&&(i.visible=!1);var n=this.xt("point",!0);i.position.x=(n[0].position.x+n[1].position.x)/2,i.position.z=(n[0].position.z+n[1].position.z)/2,this.X.length=0,this.X.push({x:Math.abs(n[0].position.x-n[1].position.x)/2,y:Math.abs(n[0].position.z-n[1].position.z)/2})}else if("polygon"===this.U.shapetype){this.Z=this.U.points;for(var s=this.Rt(this.Z).center,h=this.X.length=0;h<this.Z.length;h++)this.X.push({x:this.Z[h].x-s.x,y:this.Z[h].y-s.y});var e=this.xt("center");e.position.x=s.x-this.I.x,e.position.z=this.I.y-s.y}else if("line"===this.U.shapetype){this.Z=this.U.points;for(var r=this.Rt(this.Z).center,o=this.X.length=0;o<this.Z.length;o++)this.X.push({x:this.Z[o].x-r.x,y:this.Z[o].y-r.y});e=this.xt("center");e.position.x=r.x-this.I.x,e.position.z=this.I.y-r.y}}else this.ft(this.U,!0);this.gt(!0),this.N=null,this.U.id=this.G,this.nt.B({type:"editend",info:this.U.info,object:this.U})}},ct:function(t){t.getRenderNode().position;var i=[new g(-.5,0,.5),new g(-.5,0,-.5),new g(.5,0,-.5),new g(.5,0,.5),new g(-.5,0,.5)],n=(new Kt).setFromPoints(i),i=new ii({color:new P(this.Q)});i.depthTest=!1,i.depthWrite=!1;i=new oi(n,i);i.scale.set(1.1,1.1,1.1),t.getRenderNode().add(i),this.ht=i,this.I.enableUpdateRender()},bt:function(t){if(null!==this.N){var i,n,s=this;if("ellipse"!==this.U.shapetype?(this.N.opetype.node.position.x=t.x-this.I.x,this.N.opetype.node.position.z=this.I.y-t.y):"xradius"===this.N.opetype.type?this.N.opetype.node.position.x=t.x-this.I.x:("yradius"===this.N.opetype.type||(this.N.opetype.node.position.x=t.x-this.I.x),this.N.opetype.node.position.z=this.I.y-t.y),"circle"===this.U.shapetype)"yradius"===this.N.opetype.type?(i=E("center"),this.D.length=0,this.D.push({x:this.I.x+i.position.x,y:this.I.y-i.position.z}),this.yt(t,!0)):(E("yradius").visible=!1,this.D.length=0,this.D.push({x:t.x,y:t.y}),this.yt({x:t.x,y:t.y+this.Z.yradius},!0));else if("ellipse"===this.U.shapetype)this.D.length=0,"yradius"===this.N.opetype.type||"xradius"===this.N.opetype.type?(n=E("center"),i={x:this.I.x+n.position.x,y:this.I.y-n.position.z},n=null,n="yradius"===this.N.opetype.type?this.Tt(i,this.Z.xradius,Math.abs(i.y-t.y)):this.Tt(i,Math.abs(i.x-t.x),this.Z.yradius),this.wt(n,!0)):(E("xradius").visible=!1,E("yradius").visible=!1,r=this.Tt(t,this.Z.xradius,this.Z.yradius),this.wt(r,!0));else if("rect"===this.U.shapetype)if("center"===this.N.opetype.type){for(var h=E("point",!0),e=0;e<h.length;e++)h[e].visible=!1;this.D.length=0,this.D.push({x:t.x+this.X[0].x,y:t.y-this.X[0].y}),this.mt({x:t.x-this.X[0].x,y:t.y+this.X[0].y},!0)}else{var r=E("center"),r=E("point",r.visible=!1,this.N.opetype.node.uuid);null!==r&&(this.D.length=0,this.D.push({x:this.I.x+r.position.x,y:this.I.y-r.position.z}),this.mt(t,!0))}else if("polygon"===this.U.shapetype)if("center"===this.N.opetype.type){for(var o=this.xt("point",!0),u=0;u<o.length;u++)o[u].visible=!1;for(var a=this.N.opetype.node.position.x,c=this.N.opetype.node.position.z,f=[],l=0;l<this.X.length;l++)f.push({x:a+this.X[l].x,y:c-this.X[l].y});this.Et(f,!0)}else{for(var v=this.xt("point",!0),d=[],M=0;M<v.length;M++)d.push({x:v[M].position.x,y:v[M].position.z});this.Et(d,!0)}else if("line"===this.U.shapetype){var p=this.xt("point",!0),y=[];if("center"===this.N.opetype.type){for(var m=0;m<p.length;m++)p[m].visible=!1;for(var w=this.N.opetype.node.position.x,g=this.N.opetype.node.position.z,b=0;b<this.X.length;b++)y.push({x:w+this.X[b].x,y:g-this.X[b].y});this.At(y,!0)}else{for(var A=0;A<p.length;A++)y.push({x:p[A].position.x,y:p[A].position.z});this.At(y,!0)}}}function E(t,i,n){return s.xt(t,i,n)}},xt:function(t,i,n){var s=this,h=null;i&&(h=[]);for(var e=0;e<s._.length;e++)if(s._[e].opetype.type===t)if(i)(!n||s._[e].opetype.node.uuid!==n)&&h.push(s._[e].opetype.node);else{if(!n){h=s._[e].opetype.node;break}if(s._[e].opetype.node.uuid!==n){h=s._[e].opetype.node;break}}return h},dt:function(){var t;"line"===this.DrawTool?this.At():"circle"===this.DrawTool?this.yt():"rect"===this.DrawTool?this.mt():"polygon"===this.DrawTool?this.Et():"ellipse"===this.DrawTool&&this.wt(),"line"!==this.DrawTool&&"polygon"!==this.DrawTool||(t=!0,"line"===this.DrawTool?this.Y.length<2&&(t=!1):"polygon"===this.DrawTool&&this.D.length<3&&(t=!1),t&&(this.nt.B({type:"drawend",info:this.currentobj.info,object:this.currentobj}),this.st=null),"line"===this.DrawTool&&(this.Y.length=0,this.currentobj=null),"polygon"===this.DrawTool&&(this.D.length=0,this.currentobj=null))},Mt:function(){if("circle"===this.U.shapetype)this.D.length=0,this.D.push({x:this.Z.center.x,y:this.Z.center.y}),this.yt({x:this.Z.center.x,y:this.Z.center.y+this.Z.yradius},!0);else if("ellipse"===this.U.shapetype){this.D.length=0;var t=this.Tt({x:this.Z.center.x,y:this.Z.center.y},this.Z.xradius,this.Z.yradius);this.wt(t,!0)}else if("rect"===this.U.shapetype)this.mt(),this.ft(this.U);else if("polygon"===this.U.shapetype){for(var i=[],n=0;n<this.Z.length;n++)i.push({x:this.Z[n].x-this.I.x,y:this.I.y-this.Z[n].y});this.Et(i,!0)}else if("line"===this.U.shapetype){for(var s=[],h=0;h<this.Z.length;h++)s.push({x:this.Z[h].x-this.I.x,y:this.I.y-this.Z[h].y});this.At(s,!0)}else if("point"===this.U.shapetype)return this.U.moveTo({animate:!1,x:this.Z.x,y:this.Z.y}),this.nt.B({type:"editend",info:this.U.info,object:this.U}),void(this.U=null);this.U.id=this.G,this.nt.B({type:"editend",info:this.U.info,object:this.U}),this.ft(this.U,!0)},pt:function(t){var i,n={},s=this.PointStyle;for(i in s)n[i]=s[i];n.x=t.x,n.y=t.y,n.buildingID=this.st.buildingID;var h=this.I.getBuilding(this.st.buildingID).getFloor(this.st.level),t=new fengmap.FMImageMarkerEdit(n);t.addTo(h),(t.mapEdit=this).currentobj=t},At:function(t,i){var n=new fengmap.FMSegment;n.points=[];var s,h={},e=this.LineStyle;for(s in e)h[s]=e[s];if(void 0===h.height&&(h.height=3),i){null!==this.U&&this.U.remove();for(var r=0;r<t.length;r++)n.points.push({x:this.I.x+t[r].x,y:this.I.y-t[r].y,z:h.height})}else{if(0===this.Y.length)return;if(null!==this.currentobj&&(this.currentobj.remove(),!t&&1===this.Y.length))return;for(var o=0;o<this.Y.length;o++)n.points.push({x:this.Y[o].x,y:this.Y[o].y,z:h.height});t&&n.points.push({x:t.x,y:t.y,z:h.height})}n.level=this.st.level,n.buildingID=this.st.buildingID,h.segments=[n];var u=new fengmap.FMLineMarkerEdit(h);u.addTo(this.I),u.mapEdit=this,i?this.U=u:this.currentobj=u},yt:function(t,i){if(0!==this.D.length){if(i)null!==this.U&&this.U.remove();else if(null!==this.currentobj&&(this.currentobj.remove(),!t))return this.D.length=0,void(this.currentobj=null);var n,s=this.D[0],s=Math.sqrt((s.x-t.x)*(s.x-t.x)+(s.y-t.y)*(s.y-t.y)),h=this.PolygonStyle,e={};for(n in h)e[n]=h[n];e.points=fengmap.FMCalculator.circleBuilder(s,this.D[0],32),e.shapetype="circle";t=new fengmap.FMPolygonMarkerEdit(e),s=this.I.getBuilding(this.st.buildingID).getFloor(this.st.level);t.addTo(s),t.mapEdit=this,i?this.U=t:this.currentobj=t}},mt:function(t,i){var n=[];if(t||i){if(0===this.D.length)return;if(i)null!==this.U&&this.U.remove();else if(null!==this.currentobj&&(this.currentobj.remove(),!t))return this.D.length=0,void(this.currentobj=null);var s=this.D[0],n=[s,{x:t.x,y:s.y},t,{x:s.x,y:t.y}]}else if("edit"===mapdraw.DrawTool)n=this.Z,null!==this.U&&this.U.remove();else if(null!==this.currentobj)return this.currentobj.remove(),this.D.length=0,void(this.currentobj=null);if(0!==n.length){var h,e=this.PolygonStyle,r={};for(h in e)r[h]=e[h];r.points=n,r.shapetype="rect";s=new fengmap.FMPolygonMarkerEdit(r),n=this.I.getBuilding(this.st.buildingID).getFloor(this.st.level);s.addTo(n),s.mapEdit=this,!t&&!i||i?this.U=s:this.currentobj=s}},Et:function(t,i){var n=[];if(i){null!==this.U&&this.U.remove();for(var s=0;s<t.length;s++)n.push({x:this.I.x+t[s].x,y:this.I.y-t[s].y})}else{if(0===this.D.length)return;null!==this.currentobj&&this.currentobj.remove();for(var h=0;h<this.D.length;h++)n.push({x:this.D[h].x,y:this.D[h].y});if(t)n.push({x:t.x,y:t.y});else if(2===n.length)return}var e,r=this.PolygonStyle,o={};for(e in r)o[e]=r[e];o.points=n;var u=new fengmap.FMPolygonMarkerEdit(o),a=this.I.getBuilding(this.st.buildingID).getFloor(this.st.level);u.addTo(a),u.mapEdit=this,i?this.U=u:this.currentobj=u},wt:function(t,i){var n=null;if(i)null!==this.U&&this.U.remove(),n=t;else{if(0===this.D.length)return;if(null!==this.currentobj&&this.currentobj.remove(),!t)return this.D.length=0,void(this.currentobj=null);var s=this.D[0],h=Math.abs(t.x-s.x),e=Math.abs(t.y-s.y),n=e<h?this.Tt(s,h,h/2):this.Tt(s,e/2,e)}for(var r=[],o=0;o<n.length;o++)r.push({x:n[o].x,y:n[o].y});var u,a=this.PolygonStyle,c={};for(u in a)c[u]=a[u];c.points=r,c.shapetype="ellipse";s=new fengmap.FMPolygonMarkerEdit(c),e=this.I.getBuilding(this.st.buildingID).getFloor(this.st.level);s.addTo(e),s.mapEdit=this,i?this.U=s:this.currentobj=s},Tt:function(t,i,n){return new m(t.x,t.y,i,n,0,2*Math.PI,!1,0).getPoints(32)},ut:function(t){var i=[];this.Z=t.points;for(var n=this.Rt(t.points).center,s=this.X.length=0;s<t.points.length;s++)i.push(t.points[s]),this.X.push({x:t.points[s].x-n.x,y:t.points[s].y-n.y});i.push({x:n.x,y:n.y,optype:"center"}),this.St(i,t)},ot:function(t){var i,n,s=this,h=[];if("polygon"===t.shapetype){this.Z=t.points;for(var e=this.Rt(t.points).center,r=this.X.length=0;r<t.points.length;r++)h.push(t.points[r]),this.X.push({x:t.points[r].x-e.x,y:t.points[r].y-e.y});h.push({x:e.x,y:e.y,optype:"center"})}else"rect"===t.shapetype?(this.Z=t.points,h.push(t.points[0]),h.push(t.points[2]),h.push({x:(t.points[0].x+t.points[2].x)/2,y:(t.points[0].y+t.points[2].y)/2,optype:"center"}),this.X.length=0,this.X.push({x:Math.abs(t.points[0].x-t.points[2].x)/2,y:Math.abs(t.points[0].y-t.points[2].y)/2})):"circle"!==t.shapetype&&"ellipse"!==t.shapetype||(i=this.Rt(t.points),this.Z=i,h.push({x:i.center.x,y:i.center.y,optype:"center"}),h.push({x:i.center.x,y:i.center.y+i.yradius,optype:"yradius"}),"ellipse"===t.shapetype&&h.push({x:i.center.x+i.xradius,y:i.center.y,optype:"xradius"}));n=h,s.St(n,t)},St:function(t,i){for(var n=this,s=(n.I.getFloor(n.I.getLevel()),0);s<t.length;s++){var h=t[s].optype,e=n.editUrl;"center"===(h=h||"point")&&(e=n.centerUrl);var r=new fengmap.FMImageMarkerEdit({url:e,size:16,height:i.height+1,x:t[s].x,y:t[s].y,collision:!1,opetype:h}),e=this.I.getBuilding(i.info.buildingID).getFloor(i.info.level);r.addTo(e),void 0!==this.q&&("move"===this.q?"center"!==h&&(r.visible=!1):"edit"===this.q&&"center"===h&&(r.visible=!1)),n._.push(r)}},Rt:function(t){for(var i=null,n=null,s=null,h=null,e=0;e<t.length;e++)0===e?(i=t[e].x,n=t[e].y,s=t[e].x,h=t[e].y):(i>t[e].x&&(i=t[e].x),n>t[e].y&&(n=t[e].y),s<t[e].x&&(s=t[e].x),h<t[e].y&&(h=t[e].y));return{center:{x:(i+s)/2,y:(n+h)/2},xradius:Math.abs(s-i)/2,yradius:Math.abs(h-n)/2}},tt:function(t){var i=t.buildingID,t=t.level;null===i&&(i=this.I.getMapOptions().mapID,t=this.I.getLevel()),null===this.currentobj&&(this.st={buildingID:i,level:t})},gt:function(t){var i=this.I.getInteracations();i.enableDrag=t,i.enableRotate=t,i.enableTilt=t,i.enableZoom=t}});var li=fi,vi={NONE:0,EXTRUDE_MARKER:2,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,SHARP_MARKER:1<<26,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<28};vi.LAYER_NODE_TYPE=new Map,vi.LAYER_NODE_TYPE.set(vi.EXTENT_LAYER,vi.EXTENT),vi.LAYER_NODE_TYPE.set(vi.EXTERNAL_MODEL_LAYER,vi.EXTERNAL_MODEL),vi.LAYER_NODE_TYPE.set(vi.MODEL_LAYER,vi.MODEL),vi.LAYER_NODE_TYPE.set(vi.FACILITY_LAYER,vi.FACILITY),vi.LAYER_NODE_TYPE.set(vi.LABEL_LAYER,vi.LABEL),vi.LAYER_NODE_TYPE.set(vi.DOM_MARKER,vi.DOM_MARKER),vi.LAYER_NODE_TYPE.set(vi.DYNAMIC_MODEL_MARKER,vi.DYNAMIC_MODEL_MARKER),vi.LAYER_NODE_TYPE.set(vi.EXTRUDE_MARKER,vi.EXTRUDE_MARKER),vi.LAYER_NODE_TYPE.set(vi.HEAT_MAP_MARKER,vi.HEAT_MAP_MARKER),vi.LAYER_NODE_TYPE.set(vi.LINE_MARKER,vi.LINE_MARKER),vi.LAYER_NODE_TYPE.set(vi.LOCATION_MARKER,vi.LOCATION_MARKER),vi.LAYER_NODE_TYPE.set(vi.POLYGON_MARKER,vi.POLYGON_MARKER),vi.LAYER_NODE_TYPE.set(vi.TEXT_MARKER,vi.TEXT_MARKER),vi.LAYER_NODE_TYPE.set(vi.IMAGE_MARKER,vi.IMAGE_MARKER),vi.LAYER_NODE_TYPE.set(vi.FLOW_LINE_LAYER,vi.FLOW_LINE_MARKER);var di=vi,Mi=function(t,i,n){n=n||2;var s,h,e,r,o,u=i&&i.length,a=u?i[0]*n:t.length,c=pi(t,0,a,n,!0),f=[];if(!c||c.next===c.prev)return f;if(u&&(c=function(t,i,n,s){var h,e,r,o,u=[];for(h=0,e=i.length;h<e;h++)r=i[h]*s,o=h<e-1?i[h+1]*s:t.length,(o=pi(t,r,o,s,!1))===o.next&&(o.steiner=!0),u.push(function(t){var i=t,n=t;for(;(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),i=i.next,i!==t;);return n}(o));for(u.sort(wi),h=0;h<u.length;h++)!function(t,i){(i=function(t,i){var n,s=i,h=t.x,e=t.y,r=-1/0;do{if(e<=s.y&&e>=s.next.y&&s.next.y!==s.y){var o=s.x+(e-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(o<=h&&r<o){if((r=o)===h){if(e===s.y)return s;if(e===s.next.y)return s.next}n=s.x<s.next.x?s:s.next}}}while(s=s.next,s!==i);if(!n)return null;if(h===r)return n;var u,a=n,c=n.x,f=n.y,l=1/0;s=n;for(;h>=s.x&&s.x>=c&&h!==s.x&&bi(e<f?h:r,e,c,f,e<f?r:h,e,s.x,s.y)&&(u=Math.abs(e-s.y)/(h-s.x),Si(s,t)&&(u<l||u===l&&(s.x>n.x||s.x===n.x&&function(t,i){return Ai(t.prev,t,i.prev)<0&&Ai(i.next,t,t.next)<0}(n,s)))&&(n=s,l=u)),s=s.next,s!==a;);return n}(t,i))&&(t=Oi(i,t),yi(i,i.next),yi(t,t.next))}(u[h],n),n=yi(n,n.next);return n}(t,i,c,n)),t.length>80*n){for(var l=s=t[0],v=h=t[1],d=n;d<a;d+=n)(e=t[d])<l&&(l=e),(r=t[d+1])<v&&(v=r),s<e&&(s=e),h<r&&(h=r);o=0!==(o=Math.max(s-l,h-v))?1/o:0}return mi(c,f,n,l,v,o),f};function pi(t,i,n,s,h){var e,r;if(h===0<function(t,i,n,s){for(var h=0,e=i,r=n-s;e<n;e+=s)h+=(t[r]-t[e])*(t[e+1]+t[r+1]),r=e;return h}(t,i,n,s))for(e=i;e<n;e+=s)r=ji(e,t[e],t[e+1],r);else for(e=n-s;i<=e;e-=s)r=ji(e,t[e],t[e+1],r);return r&&Ei(r,r.next)&&(ki(r),r=r.next),r}function yi(t,i){if(!t)return t;i=i||t;var n,s=t;do{if(n=!1,s.steiner||!Ei(s,s.next)&&0!==Ai(s.prev,s,s.next))s=s.next;else{if(ki(s),(s=i=s.prev)===s.next)break;n=!0}}while(n||s!==i);return i}function mi(t,i,n,s,h,e,r){if(t){!r&&e&&function(t,i,n,s){var h=t;for(;null===h.z&&(h.z=gi(h.x,h.y,i,n,s)),h.prevZ=h.prev,h.nextZ=h.next,h=h.next,h!==t;);h.prevZ.nextZ=null,h.prevZ=null,function(t){var i,n,s,h,e,r,o,u,a=1;do{for(n=t,e=t=null,r=0;n;){for(r++,s=n,i=o=0;i<a&&(o++,s=s.nextZ);i++);for(u=a;0<o||0<u&&s;)0!==o&&(0===u||!s||n.z<=s.z)?(n=(h=n).nextZ,o--):(s=(h=s).nextZ,u--),e?e.nextZ=h:t=h,h.prevZ=e,e=h;n=s}}while(e.nextZ=null,a*=2,1<r)}(h)}(t,s,h,e);for(var o,u,a=t;t.prev!==t.next;)if(o=t.prev,u=t.next,e?function(t,i,n,s){var h=t.prev,e=t,r=t.next;if(0<=Ai(h,e,r))return!1;var o=(h.x<e.x?h.x<r.x?h:r:e.x<r.x?e:r).x,u=(h.y<e.y?h.y<r.y?h:r:e.y<r.y?e:r).y,a=(h.x>e.x?h.x>r.x?h:r:e.x>r.x?e:r).x,c=(h.y>e.y?h.y>r.y?h:r:e.y>r.y?e:r).y,f=gi(o,u,i,n,s),l=gi(a,c,i,n,s),v=t.prevZ,d=t.nextZ;for(;v&&v.z>=f&&d&&d.z<=l;){if(v!==t.prev&&v!==t.next&&bi(h.x,h.y,e.x,e.y,r.x,r.y,v.x,v.y)&&0<=Ai(v.prev,v,v.next))return!1;if(v=v.prevZ,d!==t.prev&&d!==t.next&&bi(h.x,h.y,e.x,e.y,r.x,r.y,d.x,d.y)&&0<=Ai(d.prev,d,d.next))return!1;d=d.nextZ}for(;v&&v.z>=f;){if(v!==t.prev&&v!==t.next&&bi(h.x,h.y,e.x,e.y,r.x,r.y,v.x,v.y)&&0<=Ai(v.prev,v,v.next))return!1;v=v.prevZ}for(;d&&d.z<=l;){if(d!==t.prev&&d!==t.next&&bi(h.x,h.y,e.x,e.y,r.x,r.y,d.x,d.y)&&0<=Ai(d.prev,d,d.next))return!1;d=d.nextZ}return!0}(t,s,h,e):function(t){var i=t.prev,n=t,s=t.next;if(0<=Ai(i,n,s))return!1;var h=t.next.next;for(;h!==t.prev;){if(bi(i.x,i.y,n.x,n.y,s.x,s.y,h.x,h.y)&&0<=Ai(h.prev,h,h.next))return!1;h=h.next}return!0}(t))i.push(o.i/n),i.push(t.i/n),i.push(u.i/n),ki(t),t=u.next,a=u.next;else if((t=u)===a){r?1===r?mi(t=function(t,i,n){var s=t;do{var h=s.prev,e=s.next.next}while(!Ei(h,e)&&Ri(h,s,s.next,e)&&Si(h,e)&&Si(e,h)&&(i.push(h.i/n),i.push(s.i/n),i.push(e.i/n),ki(s),ki(s.next),s=t=e),s=s.next,s!==t);return yi(s)}(yi(t),i,n),i,n,s,h,e,2):2===r&&function(t,i,n,s,h,e){var r=t;do{for(var o=r.next.next;o!==r.prev;){if(r.i!==o.i&&function(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!function(t,i){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==i.i&&n.next.i!==i.i&&Ri(n,n.next,t,i))return!0}while(n=n.next,n!==t);return!1}(t,i)&&(Si(t,i)&&Si(i,t)&&function(t,i){var n=t,s=!1,h=(t.x+i.x)/2,e=(t.y+i.y)/2;for(;n.y>e!=n.next.y>e&&n.next.y!==n.y&&h<(n.next.x-n.x)*(e-n.y)/(n.next.y-n.y)+n.x&&(s=!s),n=n.next,n!==t;);return s}(t,i)&&(Ai(t.prev,t,i.prev)||Ai(t,i.prev,i))||Ei(t,i)&&0<Ai(t.prev,t,t.next)&&0<Ai(i.prev,i,i.next))}(r,o)){var u=Oi(r,o);return r=yi(r,r.next),u=yi(u,u.next),mi(r,i,n,s,h,e),mi(u,i,n,s,h,e)}o=o.next}}while(r=r.next,r!==t)}(t,i,n,s,h,e):mi(yi(t),i,n,s,h,e,1);break}}}function wi(t,i){return t.x-i.x}function gi(t,i,n,s,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*h)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-s)*h)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function bi(t,i,n,s,h,e,r,o){return 0<=(h-r)*(i-o)-(t-r)*(e-o)&&0<=(t-r)*(s-o)-(n-r)*(i-o)&&0<=(n-r)*(e-o)-(h-r)*(s-o)}function Ai(t,i,n){return(i.y-t.y)*(n.x-i.x)-(i.x-t.x)*(n.y-i.y)}function Ei(t,i){return t.x===i.x&&t.y===i.y}function Ri(t,i,n,s){var h=Ti(Ai(t,i,n)),e=Ti(Ai(t,i,s)),r=Ti(Ai(n,s,t)),o=Ti(Ai(n,s,i));return h!==e&&r!==o||(0===h&&xi(t,n,i)||(0===e&&xi(t,s,i)||(0===r&&xi(n,t,s)||!(0!==o||!xi(n,i,s)))))}function xi(t,i,n){return i.x<=Math.max(t.x,n.x)&&i.x>=Math.min(t.x,n.x)&&i.y<=Math.max(t.y,n.y)&&i.y>=Math.min(t.y,n.y)}function Ti(t){return 0<t?1:t<0?-1:0}function Si(t,i){return Ai(t.prev,t,t.next)<0?0<=Ai(t,i,t.next)&&0<=Ai(t,t.prev,i):Ai(t,i,t.prev)<0||Ai(t,t.next,i)<0}function Oi(t,i){var n=new Bi(t.i,t.x,t.y),s=new Bi(i.i,i.x,i.y),h=t.next,e=i.prev;return(t.next=i).prev=t,(n.next=h).prev=n,(s.next=n).prev=s,(e.next=s).prev=e,s}function ji(t,i,n,s){n=new Bi(t,i,n);return s?(n.next=s.next,(n.prev=s).next.prev=n,s.next=n):(n.prev=n).next=n,n}function ki(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Bi(t,i,n){this.i=t,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ii(t){return function(t){if(Array.isArray(t))return Vi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,i){if(t){if("string"==typeof t)return Vi(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vi(t,i):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vi(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,s=new Array(i);n<i;n++)s[n]=t[n];return s}var Ci={area:function(t){for(var i=t.length,n=0,s=i-1,h=0;h<i;s=h++)n+=t[s].x*t[h].y-t[h].x*t[s].y;return.5*n},isClockWise:function(t){return Ci.area(t)<0},triangulateShape:function(t,i){var n=[],s=[],h=[];Hi(t),Fi(n,t);var e=t.length;i.forEach(Hi);for(var r=0;r<i.length;r++)s.push(e),e+=i[r].length,Fi(n,i[r]);for(var o=Mi(n,s),u=0;u<o.length;u+=3)h.push(o.slice(u,u+3));return h},triangulate:function(t){(h=[]).push.apply(h,Ii(t[0]));for(var i=[],n=1;n<t.length;n++){var s=[];s.push.apply(s,Ii(t[n])),i.push(s)}if(!Ci.isClockWise(h))for(var h=h.reverse(),e=0,r=i.length;e<r;e++){var o=i[e];Ci.isClockWise(o)&&(i[e]=o.reverse())}return Ci.triangulateShape(h,i)}};function Hi(t){var i,n=t.length;2<n&&(i=t[n-1],n=t[0],i.x===n.x&&i.y===n.y)&&t.pop()}function Fi(t,i){for(var n=0;n<i.length;n++)t.push(i[n].x),t.push(i[n].y)}var Pi=1e-5,Li=Math.PI/180,Yi=180/Math.PI,Di=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t)};Object.assign(Di.prototype,{Ot:function(){return Pi},jt:function(){return Li},kt:function(){return Yi},Bt:function(t){return t<Pi&&-Pi<t},It:function(t){return Pi<t},Vt:function(t){return t<-Pi},Ct:function(t,i,n){n=(t.x-n.x)*(i.y-n.y)-(i.x-n.x)*(t.y-n.y);return Math.abs(n)<Pi?0:n},distanceOfTwoPoints:function(t,i){return t&&i?Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)):Number.NaN},distance:function(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},isPolygonContainPoint:function(t,i){for(var n=0,s=0;s<t.length;s++){var h=t[s].x,e=t[s].y,r=0,o=0,o=s<t.length-1?(r=t[s+1].x,t[s+1].y):(r=t[0].x,t[0].y);if(h===i.x&&e===i.y||r===i.x&&o===i.y)return!0;if(o!==e){var u=h+(i.y-e)*(r-h)/(o-e);if(u===i.x)return!0;h!==r?u<=Math.max(h,r)&&u>=Math.min(h,r)&&u>i.x&&u!==h&&(u===r&&0<(e-i.y)*(o-i.y)?n+=2:n++):u<=Math.max(h,r)&&u>=Math.min(h,r)&&u>i.x&&(u===r&&0<(e-i.y)*(o-i.y)?n+=2:n++)}}return 0<n%2},Ht:function(t,i,n,s){return!(Math.max(t.x,i.x)<Math.min(n.x,s.x))&&(!(Math.max(t.y,i.y)<Math.min(n.y,s.y))&&(!(Math.max(n.x,s.x)<Math.min(t.x,i.x))&&!(Math.max(n.y,s.y)<Math.min(t.y,i.y))))},Ft:function(t,i,n,s){return!(Math.max(t.x,i.x)<Math.min(n.x,s.x))&&(!(Math.max(t.y,i.y)<Math.min(n.y,s.y))&&(!(Math.max(n.x,s.x)<Math.min(t.x,i.x))&&(!(Math.max(n.y,s.y)<Math.min(t.y,i.y))&&((0!==this.Ct(n,i,t)||0!==this.Ct(i,s,t))&&(!(this.Ct(n,i,t)*this.Ct(i,s,t)<0)&&!(this.Ct(t,s,n)*this.Ct(s,i,n)<0))))))},Pt:function(t,i,n){return!(t.x<i.x)&&(!(t.y<i.y)&&(!(t.x>n.x)&&!(t.y>n.y)))},Lt:function(t,i,n){var s=Math.min(i.x,n.x),h=Math.max(i.x,n.x),e=Math.min(i.y,n.y),n=Math.max(i.y,n.y);return!(t.x<s||t.x>h||t.y<e||t.y>n)},Yt:function(t,i,n){var s=Math.min(n.x,i.x),h=Math.max(n.x,i.x),e=Math.min(n.y,i.y),i=Math.max(n.y,i.y);return!(t.x<s||t.x>h||t.y<e||t.y>i)},Dt:function(t,i,n){for(var s,h,e=!1,r=0;r<n;r++)s=i[r],h=i[(r+1)%n],(s.y<t.y&&h.y>=t.y||h.y<t.y&&s.y>=t.y)&&(s.x<=t.x||h.x<=t.x)&&s.x+(t.y-s.y)/(h.y-s.y)*(h.x-s.x)<t.x&&(e=!e);return e},_t:function(t,i,n){return(t.x-i.x)*(n.y-i.y)==(n.x-i.x)*(t.y-i.y)&&Math.min(i.x,n.x)<=t.x&&t.x<=Math.max(i.x,n.x)&&Math.min(i.y,n.y)<=t.y&&t.y<=Math.max(i.y,n.y)},Xt:function(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))},Nt:function(t,i){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)},Ut:function(t,i,n){var s=i.x,h=i.y,e=n.x,r=n.y,o=t.x,u=t.y,a=e-s,c=r-h,f=a*a+c*c,i=o-s,n=u-h,t=i*i+n*n;if(this.Bt(f))return l=this.Bt(t)?0:t;var l,f=Math.sqrt(f),a=a/f,c=c/f,n=a*i+c*n;return l=this.It(n)?this.Vt(n-f)?(a=o-(s+n*a))*a+(c=u-(h+n*c))*c:(e=o-e)*e+(r=u-r)*r:t,this.Bt(l)?0:l},Zt:function(t,i,n,s){var h=i.x,e=i.y,r=n.x,o=n.y,u=t.x,a=t.y,c=r-h,f=o-e,l=Math.sqrt(c*c+f*f),v=u-h,d=a-e,t=Math.sqrt(v*v+d*d);if(this.Bt(l))return s.x=i.x,s.y=i.y,this.Bt(M=t)?0:M;var c=c/l,f=f/l,d=c*v+f*d,M=this.It(d)?this.Vt(d-l)?(c=u-(h=h+d*c),f=a-(d=e+d*f),f=Math.sqrt(c*c+f*f),s.x=h,s.y=d,f):(r=u-r,o=a-o,o=Math.sqrt(r*r+o*o),s.x=n.x,s.y=n.y,o):(s.x=i.x,s.y=i.y,t);return this.Bt(M)?0:M},Gt:function(t,i){for(var n=0,s=0,h=0,e=0;e<i;e++){var r=t[e],o=t[(e+1)%i],u=(r.x*o.y-r.y*o.x)/2;n+=u,s+=u*(r.x+o.x)/3,h+=u*(r.y+o.y)/3}return{x:s/=n,y:h/=n}},qt:function(t){for(var i=Ci.triangulate([t]),n=0,s=0,h=0,e=0;e<i.length;e++){var r=t[i[e][0]],o=t[i[e][1]],u=t[i[e][2]],a=o.x-r.x,c=o.y-r.y,f=u.x-r.x,c=(a*(u.y-r.y)-f*c)/2;n+=c,s+=(r.x+o.x+u.x)/3*c,h+=(r.y+o.y+u.y)/3*c}return{x:s/n,y:h/n}},Qt:function(t,i){if(i<3)return 0;for(var n=0,s=0;s<i;++s){var h=t[s],e=t[(s+1)%i];n+=h.x*e.y-h.y*e.x}return Math.abs(n/2)},zt:function(t,i,n,s,h){if(this.Ft(t,i,n,s)){var e=(s.x-n.x)*(t.y-i.y)-(i.x-t.x)*(n.y-s.y),r=(t.y-n.y)*(i.x-t.x)*(s.x-n.x)+n.x*(s.y-n.y)*(i.x-t.x)-t.x*(i.y-t.y)*(s.x-n.x);return h.x=r/e,e=(t.x-i.x)*(s.y-n.y)-(i.y-t.y)*(n.x-s.x),r=i.y*(t.x-i.x)*(s.y-n.y)+(s.x-i.x)*(s.y-n.y)*(t.y-i.y)-s.y*(n.x-s.x)*(i.y-t.y),h.y=r/e,1}return 0},Wt:function(t,i,n,s,h){var e=Math.min(n.x,s.x),r=Math.max(n.x,s.x),o=Math.min(n.y,s.y),u=Math.max(n.y,s.y),a=t.x,c=t.y,f=n.x,l=n.y,v=s.x,d=s.y;if(90==i){if(t.x<e||t.x>r)return!1;var M=(d-l)/(v-f)*(a-f)+l;return h.y=M,h.x=a,M<c?!1:!!this.Yt(h,n,s)}if(270==i){if(t.x<e||t.x>r)return!1;t=(d-l)/(v-f)*(a-f)+l;return h.y=t,h.x=a,c<t?!1:!!this.Yt(h,n,s)}if(270!=i&&90!=i&&Math.abs(r-e<.001)){r=e,e=Math.tan(i/180*Math.PI)*(r-a)+c;if(h.y=e,h.x=r,this.Yt(h,n,s)){r=r-a,e=e-c;return 0<r/Math.sqrt(r*r+e*e)*Math.cos(i/180*Math.PI)}}if(Math.abs(u-o<=.001)){u=o,o=1/Math.tan(i/180*Math.PI)*(u-c)+a;if(h.x=o,h.y=u,this.Yt(h,n,s)){var o=o-a,p=u-c;return 0<o/Math.sqrt(o*o+p*p)*Math.cos(i/180*Math.PI)}return!1}p=Math.tan(i/180*Math.PI),v=(d-l)/(v-f),v=(l-c-(v*f-p*a))/(p-v),p=c+p*(v-a);if(h.x=v,h.y=p,this.Yt(h,n,s)){a=v-a,c=p-c;return Math.abs(a)<=.001&&Math.abs(c)<=.001?!0:0<a/Math.sqrt(a*a+c*c)*Math.cos(i/180*Math.PI)}return!1},Jt:function(t,i){return Math.abs(t.x-i.x)<Pi&&Math.abs(t.y-i.y)<Pi},Kt:function(t,i,n,s){var h=t.x,e=t.y,r=i.x,o=i.y,u=n.x,a=n.y;if(this.Jt(t,i)||this.Jt(t,n))return s.x=h,s.y=e,!0;var c=Math.min(i.x,n.x),f=Math.max(i.x,n.x),l=Math.min(i.y,n.y),v=Math.max(i.y,n.y);if(Math.abs(r-u)<1e-5)return s.x=r,l<=(s.y=e)&&e<=v;if(Math.abs(o-a)<1e-5)return s.x=h,s.y=o,c<=h&&h<=f;f=-1/((a-o)/(u-r)),u=(a-o)/(u-r),u=(o-e-(u*r-f*h))/(f-u),h=e+f*(u-h);return s.x=u,s.y=h,!!this.Yt(s,i,n)||!(!this.Jt(t,i)&&!this.Jt(t,n))},$t:function(t,i){return{x:t.y*i.z-t.z*i.y,y:t.z*i.x-t.x*i.z,z:t.x*i.y-t.y*i.x}},ti:function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},ii:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},ni:function(t,i){return t.x*i.x+t.y*i.y},si:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},hi:function(t,i){if(0==t.x&&0==t.y||0==i.x&&0==i.y)return 0;var n={x:t.x,y:t.y,z:0},s={x:i.x,y:i.y,z:0},n=this.$t(n,s),s=this.ni(t,i),i=Math.acos(s/(this.si(t)*this.si(i)));return 0<n.z?i/Math.PI*180:360-i/Math.PI*180},ei:function(t,i,n,s){for(var h=0;h<n.length;h++){var e=n[h],r=n[(h+1)%n.length];if(1==this.zt(t,i,e,r,s))return!0}return!1},ri:function(t,i,n,s,h){var e=Math.min(t.x,n.x,s.x),r=Math.max(t.x,n.x,s.x),o=Math.min(t.y,n.y,s.y),u=Math.max(t.y,n.y,s.y),u=Math.sqrt((r-e)*(r-e)+(u-o)*(u-o)),o=i/180*Math.PI,i=u*Math.cos(o)+t.x,o=u*Math.sin(o)+t.y;return 1==this.zt(t,{x:i,y:o},n,s,h)},oi:function(t){for(var i={x:null,y:null},n=0,s=0,h=0;h<t.length;h++)n+=t[h].x,s+=t[h].y;return i.x=n/t.length,i.y=s/t.length,i},ui:function(t,i,n,s){var h=[],e=t.x-i,r=t.x+i,o=t.y-i,u=t.y+i,a=Math.min(n.x,s.x),c=Math.max(n.x,s.x),f=Math.min(n.y,s.y),l=Math.max(n.y,s.y);if(c<e||r<a||l<o||u<f)return h;e=s.x-n.x,r=s.y-n.y,o=t.x-n.x,u=t.y-n.y,s=e*e+r*r,t=(e*o+r*u)/s,i=t*t-(o*o+u*u-i*i)/s;if(i<0)return h;s=Math.sqrt(i),i=-t+s,t=-t-s,s={x:n.x-e*i,y:n.y-r*i},r={x:n.x-e*t,y:n.y-r*t};return i===t||(a<=s.x&&s.x<=c&&f<=s.y&&s.y<=l&&h.push(s),a<=r.x&&r.x<=c&&f<=r.y&&r.y<=l&&h.push(r)),h}});var _i=new Di;function Xi(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var Ni=function(){function i(t){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),this.I=t,this.W=this.I.getContainer(),this.ai={border:"border:2px solid #0000FF",backgroundColor:null,opacity:null},this.ci=[di.MODEL,di.FACILITY,di.LABEL,di.EXTERNAL_MODEL],this.fi=0,this.li=!1,this.J=this.J.bind(this),this.K=this.K.bind(this),this.$=this.$.bind(this),this.vi=null,this.di=null,this.nt=new ai,this.Mi=new fengmap.FMSearchAnalyser({map:this.I}),this.et()}var t,n,s;return t=i,(n=[{key:"dispose",value:function(){this.W.removeEventListener("mousedown",this.J,!1),document.removeEventListener("mousemove",this.K,!1),document.removeEventListener("mouseup",this.$,!1),this.Mi.dispose()}},{key:"boxStyle",get:function(){return this.ai},set:function(t){this.ai=t}},{key:"enable",get:function(){return this.li},set:function(t){this.li=t}},{key:"mouseKey",get:function(){return 0===this.fi?"left":"right"},set:function(t){this.fi="left"===t?0:2}},{key:"types",get:function(){return this.ci},set:function(t){this.ci=t}},{key:"on",value:function(t,i){this.nt.O(t,i)}}])&&Xi(t.prototype,n),s&&Xi(t,s),i}();Object.assign(Ni.prototype,{et:function(){this.I.getRenderManager().renderer.domElement.style.left="0px",this.W.addEventListener("mousedown",this.J,!1),document.addEventListener("mousemove",this.K,!1),document.addEventListener("mouseup",this.$,!1)},pi:function(t){return{x:t.getBoundingClientRect().left,y:t.getBoundingClientRect().top}},J:function(t){var i,n;this.li&&t.button===this.fi&&(this.vi&&this.vi.parentNode&&(this.vi.parentNode.removeChild(this.vi),this.vi=null),n=this.pi(this.I.getRenderManager().renderer.domElement),i=t.clientX-n.x,n=t.clientY-n.y,this.di={x:i,y:n},this.gt(!1),this.vi=document.createElement("div"),this.vi.style.cssText="position:absolute;top:"+n+"px;left:"+i+"px;width:0px;height:0px;"+this.ai.border+";",this.W.appendChild(this.vi),this.ai.backgroundColor&&(this.vi.style.backgroundColor=this.ai.backgroundColor),void 0!==this.ai.opacity&&null!==this.ai.opacity&&(this.vi.style.opacity=this.ai.opacity))},K:function(t){var i,n;this.li&&null!==this.di&&(n=this.pi(this.I.getRenderManager().renderer.domElement),i=t.clientX-n.x,n=t.clientY-n.y,i<this.di.x&&(this.vi.style.left=i+"px"),n<this.di.y&&(this.vi.style.top=n+"px"),this.vi.style.width=Math.abs(i-this.di.x)+"px",this.vi.style.height=Math.abs(n-this.di.y)+"px")},$:function(t){var m=this;if(this.li&&null!==this.vi&&t.button===this.fi){this.gt(!0);var w=this.yi(),s=[],i=this.I.getMapOptions(),n=[],h=[];if(i.buildings&&0<i.buildings.length)for(var e=0;e<i.buildings.length;e++)!function(t){for(var i=m.I.getBuilding(t).bound,t=i.min,i=i.max,n=[{x:t.x,y:t.y},{x:t.x,y:i.y},{x:i.x,y:i.y},{x:i.x,y:t.y}],s=0;s<n.length;s++)if(_i.Dt(n[s],w,w.length))return!0;for(var h=0;h<w.length;h++)if(_i.Dt(w[h],n,n.length))return!0;for(var e=0;e<w.length-1;e++){for(var r=w[e],o=w[e+1],u=0;u<n.length-1;u++){var a=n[u],c=n[u+1];if(_i.Ft(r,o,a,c))return!0}var f=n[n.length-1],l=n[0];if(_i.Ft(r,o,l,f))return!0}for(var v=w[0],d=w[w.length-1],M=0;M<n.length-1;M++){var p=n[M],y=n[M+1];if(_i.Ft(v,d,p,y))return!0}i=n[n.length-1],t=n[0];if(_i.Ft(v,d,t,i))return!0}(i.buildings[e].bid)||(n.push(i.buildings[e].mid),h.push(i.buildings[e].bid));for(var r=[],o=0;o<this.ci.length;o++){var u=new fengmap.FMSearchRequest;u.levels=[this.I.getBuilding(i.buildingID).level],u.type=this.ci[o],u.addCondition({polygon:w});for(var a=[],c=0;c<h.length;c++)a.push({buildingID:h[c],levels:[this.I.getBuilding(h[c]).level]});0<a.length&&(u.buildings=a),r.push(u)}this.di=null,this.vi.parentNode&&this.vi.parentNode.removeChild(this.vi),this.vi=null;var f,l=0;f=null,function i(){var n;l<r.length?(n=r[l],m.Mi.query(n,function(t){s.push({type:n.type,children:t}),l++,f=setTimeout(i(),1)})):(null!==f&&clearTimeout(f),m.nt.B({type:"boxselected",targets:s,coords:w}))}()}},gt:function(t){var i=this.I.getInteracations();i.enableDrag=t,i.enableRotate=t,i.enableTilt=t,i.enableZoom=t},yi:function(){var t=[],i=this.vi.getBoundingClientRect(),n=this.pi(this.I.getRenderManager().renderer.domElement),s=n.x,n=n.y;t.push({x:i.left-s,y:i.top-n}),t.push({x:i.right-s,y:i.top-n}),t.push({x:i.right-s,y:i.bottom-n}),t.push({x:i.left-s,y:i.bottom-n});for(var h=[],e=0;e<t.length;e++){var r=fengmap.FMUtil.coordsScreenToMap(this.I,t[e]);h.push(r)}return h}});n=Ni;function Ui(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var Zi=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t)}var i,n,s;return i=t,s=[{key:"round",value:function(t){return 0<t.toFixed(2)?Math.ceil(t.toFixed(2)):Math.floor(t.toFixed(2))}},{key:"generateUUID",value:function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);var n=4294967295*Math.random()|0,s=4294967295*Math.random()|0,h=4294967295*Math.random()|0,e=4294967295*Math.random()|0,e=t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&s]+t[s>>8&255]+"-"+t[s>>16&15|64]+t[s>>24&255]+"-"+t[63&h|128]+t[h>>8&255]+"-"+t[h>>16&255]+t[h>>24&255]+t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255];return t.length=0,e.toUpperCase()}},{key:"findNearNthPowerOfTwo",value:function(t){t-=1;return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)<0?1:1+t}},{key:"toRgba",value:function(t){if(void 0===t)return t;if("number"==typeof t)return"rgba("+parseInt(255*new P(t).r)+","+parseInt(255*new P(t).g)+","+parseInt(255*new P(t).b)+",1)";var i=t.split(",");return 3<=i.length?"rgba("+parseInt(i[0])+","+parseInt(i[1])+","+parseInt(i[2])+",1)":t}},{key:"toColor",value:function(t){if("number"==typeof t)return t;var i=t.split(",");return 3<=i.length?parseInt(i[0])<<16|parseInt(i[1])<<8|parseInt(i[2]):(console.error("color format error",t),0)}}],(n=null)&&Ui(i.prototype,n),s&&Ui(i,s),t}();function Gi(t){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Qi(t,i,n){return(Qi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,i,n){t=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Ji(t)););return t}(t,i);if(t){i=Object.getOwnPropertyDescriptor(t,i);return i.get?i.get.call(n):i.value}})(t,i,n||t)}function zi(t,i){return(zi=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function Wi(n){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Ji(n);return t=s?(t=Ji(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),i=this,!(t=t)||"object"!==Gi(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(i):t}}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}ui=function(){!function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&zi(t,i)}(h,fengmap.FMImageMarker);var t,i,n,s=Wi(h);function h(t){var i;return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,h),(i=s.call(this,t)).info2=t,i.id=""+Zi.generateUUID(),i.shapetype2="point",i.opetype2="no",t.opetype&&(i.opetype2=t.opetype,i.shapetype2="no"),i.mapEdit=null,i}return t=h,(i=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.x=this.e,this.info2.y=this.u,this.info2.height=this.mi,this.info2.shapetype=this.shapetype,this.info2.level=this.level,this.info2}},{key:"opetype",get:function(){if(this.opetype2)return{node:this.getRenderNode(),type:this.opetype2}}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){Qi(Ji(h.prototype),"remove",this).call(this)}}])&&qi(t.prototype,i),n&&qi(t,n),h}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $i(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function tn(t,i,n){return(tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,i,n){t=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=hn(t)););return t}(t,i);if(t){i=Object.getOwnPropertyDescriptor(t,i);return i.get?i.get.call(n):i.value}})(t,i,n||t)}function nn(t,i){return(nn=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function sn(n){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=hn(n);return t=s?(t=hn(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),i=this,!(t=t)||"object"!==Ki(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(i):t}}function hn(t){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}fi=function(){!function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&nn(t,i)}(h,fengmap.FMPolygonMarker);var t,i,n,s=sn(h);function h(t){var i;return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,h),(i=s.call(this,t)).info2=t,i.shapetype2="polygon",i.id=""+Zi.generateUUID(),t.shapetype&&(i.shapetype2=t.shapetype),i.mapEdit=null,i}return t=h,(i=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.shapetype=this.shapetype2,this.info2.level=this.level,this.info2.buildingID=this.parent.parent.parent.buildingID,this.info2}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){if(tn(hn(h.prototype),"remove",this).call(this),null!==this.mapEdit&&this.mapEdit.U&&this.mapEdit.U.id===this.id){for(var t=0;t<this.mapEdit._.length;t++)this.mapEdit._[t].remove();this.mapEdit._.length=0}}}])&&$i(t.prototype,i),n&&$i(t,n),h}();function en(t){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rn(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function on(t,i,n){return(on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,i,n){t=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=cn(t)););return t}(t,i);if(t){i=Object.getOwnPropertyDescriptor(t,i);return i.get?i.get.call(n):i.value}})(t,i,n||t)}function un(t,i){return(un=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function an(n){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=cn(n);return t=s?(t=cn(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),i=this,!(t=t)||"object"!==en(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(i):t}}function cn(t){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}vi=function(){!function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&un(t,i)}(h,fengmap.FMLineMarker);var t,i,n,s=an(h);function h(t){var i;return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,h),(i=s.call(this,t)).shapetype2="line",i.info2=t,i.id=""+Zi.generateUUID(),i.mapEdit=null,i}return t=h,(i=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.points=this.points,this.info2.shapetype=this.shapetype,this.info2.level=this.segments[0].level,this.info2.buildingID=this.segments[0].buildingID,this.info2}},{key:"points",get:function(){return 0===this.segments.length?[]:this.segments[0].points}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){if(on(cn(h.prototype),"remove",this).call(this),null!==this.mapEdit&&this.mapEdit.U&&this.mapEdit.U.id===this.id){for(var t=0;t<this.mapEdit._.length;t++)this.mapEdit._[t].remove();this.mapEdit._.length=0}}}])&&rn(t.prototype,i),n&&rn(t,n),h}(),Di=1330,Ni=window.fengmap||{};Ni.VERSION="v3.1.0",Ni.BUILD=Di,Ni.FMMapEditor=li,Ni.FMBoxSelectTool=n,Ni.FMImageMarkerEdit=ui,Ni.FMPolygonMarkerEdit=fi,Ni.FMLineMarkerEdit=vi;i.default=Ni}],h.c=s,h.d=function(t,i,n){h.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"wi",{value:!0})},h.t=function(i,t){if(1&t&&(i=h(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.wi)return i;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var s in i)h.d(n,s,function(t){return i[t]}.bind(null,s));return n},h.n=function(t){var i=t&&t.wi?function(){return t.default}:function(){return t};return h.d(i,"a",i),i},h.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},h.p="",h(h.s=0).default;function h(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return n[t].call(i.exports,i,i.exports,h),i.l=!0,i.exports}var n,s});