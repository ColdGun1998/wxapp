/**Released Version v3.1.0,BUILD 1329,Time 1666271059422. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.fengmap=n():t.fengmap=n()}(this,function(){return e={},r.m=i=[function(t,n,i){"use strict";i.r(n);for(var r=[],e=0;e<256;e++)r[e]=(e<16?"0":"")+e.toString(16);var f={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&n]+r[n>>8&255]+"-"+r[n>>16&15|64]+r[n>>24&255]+"-"+r[63&i|128]+r[i>>8&255]+"-"+r[i>>16&255]+r[i>>24&255]+r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255]).toUpperCase()},clamp:function(t,n,i){return Math.max(n,Math.min(i,t))},euclideanModulo:function(t,n){return(t%n+n)%n},mapLinear:function(t,n,i,e,r){return e+(t-n)*(r-e)/(i-n)},lerp:function(t,n,i){return(1-i)*t+i*n},smoothstep:function(t,n,i){return t<=n?0:i<=t?1:(t=(t-n)/(i-n))*t*(3-2*t)},smootherstep:function(t,n,i){return t<=n?0:i<=t?1:(t=(t-n)/(i-n))*t*t*(t*(6*t-15)+10)},randInt:function(t,n){return t+Math.floor(Math.random()*(n-t+1))},randFloat:function(t,n){return t+Math.random()*(n-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*f.DEG2RAD},radToDeg:function(t){return t*f.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,n,i,e,r){var s=Math.cos,a=Math.sin,h=s(i/2),o=a(i/2),u=s((n+e)/2),c=a((n+e)/2),l=s((n-e)/2),i=a((n-e)/2),s=s((e-n)/2),n=a((e-n)/2);"XYX"===r?t.set(h*c,o*l,o*i,h*u):"YZY"===r?t.set(o*i,h*c,o*l,h*u):"ZXZ"===r?t.set(o*l,o*i,h*c,h*u):"XZX"===r?t.set(h*c,o*n,o*s,h*u):"YXY"===r?t.set(o*s,h*c,o*n,h*u):"ZYZ"===r?t.set(o*n,o*s,h*c,h*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function s(t,n,i,e){this.e=t||0,this.u=n||0,this.f=i||0,this.v=void 0!==e?e:1}Object.assign(s,{slerp:function(t,n,i,e){return i.copy(t).slerp(n,e)},slerpFlat:function(t,n,i,e,r,s,a){var h=i[e+0],o=i[e+1],u=i[e+2],c=i[e+3],l=r[s+0],f=r[s+1],d=r[s+2],v=r[s+3];c===v&&h===l&&o===f&&u===d||(i=1-a,r=0<=(e=h*l+o*f+u*d+c*v)?1:-1,(s=1-e*e)>Number.EPSILON&&(s=Math.sqrt(s),e=Math.atan2(s,e*r),i=Math.sin(i*e)/s,a=Math.sin(a*e)/s),h=h*i+l*(r=a*r),o=o*i+f*r,u=u*i+d*r,c=c*i+v*r,i===1-a&&(h*=a=1/Math.sqrt(h*h+o*o+u*u+c*c),o*=a,u*=a,c*=a)),t[n]=h,t[n+1]=o,t[n+2]=u,t[n+3]=c}}),Object.defineProperties(s.prototype,{x:{get:function(){return this.e},set:function(t){this.e=t,this._()}},y:{get:function(){return this.u},set:function(t){this.u=t,this._()}},z:{get:function(){return this.f},set:function(t){this.f=t,this._()}},w:{get:function(){return this.v},set:function(t){this.v=t,this._()}}}),Object.assign(s.prototype,{isQuaternion:!0,set:function(t,n,i,e){return this.e=t,this.u=n,this.f=i,this.v=e,this._(),this},clone:function(){return new this.constructor(this.e,this.u,this.f,this.v)},copy:function(t){return this.e=t.x,this.u=t.y,this.f=t.z,this.v=t.w,this._(),this},setFromEuler:function(t,n){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t.e,e=t.u,r=t.f,s=t.order,a=Math.cos,h=Math.sin,o=a(i/2),t=a(e/2),a=a(r/2),i=h(i/2),e=h(e/2),r=h(r/2);return"XYZ"===s?(this.e=i*t*a+o*e*r,this.u=o*e*a-i*t*r,this.f=o*t*r+i*e*a,this.v=o*t*a-i*e*r):"YXZ"===s?(this.e=i*t*a+o*e*r,this.u=o*e*a-i*t*r,this.f=o*t*r-i*e*a,this.v=o*t*a+i*e*r):"ZXY"===s?(this.e=i*t*a-o*e*r,this.u=o*e*a+i*t*r,this.f=o*t*r+i*e*a,this.v=o*t*a-i*e*r):"ZYX"===s?(this.e=i*t*a-o*e*r,this.u=o*e*a+i*t*r,this.f=o*t*r-i*e*a,this.v=o*t*a+i*e*r):"YZX"===s?(this.e=i*t*a+o*e*r,this.u=o*e*a+i*t*r,this.f=o*t*r-i*e*a,this.v=o*t*a-i*e*r):"XZY"===s&&(this.e=i*t*a-o*e*r,this.u=o*e*a-i*t*r,this.f=o*t*r+i*e*a,this.v=o*t*a+i*e*r),!1!==n&&this._(),this},setFromAxisAngle:function(t,n){var i=n/2,n=Math.sin(i);return this.e=t.x*n,this.u=t.y*n,this.f=t.z*n,this.v=Math.cos(i),this._(),this},setFromRotationMatrix:function(t){var n,i=t.elements,e=i[0],r=i[4],s=i[8],a=i[1],h=i[5],o=i[9],u=i[2],c=i[6],t=i[10],i=e+h+t;return 0<i?(n=.5/Math.sqrt(i+1),this.v=.25/n,this.e=(c-o)*n,this.u=(s-u)*n,this.f=(a-r)*n):h<e&&t<e?(n=2*Math.sqrt(1+e-h-t),this.v=(c-o)/n,this.e=.25*n,this.u=(r+a)/n,this.f=(s+u)/n):t<h?(n=2*Math.sqrt(1+h-e-t),this.v=(s-u)/n,this.e=(r+a)/n,this.u=.25*n,this.f=(o+c)/n):(n=2*Math.sqrt(1+t-e-h),this.v=(a-r)/n,this.e=(s+u)/n,this.u=(o+c)/n,this.f=.25*n),this._(),this},setFromUnitVectors:function(t,n){var i=t.dot(n)+1;return i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this.e=-t.y,this.u=t.x,this.f=0):(this.e=0,this.u=-t.z,this.f=t.y)):(this.e=t.y*n.z-t.z*n.y,this.u=t.z*n.x-t.x*n.z,this.f=t.x*n.y-t.y*n.x),this.v=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(f.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,n){var i=this.angleTo(t);if(0===i)return this;i=Math.min(1,n/i);return this.slerp(t,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.e*=-1,this.u*=-1,this.f*=-1,this._(),this},dot:function(t){return this.e*t.e+this.u*t.u+this.f*t.f+this.v*t.v},lengthSq:function(){return this.e*this.e+this.u*this.u+this.f*this.f+this.v*this.v},length:function(){return Math.sqrt(this.e*this.e+this.u*this.u+this.f*this.f+this.v*this.v)},normalize:function(){var t=this.length();return 0===t?(this.e=0,this.u=0,this.f=0,this.v=1):(this.e=this.e*(t=1/t),this.u=this.u*t,this.f=this.f*t,this.v=this.v*t),this._(),this},multiply:function(t,n){return void 0!==n?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,n)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,n){var i=t.e,e=t.u,r=t.f,s=t.v,a=n.e,h=n.u,t=n.f,n=n.v;return this.e=i*n+s*a+e*t-r*h,this.u=e*n+s*h+r*a-i*t,this.f=r*n+s*t+i*h-e*a,this.v=s*n-i*a-e*h-r*t,this._(),this},slerp:function(t,n){if(0===n)return this;if(1===n)return this.copy(t);var i=this.e,e=this.u,r=this.f,s=this.v,a=s*t.v+i*t.e+e*t.u+r*t.f;if(a<0?(this.v=-t.v,this.e=-t.e,this.u=-t.u,this.f=-t.f,a=-a):this.copy(t),1<=a)return this.v=s,this.e=i,this.u=e,this.f=r,this;t=1-a*a;if(t<=Number.EPSILON){var h=1-n;return this.v=h*s+n*this.v,this.e=h*i+n*this.e,this.u=h*e+n*this.u,this.f=h*r+n*this.f,this.normalize(),this._(),this}h=Math.sqrt(t),t=Math.atan2(h,a),a=Math.sin((1-n)*t)/h,h=Math.sin(n*t)/h;return this.v=s*a+this.v*h,this.e=i*a+this.e*h,this.u=e*a+this.u*h,this.f=r*a+this.f*h,this._(),this},equals:function(t){return t.e===this.e&&t.u===this.u&&t.f===this.f&&t.v===this.v},fromArray:function(t,n){return this.e=t[n=void 0===n?0:n],this.u=t[n+1],this.f=t[n+2],this.v=t[n+3],this._(),this},toArray:function(t,n){return(t=void 0===t?[]:t)[n=void 0===n?0:n]=this.e,t[n+1]=this.u,t[n+2]=this.f,t[n+3]=this.v,t},fromBufferAttribute:function(t,n){return this.e=t.getX(n),this.u=t.getY(n),this.f=t.getZ(n),this.v=t.getW(n),this},M:function(t){return this._=t,this},_:function(){}});var a=new m,h=new s;function m(t,n,i){this.x=t||0,this.y=n||0,this.z=i||0}function O(t,n){this.x=t||0,this.y=n||0}Object.assign(m.prototype,{isVector3:!0,set:function(t,n,i){return this.x=t,this.y=n,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this},addScaledVector:function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this},sub:function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this},multiply:function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,n)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(h.setFromEuler(t))},applyAxisAngle:function(t,n){return this.applyQuaternion(h.setFromAxisAngle(t,n))},applyMatrix3:function(t){var n=this.x,i=this.y,e=this.z,t=t.elements;return this.x=t[0]*n+t[3]*i+t[6]*e,this.y=t[1]*n+t[4]*i+t[7]*e,this.z=t[2]*n+t[5]*i+t[8]*e,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var n=this.x,i=this.y,e=this.z,r=t.elements,t=1/(r[3]*n+r[7]*i+r[11]*e+r[15]);return this.x=(r[0]*n+r[4]*i+r[8]*e+r[12])*t,this.y=(r[1]*n+r[5]*i+r[9]*e+r[13])*t,this.z=(r[2]*n+r[6]*i+r[10]*e+r[14])*t,this},applyQuaternion:function(t){var n=this.x,i=this.y,e=this.z,r=t.x,s=t.y,a=t.z,h=t.w,o=h*n+s*e-a*i,u=h*i+a*n-r*e,t=h*e+r*i-s*n,e=-r*n-s*i-a*e;return this.x=o*h+e*-r+u*-a-t*-s,this.y=u*h+e*-s+t*-r-o*-a,this.z=t*h+e*-a+o*-s-u*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var n=this.x,i=this.y,e=this.z,t=t.elements;return this.x=t[0]*n+t[4]*i+t[8]*e,this.y=t[1]*n+t[5]*i+t[9]*e,this.z=t[2]*n+t[6]*i+t[10]*e,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this},clampScalar:function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this},clampLength:function(t,n){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(n,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this},lerpVectors:function(t,n,i){return this.subVectors(n,t).multiplyScalar(i).add(t)},cross:function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,n)):this.crossVectors(this,t)},crossVectors:function(t,n){var i=t.x,e=t.y,r=t.z,s=n.x,t=n.y,n=n.z;return this.x=e*n-r*t,this.y=r*s-i*n,this.z=i*t-e*s,this},projectOnVector:function(t){var n=t.lengthSq();if(0===n)return this.set(0,0,0);n=t.dot(this)/n;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return a.copy(this).projectOnVector(t),this.sub(a)},reflect:function(t){return this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var n=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===n)return Math.PI/2;n=this.dot(t)/n;return Math.acos(f.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var n=this.x-t.x,i=this.y-t.y,t=this.z-t.z;return n*n+i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,n,i){var e=Math.sin(n)*t;return this.x=e*Math.sin(i),this.y=Math.cos(n)*t,this.z=e*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,n,i){return this.x=t*Math.sin(n),this.y=i,this.z=t*Math.cos(n),this},setFromMatrixPosition:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var n=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,n){return this.fromArray(t.elements,4*n)},setFromMatrix3Column:function(t,n){return this.fromArray(t.elements,3*n)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,n){return this.x=t[n=void 0===n?0:n],this.y=t[n+1],this.z=t[n+2],this},toArray:function(t,n){return(t=void 0===t?[]:t)[n=void 0===n?0:n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t},fromBufferAttribute:function(t,n,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this}}),Object.defineProperties(O.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(O.prototype,{isVector2:!0,set:function(t,n){return this.x=t,this.y=n,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,n){return void 0!==n?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this},addScaledVector:function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this},sub:function(t,n){return void 0!==n?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var n=this.x,i=this.y,t=t.elements;return this.x=t[0]*n+t[3]*i+t[6],this.y=t[1]*n+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this},clampScalar:function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this},clampLength:function(t,n){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(n,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var n=this.x-t.x,t=this.y-t.y;return n*n+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this},lerpVectors:function(t,n,i){return this.subVectors(n,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,n){return this.x=t[n=void 0===n?0:n],this.y=t[n+1],this},toArray:function(t,n){return(t=void 0===t?[]:t)[n=void 0===n?0:n]=this.x,t[n+1]=this.y,t},fromBufferAttribute:function(t,n,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this},rotateAround:function(t,n){var i=Math.cos(n),e=Math.sin(n),r=this.x-t.x,n=this.y-t.y;return this.x=r*i-n*e+t.x,this.y=r*e+n*i+t.y,this}});var o=[new m,new m,new m,new m,new m,new m,new m,new m],u=new m,c=new b,l=new m,d=new m,v=new m,p=new m,g=new m,_=new m,w=new m,y=new m,M=new m,x=new m;function b(t,n){this.min=void 0!==t?t:new m(1/0,1/0,1/0),this.max=void 0!==n?n:new m(-1/0,-1/0,-1/0)}function E(t,n,i,e,r){for(var s=0,a=t.length-3;s<=a;s+=3){x.fromArray(t,s);var h=r.x*Math.abs(x.x)+r.y*Math.abs(x.y)+r.z*Math.abs(x.z),o=n.dot(x),u=i.dot(x),c=e.dot(x);if(Math.max(-Math.max(o,u,c),Math.min(o,u,c))>h)return!1}return!0}Object.assign(b.prototype,{isBox3:!0,set:function(t,n){return this.min.copy(t),this.max.copy(n),this},setFromArray:function(t){for(var n=1/0,i=1/0,e=1/0,r=-1/0,s=-1/0,a=-1/0,h=0,o=t.length;h<o;h+=3){var u=t[h],c=t[h+1],l=t[h+2];u<n&&(n=u),c<i&&(i=c),l<e&&(e=l),r<u&&(r=u),s<c&&(s=c),a<l&&(a=l)}return this.min.set(n,i,e),this.max.set(r,s,a),this},setFromBufferAttribute:function(t){for(var n=1/0,i=1/0,e=1/0,r=-1/0,s=-1/0,a=-1/0,h=0,o=t.count;h<o;h++){var u=t.getX(h),c=t.getY(h),l=t.getZ(h);u<n&&(n=u),c<i&&(i=c),l<e&&(e=l),r<u&&(r=u),s<c&&(s=c),a<l&&(a=l)}return this.min.set(n,i,e),this.max.set(r,s,a),this},setFromPoints:function(t){this.makeEmpty();for(var n=0,i=t.length;n<i;n++)this.expandByPoint(t[n]);return this},setFromCenterAndSize:function(t,n){n=u.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new m),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new m),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var n=t.geometry;void 0!==n&&(null===n.boundingBox&&n.computeBoundingBox(),c.copy(n.boundingBox),c.applyMatrix4(t.matrixWorld),this.union(c));for(var i=t.children,e=0,r=i.length;e<r;e++)this.expandByObject(i[e]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,n){return void 0===n&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new m),n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,u),u.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var n,i=0<t.normal.x?(n=t.normal.x*this.min.x,t.normal.x*this.max.x):(n=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(n+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(n+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),n<=-t.constant&&i>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(w),y.subVectors(this.max,w),l.subVectors(t.a,w),d.subVectors(t.b,w),v.subVectors(t.c,w),p.subVectors(d,l),g.subVectors(v,d),_.subVectors(l,v);t=[0,-p.z,p.y,0,-g.z,g.y,0,-_.z,_.y,p.z,0,-p.x,g.z,0,-g.x,_.z,0,-_.x,-p.y,p.x,0,-g.y,g.x,0,-_.y,_.x,0];return!!E(t,l,d,v,y)&&(!!E(t=[1,0,0,0,1,0,0,0,1],l,d,v,y)&&(M.crossVectors(p,g),E(t=[M.x,M.y,M.z],l,d,v,y)))},clampPoint:function(t,n){return void 0===n&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new m),n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return u.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(u).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(o)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var T=new b;function S(t,n){this.center=void 0!==t?t:new m,this.radius=void 0!==n?n:0}Object.assign(S.prototype,{set:function(t,n){return this.center.copy(t),this.radius=n,this},setFromPoints:function(t,n){var i=this.center;void 0!==n?i.copy(n):T.setFromPoints(t).getCenter(i);for(var e=0,r=0,s=t.length;r<s;r++)e=Math.max(e,i.distanceToSquared(t[r]));return this.radius=Math.sqrt(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,n){var i=this.center.distanceToSquared(t);return void 0===n&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new m),n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new b),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var A=new m,k=new m,R=new m,D=new m,L=new m,P=new m,C=new m;function j(t,n){this.origin=void 0!==t?t:new m,this.direction=void 0!==n?n:new m(0,0,-1)}Object.assign(j.prototype,{set:function(t,n){return this.origin.copy(t),this.direction.copy(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,n){return void 0===n&&(console.warn("THREE.Ray: .at() target is now required"),n=new m),n.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,A)),this},closestPointToPoint:function(t,n){void 0===n&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new m),n.subVectors(t,this.origin);t=n.dot(this.direction);return t<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var n=A.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(A.copy(this.direction).multiplyScalar(n).add(this.origin),A.distanceToSquared(t))},distanceSqToSegment:function(t,n,i,e){k.copy(t).add(n).multiplyScalar(.5),R.copy(n).sub(t).normalize(),D.copy(this.origin).sub(k);var r,s,a=.5*t.distanceTo(n),h=-this.direction.dot(R),o=D.dot(this.direction),u=-D.dot(R),c=D.lengthSq(),t=Math.abs(1-h*h);return c=0<t?(s=h*o-u,n=a*t,0<=(r=h*u-o)?-n<=s?s<=n?(r*=t=1/t)*(r+h*(s*=t)+2*o)+s*(h*r+s+2*u)+c:(s=a,-(r=Math.max(0,-(h*s+o)))*r+s*(s+2*u)+c):(s=-a,-(r=Math.max(0,-(h*s+o)))*r+s*(s+2*u)+c):s<=-n?-(r=Math.max(0,-(-h*a+o)))*r+(s=0<r?-a:Math.min(Math.max(-a,-u),a))*(s+2*u)+c:s<=n?(r=0,(s=Math.min(Math.max(-a,-u),a))*(s+2*u)+c):-(r=Math.max(0,-(h*a+o)))*r+(s=0<r?a:Math.min(Math.max(-a,-u),a))*(s+2*u)+c):(s=0<h?-a:a,-(r=Math.max(0,-(h*s+o)))*r+s*(s+2*u)+c),i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),e&&e.copy(R).multiplyScalar(s).add(k),c},intersectSphere:function(t,n){A.subVectors(t.center,this.origin);var i=A.dot(this.direction),e=A.dot(A)-i*i,t=t.radius*t.radius;if(t<e)return null;t=Math.sqrt(t-e),e=i-t,t=i+t;return e<0&&t<0?null:e<0?this.at(t,n):this.at(e,n)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var n=t.normal.dot(this.direction);if(0===n)return 0===t.distanceToPoint(this.origin)?0:null;n=-(this.origin.dot(t.normal)+t.constant)/n;return 0<=n?n:null},intersectPlane:function(t,n){t=this.distanceToPlane(t);return null===t?null:this.at(t,n)},intersectsPlane:function(t){var n=t.distanceToPoint(this.origin);return 0===n||t.normal.dot(this.direction)*n<0},intersectBox:function(t,n){var i,e,r,s=1/this.direction.x,a=1/this.direction.y,h=1/this.direction.z,o=this.origin,s=0<=s?(i=(t.min.x-o.x)*s,(t.max.x-o.x)*s):(i=(t.max.x-o.x)*s,(t.min.x-o.x)*s),a=0<=a?(e=(t.min.y-o.y)*a,(t.max.y-o.y)*a):(e=(t.max.y-o.y)*a,(t.min.y-o.y)*a);return a<i||s<e?null:((a<s||s!=s)&&(s=a),(h=0<=h?(r=(t.min.z-o.z)*h,(t.max.z-o.z)*h):(r=(t.max.z-o.z)*h,(t.min.z-o.z)*h))<(i=i<e||i!=i?e:i)||s<r?null:((i<r||i!=i)&&(i=r),(s=h<s||s!=s?h:s)<0?null:this.at(0<=i?i:s,n)))},intersectsBox:function(t){return null!==this.intersectBox(t,A)},intersectTriangle:function(t,n,i,e,r){L.subVectors(n,t),P.subVectors(i,t),C.crossVectors(L,P);i=this.direction.dot(C);if(0<i){if(e)return null;s=1}else{if(!(i<0))return null;s=-1,i=-i}D.subVectors(this.origin,t);e=s*this.direction.dot(P.crossVectors(D,P));if(e<0)return null;t=s*this.direction.dot(L.cross(D));if(t<0)return null;if(i<e+t)return null;var s=-s*D.dot(C);return s<0?null:this.at(s/i,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var F=new m,N=new z,H=new m(0,0,0),B=new m(1,1,1),I=new m,U=new m,V=new m;function z(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function q(){}Object.assign(z.prototype,{isMatrix4:!0,set:function(t,n,i,e,r,s,a,h,o,u,c,l,f,d,v,p){var m=this.elements;return m[0]=t,m[4]=n,m[8]=i,m[12]=e,m[1]=r,m[5]=s,m[9]=a,m[13]=h,m[2]=o,m[6]=u,m[10]=c,m[14]=l,m[3]=f,m[7]=d,m[11]=v,m[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new z).fromArray(this.elements)},copy:function(t){var n=this.elements,t=t.elements;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],this},copyPosition:function(t){var n=this.elements,t=t.elements;return n[12]=t[12],n[13]=t[13],n[14]=t[14],this},extractBasis:function(t,n,i){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,n,i){return this.set(t.x,n.x,i.x,0,t.y,n.y,i.y,0,t.z,n.z,i.z,0,0,0,0,1),this},extractRotation:function(t){var n=this.elements,i=t.elements,e=1/F.setFromMatrixColumn(t,0).length(),r=1/F.setFromMatrixColumn(t,1).length(),t=1/F.setFromMatrixColumn(t,2).length();return n[0]=i[0]*e,n[1]=i[1]*e,n[2]=i[2]*e,n[3]=0,n[4]=i[4]*r,n[5]=i[5]*r,n[6]=i[6]*r,n[7]=0,n[8]=i[8]*t,n[9]=i[9]*t,n[10]=i[10]*t,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n,i,e,r,s,a,h,o,u,c,l,f,d=this.elements,v=t.x,p=t.y,m=t.z,g=Math.cos(v),_=Math.sin(v),w=Math.cos(p),v=Math.sin(p),p=Math.cos(m),m=Math.sin(m);return"XYZ"===t.order?(s=g*p,a=g*m,h=_*p,o=_*m,d[0]=w*p,d[4]=-w*m,d[8]=v,d[1]=a+h*v,d[5]=s-o*v,d[9]=-_*w,d[2]=o-s*v,d[6]=h+a*v,d[10]=g*w):"YXZ"===t.order?(i=w*m,e=v*p,d[0]=(n=w*p)+(r=v*m)*_,d[4]=e*_-i,d[8]=g*v,d[1]=g*m,d[5]=g*p,d[9]=-_,d[2]=i*_-e,d[6]=r+n*_,d[10]=g*w):"ZXY"===t.order?(i=w*m,e=v*p,d[0]=(n=w*p)-(r=v*m)*_,d[4]=-g*m,d[8]=e+i*_,d[1]=i+e*_,d[5]=g*p,d[9]=r-n*_,d[2]=-g*v,d[6]=_,d[10]=g*w):"ZYX"===t.order?(s=g*p,a=g*m,h=_*p,o=_*m,d[0]=w*p,d[4]=h*v-a,d[8]=s*v+o,d[1]=w*m,d[5]=o*v+s,d[9]=a*v-h,d[2]=-v,d[6]=_*w,d[10]=g*w):"YZX"===t.order?(u=g*w,c=g*v,l=_*w,f=_*v,d[0]=w*p,d[4]=f-u*m,d[8]=l*m+c,d[1]=m,d[5]=g*p,d[9]=-_*p,d[2]=-v*p,d[6]=c*m+l,d[10]=u-f*m):"XZY"===t.order&&(u=g*w,c=g*v,l=_*w,f=_*v,d[0]=w*p,d[4]=-m,d[8]=v*p,d[1]=u*m+f,d[5]=g*p,d[9]=c*m-l,d[2]=l*m-c,d[6]=_*p,d[10]=f*m+u),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(H,t,B)},lookAt:function(t,n,i){var e=this.elements;return V.subVectors(t,n),0===V.lengthSq()&&(V.z=1),V.normalize(),I.crossVectors(i,V),0===I.lengthSq()&&(1===Math.abs(i.z)?V.x+=1e-4:V.z+=1e-4,V.normalize(),I.crossVectors(i,V)),I.normalize(),U.crossVectors(V,I),e[0]=I.x,e[4]=U.x,e[8]=V.x,e[1]=I.y,e[5]=U.y,e[9]=V.y,e[2]=I.z,e[6]=U.z,e[10]=V.z,this},multiply:function(t,n){return void 0!==n?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,n)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,n){var i=t.elements,e=n.elements,r=this.elements,s=i[0],a=i[4],h=i[8],o=i[12],u=i[1],c=i[5],l=i[9],f=i[13],d=i[2],v=i[6],p=i[10],m=i[14],g=i[3],_=i[7],w=i[11],y=i[15],M=e[0],x=e[4],b=e[8],E=e[12],T=e[1],S=e[5],A=e[9],k=e[13],R=e[2],D=e[6],L=e[10],P=e[14],t=e[3],n=e[7],i=e[11],e=e[15];return r[0]=s*M+a*T+h*R+o*t,r[4]=s*x+a*S+h*D+o*n,r[8]=s*b+a*A+h*L+o*i,r[12]=s*E+a*k+h*P+o*e,r[1]=u*M+c*T+l*R+f*t,r[5]=u*x+c*S+l*D+f*n,r[9]=u*b+c*A+l*L+f*i,r[13]=u*E+c*k+l*P+f*e,r[2]=d*M+v*T+p*R+m*t,r[6]=d*x+v*S+p*D+m*n,r[10]=d*b+v*A+p*L+m*i,r[14]=d*E+v*k+p*P+m*e,r[3]=g*M+_*T+w*R+y*t,r[7]=g*x+_*S+w*D+y*n,r[11]=g*b+_*A+w*L+y*i,r[15]=g*E+_*k+w*P+y*e,this},multiplyScalar:function(t){var n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this},determinant:function(){var t=this.elements,n=t[0],i=t[4],e=t[8],r=t[12],s=t[1],a=t[5],h=t[9],o=t[13],u=t[2],c=t[6],l=t[10],f=t[14];return t[3]*(+r*h*c-e*o*c-r*a*l+i*o*l+e*a*f-i*h*f)+t[7]*(+n*h*f-n*o*l+r*s*l-e*s*f+e*o*u-r*h*u)+t[11]*(+n*o*c-n*a*f-r*s*c+i*s*f+r*a*u-i*o*u)+t[15]*(-e*a*u-n*h*c+n*a*l+e*s*c-i*s*l+i*h*u)},transpose:function(){var t=this.elements,n=t[1];return t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,this},setPosition:function(t,n,i){var e=this.elements;return t.isVector3?(e[12]=t.x,e[13]=t.y,e[14]=t.z):(e[12]=t,e[13]=n,e[14]=i),this},getInverse:function(t,n){void 0!==n&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var i=this.elements,e=t.elements,r=e[0],s=e[1],a=e[2],h=e[3],o=e[4],u=e[5],c=e[6],l=e[7],f=e[8],d=e[9],v=e[10],p=e[11],m=e[12],g=e[13],_=e[14],w=e[15],y=d*_*l-g*v*l+g*c*p-u*_*p-d*c*w+u*v*w,M=m*v*l-f*_*l-m*c*p+o*_*p+f*c*w-o*v*w,n=f*g*l-m*d*l+m*u*p-o*g*p-f*u*w+o*d*w,t=m*d*c-f*g*c-m*u*v+o*g*v+f*u*_-o*d*_,e=r*y+s*M+a*n+h*t;if(0==e)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e=1/e;return i[0]=y*e,i[1]=(g*v*h-d*_*h-g*a*p+s*_*p+d*a*w-s*v*w)*e,i[2]=(u*_*h-g*c*h+g*a*l-s*_*l-u*a*w+s*c*w)*e,i[3]=(d*c*h-u*v*h-d*a*l+s*v*l+u*a*p-s*c*p)*e,i[4]=M*e,i[5]=(f*_*h-m*v*h+m*a*p-r*_*p-f*a*w+r*v*w)*e,i[6]=(m*c*h-o*_*h-m*a*l+r*_*l+o*a*w-r*c*w)*e,i[7]=(o*v*h-f*c*h+f*a*l-r*v*l-o*a*p+r*c*p)*e,i[8]=n*e,i[9]=(m*d*h-f*g*h-m*s*p+r*g*p+f*s*w-r*d*w)*e,i[10]=(o*g*h-m*u*h+m*s*l-r*g*l-o*s*w+r*u*w)*e,i[11]=(f*u*h-o*d*h-f*s*l+r*d*l+o*s*p-r*u*p)*e,i[12]=t*e,i[13]=(f*g*a-m*d*a+m*s*v-r*g*v-f*s*_+r*d*_)*e,i[14]=(m*u*a-o*g*a-m*s*c+r*g*c+o*s*_-r*u*_)*e,i[15]=(o*d*a-f*u*a+f*s*c-r*d*c-o*s*v+r*u*v)*e,this},scale:function(t){var n=this.elements,i=t.x,e=t.y,t=t.z;return n[0]*=i,n[4]*=e,n[8]*=t,n[1]*=i,n[5]*=e,n[9]*=t,n[2]*=i,n[6]*=e,n[10]*=t,n[3]*=i,n[7]*=e,n[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements,n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(n,i,t))},makeTranslation:function(t,n,i){return this.set(1,0,0,t,0,1,0,n,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var n=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,n,-t,0,0,t,n,0,0,0,0,1),this},makeRotationY:function(t){var n=Math.cos(t),t=Math.sin(t);return this.set(n,0,t,0,0,1,0,0,-t,0,n,0,0,0,0,1),this},makeRotationZ:function(t){var n=Math.cos(t),t=Math.sin(t);return this.set(n,-t,0,0,t,n,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,n){var i=Math.cos(n),e=Math.sin(n),r=1-i,s=t.x,a=t.y,h=t.z,n=r*s,t=r*a;return this.set(n*s+i,n*a-e*h,n*h+e*a,0,n*a+e*h,t*a+i,t*h-e*s,0,n*h-e*a,t*h+e*s,r*h*h+i,0,0,0,0,1),this},makeScale:function(t,n,i){return this.set(t,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,n,i){return this.set(1,n,i,0,t,1,i,0,t,n,1,0,0,0,0,1),this},compose:function(t,n,i){var e=this.elements,r=n.e,s=n.u,a=n.f,h=n.v,o=r+r,u=s+s,c=a+a,l=r*o,f=r*u,d=r*c,n=s*u,r=s*c,s=a*c,a=h*o,o=h*u,u=h*c,h=i.x,c=i.y,i=i.z;return e[0]=(1-(n+s))*h,e[1]=(f+u)*h,e[2]=(d-o)*h,e[3]=0,e[4]=(f-u)*c,e[5]=(1-(l+s))*c,e[6]=(r+a)*c,e[7]=0,e[8]=(d+o)*i,e[9]=(r-a)*i,e[10]=(1-(l+n))*i,e[11]=0,e[12]=t.x,e[13]=t.y,e[14]=t.z,e[15]=1,this},decompose:function(t,n,i){var e=this.elements,r=F.set(e[0],e[1],e[2]).length(),s=F.set(e[4],e[5],e[6]).length(),a=F.set(e[8],e[9],e[10]).length();this.determinant()<0&&(r=-r),t.x=e[12],t.y=e[13],t.z=e[14],N.copy(this);var h=1/r,t=1/s,e=1/a;return N.elements[0]*=h,N.elements[1]*=h,N.elements[2]*=h,N.elements[4]*=t,N.elements[5]*=t,N.elements[6]*=t,N.elements[8]*=e,N.elements[9]*=e,N.elements[10]*=e,n.setFromRotationMatrix(N),i.x=r,i.y=s,i.z=a,this},makePerspective:function(t,n,i,e,r,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,h=2*r/(i-e),o=(n+t)/(n-t),i=(i+e)/(i-e),e=-(s+r)/(s-r),s=-2*s*r/(s-r);return a[0]=2*r/(n-t),a[4]=0,a[8]=o,a[12]=0,a[1]=0,a[5]=h,a[9]=i,a[13]=0,a[2]=0,a[6]=0,a[10]=e,a[14]=s,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,n,i,e,r,s){var a=this.elements,h=1/(n-t),o=1/(i-e),u=1/(s-r),t=(n+t)*h,e=(i+e)*o,r=(s+r)*u;return a[0]=2*h,a[4]=0,a[8]=0,a[12]=-t,a[1]=0,a[5]=2*o,a[9]=0,a[13]=-e,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-r,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var n=this.elements,i=t.elements,e=0;e<16;e++)if(n[e]!==i[e])return!1;return!0},fromArray:function(t,n){void 0===n&&(n=0);for(var i=0;i<16;i++)this.elements[i]=t[i+n];return this},toArray:function(t,n){var i=this.elements;return(t=void 0===t?[]:t)[n=void 0===n?0:n]=i[0],t[n+1]=i[1],t[n+2]=i[2],t[n+3]=i[3],t[n+4]=i[4],t[n+5]=i[5],t[n+6]=i[6],t[n+7]=i[7],t[n+8]=i[8],t[n+9]=i[9],t[n+10]=i[10],t[n+11]=i[11],t[n+12]=i[12],t[n+13]=i[13],t[n+14]=i[14],t[n+15]=i[15],t}}),Object.assign(q.prototype,{addEventListener:function(t,n){void 0===this.T&&(this.T={});var i=this.T;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(n)&&i[t].push(n)},hasEventListener:function(t,n){if(void 0===this.T)return!1;var i=this.T;return void 0!==i[t]&&-1!==i[t].indexOf(n)},removeEventListener:function(t,n){void 0!==this.T&&(void 0===(t=this.T[t])||-1!==(n=t.indexOf(n))&&t.splice(n,1))},dispatchEvent:function(t){if(void 0!==this.T){var n=this.T[t.type];if(void 0!==n){t.target=this;for(var i=n.slice(0),e=0,r=i.length;e<r;e++)i[e].call(this,t)}}}});var Z=new z,Y=new s;function G(t,n,i,e){this.e=t||0,this.u=n||0,this.f=i||0,this.S=e||G.DefaultOrder}function X(){this.mask=1}function W(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}G.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],G.DefaultOrder="XYZ",Object.defineProperties(G.prototype,{x:{get:function(){return this.e},set:function(t){this.e=t,this._()}},y:{get:function(){return this.u},set:function(t){this.u=t,this._()}},z:{get:function(){return this.f},set:function(t){this.f=t,this._()}},order:{get:function(){return this.S},set:function(t){this.S=t,this._()}}}),Object.assign(G.prototype,{isEuler:!0,set:function(t,n,i,e){return this.e=t,this.u=n,this.f=i,this.S=e||this.S,this._(),this},clone:function(){return new this.constructor(this.e,this.u,this.f,this.S)},copy:function(t){return this.e=t.e,this.u=t.u,this.f=t.f,this.S=t.S,this._(),this},setFromRotationMatrix:function(t,n,i){var e=f.clamp,r=t.elements,s=r[0],a=r[4],h=r[8],o=r[1],u=r[5],c=r[9],l=r[2],t=r[6],r=r[10];return"XYZ"===(n=n||this.S)?(this.u=Math.asin(e(h,-1,1)),Math.abs(h)<.9999999?(this.e=Math.atan2(-c,r),this.f=Math.atan2(-a,s)):(this.e=Math.atan2(t,u),this.f=0)):"YXZ"===n?(this.e=Math.asin(-e(c,-1,1)),Math.abs(c)<.9999999?(this.u=Math.atan2(h,r),this.f=Math.atan2(o,u)):(this.u=Math.atan2(-l,s),this.f=0)):"ZXY"===n?(this.e=Math.asin(e(t,-1,1)),Math.abs(t)<.9999999?(this.u=Math.atan2(-l,r),this.f=Math.atan2(-a,u)):(this.u=0,this.f=Math.atan2(o,s))):"ZYX"===n?(this.u=Math.asin(-e(l,-1,1)),Math.abs(l)<.9999999?(this.e=Math.atan2(t,r),this.f=Math.atan2(o,s)):(this.e=0,this.f=Math.atan2(-a,u))):"YZX"===n?(this.f=Math.asin(e(o,-1,1)),Math.abs(o)<.9999999?(this.e=Math.atan2(-c,u),this.u=Math.atan2(-l,s)):(this.e=0,this.u=Math.atan2(h,r))):"XZY"===n?(this.f=Math.asin(-e(a,-1,1)),Math.abs(a)<.9999999?(this.e=Math.atan2(t,u),this.u=Math.atan2(h,s)):(this.e=Math.atan2(-c,r),this.u=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+n),this.S=n,!1!==i&&this._(),this},setFromQuaternion:function(t,n,i){return Z.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Z,n,i)},setFromVector3:function(t,n){return this.set(t.x,t.y,t.z,n||this.S)},reorder:function(t){return Y.setFromEuler(this),this.setFromQuaternion(Y,t)},equals:function(t){return t.e===this.e&&t.u===this.u&&t.f===this.f&&t.S===this.S},fromArray:function(t){return this.e=t[0],this.u=t[1],this.f=t[2],void 0!==t[3]&&(this.S=t[3]),this._(),this},toArray:function(t,n){return(t=void 0===t?[]:t)[n=void 0===n?0:n]=this.e,t[n+1]=this.u,t[n+2]=this.f,t[n+3]=this.S,t},toVector3:function(t){return t?t.set(this.e,this.u,this.f):new m(this.e,this.u,this.f)},M:function(t){return this._=t,this},_:function(){}}),Object.assign(X.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(W.prototype,{isMatrix3:!0,set:function(t,n,i,e,r,s,a,h,o){var u=this.elements;return u[0]=t,u[1]=e,u[2]=a,u[3]=n,u[4]=r,u[5]=h,u[6]=i,u[7]=s,u[8]=o,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var n=this.elements,t=t.elements;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],this},extractBasis:function(t,n,i){return t.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){t=t.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,n){var i=t.elements,e=n.elements,r=this.elements,s=i[0],a=i[3],h=i[6],o=i[1],u=i[4],c=i[7],l=i[2],f=i[5],d=i[8],v=e[0],p=e[3],m=e[6],g=e[1],_=e[4],t=e[7],n=e[2],i=e[5],e=e[8];return r[0]=s*v+a*g+h*n,r[3]=s*p+a*_+h*i,r[6]=s*m+a*t+h*e,r[1]=o*v+u*g+c*n,r[4]=o*p+u*_+c*i,r[7]=o*m+u*t+c*e,r[2]=l*v+f*g+d*n,r[5]=l*p+f*_+d*i,r[8]=l*m+f*t+d*e,this},multiplyScalar:function(t){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this},determinant:function(){var t=this.elements,n=t[0],i=t[1],e=t[2],r=t[3],s=t[4],a=t[5],h=t[6],o=t[7],t=t[8];return n*s*t-n*a*o-i*r*t+i*a*h+e*r*o-e*s*h},getInverse:function(t,n){void 0!==n&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements,e=this.elements,r=i[0],s=i[1],a=i[2],h=i[3],o=i[4],u=i[5],c=i[6],l=i[7],f=i[8],d=f*o-u*l,n=u*c-f*h,t=l*h-o*c,i=r*d+s*n+a*t;if(0==i)return this.set(0,0,0,0,0,0,0,0,0);i=1/i;return e[0]=d*i,e[1]=(a*l-f*s)*i,e[2]=(u*s-a*o)*i,e[3]=n*i,e[4]=(f*r-a*c)*i,e[5]=(a*h-u*r)*i,e[6]=t*i,e[7]=(s*c-l*r)*i,e[8]=(o*r-s*h)*i,this},transpose:function(){var t=this.elements,n=t[1];return t[1]=t[3],t[3]=n,n=t[2],t[2]=t[6],t[6]=n,n=t[5],t[5]=t[7],t[7]=n,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this},setUvTransform:function(t,n,i,e,r,s,a){var h=Math.cos(r),r=Math.sin(r);this.set(i*h,i*r,-i*(h*s+r*a)+s+t,-e*r,e*h,-e*(-r*s+h*a)+a+n,0,0,1)},scale:function(t,n){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=n,i[4]*=n,i[7]*=n,this},rotate:function(t){var n=Math.cos(t),i=Math.sin(t),e=this.elements,r=e[0],s=e[3],a=e[6],h=e[1],o=e[4],t=e[7];return e[0]=n*r+i*h,e[3]=n*s+i*o,e[6]=n*a+i*t,e[1]=-i*r+n*h,e[4]=-i*s+n*o,e[7]=-i*a+n*t,this},translate:function(t,n){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=n*i[2],i[4]+=n*i[5],i[7]+=n*i[8],this},equals:function(t){for(var n=this.elements,i=t.elements,e=0;e<9;e++)if(n[e]!==i[e])return!1;return!0},fromArray:function(t,n){void 0===n&&(n=0);for(var i=0;i<9;i++)this.elements[i]=t[i+n];return this},toArray:function(t,n){var i=this.elements;return(t=void 0===t?[]:t)[n=void 0===n?0:n]=i[0],t[n+1]=i[1],t[n+2]=i[2],t[n+3]=i[3],t[n+4]=i[4],t[n+5]=i[5],t[n+6]=i[6],t[n+7]=i[7],t[n+8]=i[8],t}});var Q=0,J=new m,K=new s,$=new z,tt=new m,nt=new m,it=new m,et=new s,rt=new m(1,0,0),st=new m(0,1,0),at=new m(0,0,1),ht={type:"added"},ot={type:"removed"};function ut(){Object.defineProperty(this,"id",{value:Q++}),this.uuid=f.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ut.DefaultUp.clone();var t=new m,n=new G,i=new s,e=new m(1,1,1);n.M(function(){i.setFromEuler(n,!1)}),i.M(function(){n.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:e},modelViewMatrix:{value:new z},normalMatrix:{value:new W}}),this.matrix=new z,this.matrixWorld=new z,this.matrixAutoUpdate=ut.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new X,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}ut.DefaultUp=new m(0,1,0),ut.DefaultMatrixAutoUpdate=!0,ut.prototype=Object.assign(Object.create(q.prototype),{constructor:ut,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,n){this.quaternion.setFromAxisAngle(t,n)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,n){return K.setFromAxisAngle(t,n),this.quaternion.multiply(K),this},rotateOnWorldAxis:function(t,n){return K.setFromAxisAngle(t,n),this.quaternion.premultiply(K),this},rotateX:function(t){return this.rotateOnAxis(rt,t)},rotateY:function(t){return this.rotateOnAxis(st,t)},rotateZ:function(t){return this.rotateOnAxis(at,t)},translateOnAxis:function(t,n){return J.copy(t).applyQuaternion(this.quaternion),this.position.add(J.multiplyScalar(n)),this},translateX:function(t){return this.translateOnAxis(rt,t)},translateY:function(t){return this.translateOnAxis(st,t)},translateZ:function(t){return this.translateOnAxis(at,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4($.getInverse(this.matrixWorld))},lookAt:function(t,n,i){t.isVector3?tt.copy(t):tt.set(t,n,i);i=this.parent;this.updateWorldMatrix(!0,!1),nt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$.lookAt(nt,tt,this.up):$.lookAt(tt,nt,this.up),this.quaternion.setFromRotationMatrix($),i&&($.extractRotation(i.matrixWorld),K.setFromRotationMatrix($),this.quaternion.premultiply(K.inverse()))},add:function(t){if(1<arguments.length){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(ht)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}var i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(ot)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),$.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),$.multiply(t.parent.matrixWorld)),t.applyMatrix4($),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,n){if(this[t]===n)return this;for(var i=0,e=this.children.length;i<e;i++){var r=this.children[i].getObjectByProperty(t,n);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new m),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new s),this.updateMatrixWorld(!0),this.matrixWorld.decompose(nt,t,it),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new m),this.updateMatrixWorld(!0),this.matrixWorld.decompose(nt,et,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new m),this.updateMatrixWorld(!0);var n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var n=this.children,i=0,e=n.length;i<e;i++)n[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var n=this.children,i=0,e=n.length;i<e;i++)n[i].traverseVisible(t)}},traverseAncestors:function(t){var n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var n=this.children,i=0,e=n.length;i<e;i++)n[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,n){var i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n)for(var e=this.children,r=0,s=e.length;r<s;r++)e[r].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,n){if(void 0===n&&(n=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(var i=0;i<t.children.length;i++){var e=t.children[i];this.add(e.clone())}return this}});var ct=new m,lt=new m,ft=new W;function dt(t,n){this.normal=void 0!==t?t:new m(1,0,0),this.constant=void 0!==n?n:0}Object.assign(dt.prototype,{isPlane:!0,set:function(t,n){return this.normal.copy(t),this.constant=n,this},setComponents:function(t,n,i,e){return this.normal.set(t,n,i),this.constant=e,this},setFromNormalAndCoplanarPoint:function(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this},setFromCoplanarPoints:function(t,n,i){n=ct.subVectors(i,n).cross(lt.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,n){return void 0===n&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new m),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new m);var i=t.delta(ct),e=this.normal.dot(i);if(0===e)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;e=-(t.start.dot(this.normal)+this.constant)/e;return e<0||1<e?void 0:n.copy(i).multiplyScalar(e).add(t.start)},intersectsLine:function(t){var n=this.distanceToPoint(t.start),t=this.distanceToPoint(t.end);return n<0&&0<t||t<0&&0<n},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new m),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,n){n=n||ft.getNormalMatrix(t),t=this.coplanarPoint(ct).applyMatrix4(t),n=this.normal.applyMatrix3(n).normalize();return this.constant=-t.dot(n),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var vt=new m,pt=new m,mt=new m,gt=new m,_t=new m,wt=new m,yt=new m,Mt=new m,xt=new m,bt=new m;function Et(t,n,i){this.a=void 0!==t?t:new m,this.b=void 0!==n?n:new m,this.c=void 0!==i?i:new m}Object.assign(Et,{getNormal:function(t,n,i,e){void 0===e&&(console.warn("THREE.Triangle: .getNormal() target is now required"),e=new m),e.subVectors(i,n),vt.subVectors(t,n),e.cross(vt);n=e.lengthSq();return 0<n?e.multiplyScalar(1/Math.sqrt(n)):e.set(0,0,0)},getBarycoord:function(t,n,i,e,r){vt.subVectors(e,n),pt.subVectors(i,n),mt.subVectors(t,n);var s=vt.dot(vt),a=vt.dot(pt),e=vt.dot(mt),i=pt.dot(pt),t=pt.dot(mt),n=s*i-a*a;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new m),0==n)return r.set(-2,-1,-1);n=1/n,i=(i*e-a*t)*n,n*=s*t-a*e;return r.set(1-i-n,n,i)},containsPoint:function(t,n,i,e){return Et.getBarycoord(t,n,i,e,gt),0<=gt.x&&0<=gt.y&&gt.x+gt.y<=1},getUV:function(t,n,i,e,r,s,a,h){return this.getBarycoord(t,n,i,e,gt),h.set(0,0),h.addScaledVector(r,gt.x),h.addScaledVector(s,gt.y),h.addScaledVector(a,gt.z),h},isFrontFacing:function(t,n,i,e){return vt.subVectors(i,n),pt.subVectors(t,n),vt.cross(pt).dot(e)<0}}),Object.assign(Et.prototype,{set:function(t,n,i){return this.a.copy(t),this.b.copy(n),this.c.copy(i),this},setFromPointsAndIndices:function(t,n,i,e){return this.a.copy(t[n]),this.b.copy(t[i]),this.c.copy(t[e]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return vt.subVectors(this.c,this.b),pt.subVectors(this.a,this.b),.5*vt.cross(pt).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new m),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Et.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new dt),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,n){return Et.getBarycoord(t,this.a,this.b,this.c,n)},getUV:function(t,n,i,e,r){return Et.getUV(t,this.a,this.b,this.c,n,i,e,r)},containsPoint:function(t){return Et.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Et.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,n){void 0===n&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new m);var i=this.a,e=this.b,r=this.c;_t.subVectors(e,i),wt.subVectors(r,i),Mt.subVectors(t,i);var s=_t.dot(Mt),a=wt.dot(Mt);if(s<=0&&a<=0)return n.copy(i);xt.subVectors(t,e);var h=_t.dot(xt),o=wt.dot(xt);if(0<=h&&o<=h)return n.copy(e);var u=s*o-h*a;if(u<=0&&0<=s&&h<=0)return l=s/(s-h),n.copy(i).addScaledVector(_t,l);bt.subVectors(t,r);var c=_t.dot(bt),t=wt.dot(bt);if(0<=t&&c<=t)return n.copy(r);s=c*a-s*t;if(s<=0&&0<=a&&t<=0)return f=a/(a-t),n.copy(i).addScaledVector(wt,f);a=h*t-c*o;if(a<=0&&0<=o-h&&0<=c-t)return yt.subVectors(r,e),f=(o-h)/(o-h+(c-t)),n.copy(e).addScaledVector(yt,f);var a=1/(a+s+u),l=s*a,f=u*a;return n.copy(i).addScaledVector(_t,l).addScaledVector(wt,f)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Tt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},St={h:0,s:0,l:0},At={h:0,s:0,l:0};function kt(t,n,i){return void 0===n&&void 0===i?this.set(t):this.setRGB(t,n,i)}function Rt(t,n,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(n-t)*i:i<.5?n:i<2/3?t+6*(n-t)*(2/3-i):t}function Dt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Lt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function Pt(t,n,i,e,r,s){this.a=t,this.b=n,this.c=i,this.normal=e&&e.isVector3?e:new m,this.vertexNormals=Array.isArray(e)?e:[],this.color=r&&r.isColor?r:new kt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==s?s:0}Object.assign(kt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,n,i){return this.r=t,this.g=n,this.b=i,this},setHSL:function(t,n,i){return t=f.euclideanModulo(t,1),n=f.clamp(n,0,1),i=f.clamp(i,0,1),0===n?this.r=this.g=this.b=i:(this.r=Rt(n=2*i-(i=i<=.5?i*(1+n):i+n-i*n),i,t+1/3),this.g=Rt(n,i,t),this.b=Rt(n,i,t-1/3)),this},setStyle:function(n){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+n+" will be ignored.")}if(o=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(n)){var i,e=o[1],r=o[2];switch(e){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){var s=parseFloat(i[1])/360,a=parseInt(i[2],10)/100,h=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(s,a,h)}}}else if(o=/^\#([A-Fa-f0-9]+)$/.exec(n)){var e=o[1],o=e.length;if(3===o)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===o)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return n&&0<n.length?this.setColorName(n):this},setColorName:function(t){var n=Tt[t];return void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,n){return void 0===n&&(n=2),this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},copyLinearToGamma:function(t,n){n=0<(n=void 0===n?2:n)?1/n:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Dt(t.r),this.g=Dt(t.g),this.b=Dt(t.b),this},copyLinearToSRGB:function(t){return this.r=Lt(t.r),this.g=Lt(t.g),this.b=Lt(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var n,i=this.r,e=this.g,r=this.b,s=Math.max(i,e,r),a=Math.min(i,e,r),h=(a+s)/2;if(a===s)u=n=0;else{var o=s-a,u=h<=.5?o/(s+a):o/(2-s-a);switch(s){case i:n=(e-r)/o+(e<r?6:0);break;case e:n=(r-i)/o+2;break;case r:n=(i-e)/o+4}n/=6}return t.h=n,t.s=u,t.l=h,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,n,i){return this.getHSL(St),St.h+=t,St.s+=n,St.l+=i,this.setHSL(St.h,St.s,St.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this},lerpHSL:function(t,n){this.getHSL(St),t.getHSL(At);var i=f.lerp(St.h,At.h,n),t=f.lerp(St.s,At.s,n),n=f.lerp(St.l,At.l,n);return this.setHSL(i,t,n),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,n){return this.r=t[n=void 0===n?0:n],this.g=t[n+1],this.b=t[n+2],this},toArray:function(t,n){return(t=void 0===t?[]:t)[n=void 0===n?0:n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}}),kt.NAMES=Tt,Object.assign(Pt.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var n=0,i=t.vertexNormals.length;n<i;n++)this.vertexNormals[n]=t.vertexNormals[n].clone();for(n=0,i=t.vertexColors.length;n<i;n++)this.vertexColors[n]=t.vertexColors[n].clone();return this}});var Ct=0,Ot=1,jt=2,Ft=1,Nt=100,Ht=204,Bt=205,It=3,Ut=0,Vt=1001,zt=1006,qt=1008,Zt=1009,Yt=1023,Gt=3e3,Xt=7680,Wt=519,Qt=35044,Jt=0;function Kt(){Object.defineProperty(this,"id",{value:Jt++}),this.uuid=f.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Ft,this.side=Ct,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ht,this.blendDst=Bt,this.blendEquation=Nt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=It,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Wt,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Xt,this.stencilZFail=Xt,this.stencilZPass=Xt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function $t(t){Kt.call(this),this.type="MeshBasicMaterial",this.color=new kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ut,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}function tn(t,n,i,e){this.x=t||0,this.y=n||0,this.z=i||0,this.w=void 0!==e?e:1}Kt.prototype=Object.assign(Object.create(q.prototype),{constructor:Kt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var n in t){var i,e=t[n];void 0!==e?"shading"!==n?void 0!==(i=this[n])?i&&i.isColor?i.set(e):i&&i.isVector3&&e&&e.isVector3?i.copy(e):this[n]=e:console.warn("THREE."+this.type+": '"+n+"' is not a property of this material."):(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e):console.warn("THREE.Material: '"+n+"' parameter is undefined.")}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var n=t.clippingPlanes,i=null;if(null!==n)for(var e=n.length,i=new Array(e),r=0;r!==e;++r)i[r]=n[r].clone();return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Kt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),(($t.prototype=Object.create(Kt.prototype)).constructor=$t).prototype.isMeshBasicMaterial=!0,$t.prototype.copy=function(t){return Kt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Object.defineProperties(tn.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(tn.prototype,{isVector4:!0,set:function(t,n,i,e){return this.x=t,this.y=n,this.z=i,this.w=e,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,n){return void 0!==n?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this},addScaledVector:function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this},sub:function(t,n){return void 0!==n?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var n=this.x,i=this.y,e=this.z,r=this.w,t=t.elements;return this.x=t[0]*n+t[4]*i+t[8]*e+t[12]*r,this.y=t[1]*n+t[5]*i+t[9]*e+t[13]*r,this.z=t[2]*n+t[6]*i+t[10]*e+t[14]*r,this.w=t[3]*n+t[7]*i+t[11]*e+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this},setAxisAngleFromRotationMatrix:function(t){var n,i,e,r=t.elements,s=r[0],a=r[4],h=r[8],o=r[1],u=r[5],c=r[9],l=r[2],f=r[6],d=r[10];if(Math.abs(a-o)<.01&&Math.abs(h-l)<.01&&Math.abs(c-f)<.01){if(Math.abs(a+o)<.1&&Math.abs(h+l)<.1&&Math.abs(c+f)<.1&&Math.abs(s+u+d-3)<.1)return this.set(1,0,0,0),this;var v=Math.PI,p=(s+1)/2,m=(u+1)/2,g=(d+1)/2,_=(a+o)/4,t=(h+l)/4,r=(c+f)/4;return m<p&&g<p?e=p<.01?(n=0,i=.707106781):(i=_/(n=Math.sqrt(p)),t/n):g<m?e=m<.01?(i=0,n=.707106781):(n=_/(i=Math.sqrt(m)),r/i):g<.01?(i=n=.707106781,e=0):(n=t/(e=Math.sqrt(g)),i=r/e),this.set(n,i,e,v),this}v=Math.sqrt((f-c)*(f-c)+(h-l)*(h-l)+(o-a)*(o-a));return Math.abs(v)<.001&&(v=1),this.x=(f-c)/v,this.y=(h-l)/v,this.z=(o-a)/v,this.w=Math.acos((s+u+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this.w=Math.max(t.w,Math.min(n.w,this.w)),this},clampScalar:function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this.w=Math.max(t,Math.min(n,this.w)),this},clampLength:function(t,n){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(n,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this},lerpVectors:function(t,n,i){return this.subVectors(n,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,n){return this.x=t[n=void 0===n?0:n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this},toArray:function(t,n){return(t=void 0===t?[]:t)[n=void 0===n?0:n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t},fromBufferAttribute:function(t,n,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this}});var nn=new m;function en(t,n,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=!0===i,this.usage=Qt,this.updateRange={offset:0,count:-1},this.version=0}function rn(t,n,i){en.call(this,new Int8Array(t),n,i)}function sn(t,n,i){en.call(this,new Uint8Array(t),n,i)}function an(t,n,i){en.call(this,new Uint8ClampedArray(t),n,i)}function hn(t,n,i){en.call(this,new Int16Array(t),n,i)}function on(t,n,i){en.call(this,new Uint16Array(t),n,i)}function un(t,n,i){en.call(this,new Int32Array(t),n,i)}function cn(t,n,i){en.call(this,new Uint32Array(t),n,i)}function ln(t,n,i){en.call(this,new Float32Array(t),n,i)}function fn(t,n,i){en.call(this,new Float64Array(t),n,i)}function dn(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.defineProperty(en.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(en.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,n,i){t*=this.itemSize,i*=n.itemSize;for(var e=0,r=this.itemSize;e<r;e++)this.array[t+e]=n.array[i+e];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var n=this.array,i=0,e=0,r=t.length;e<r;e++){var s=t[e];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",e),s=new kt),n[i++]=s.r,n[i++]=s.g,n[i++]=s.b}return this},copyVector2sArray:function(t){for(var n=this.array,i=0,e=0,r=t.length;e<r;e++){var s=t[e];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",e),s=new O),n[i++]=s.x,n[i++]=s.y}return this},copyVector3sArray:function(t){for(var n=this.array,i=0,e=0,r=t.length;e<r;e++){var s=t[e];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",e),s=new m),n[i++]=s.x,n[i++]=s.y,n[i++]=s.z}return this},copyVector4sArray:function(t){for(var n=this.array,i=0,e=0,r=t.length;e<r;e++){var s=t[e];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",e),s=new tn),n[i++]=s.x,n[i++]=s.y,n[i++]=s.z,n[i++]=s.w}return this},applyMatrix3:function(t){for(var n=0,i=this.count;n<i;n++)nn.x=this.getX(n),nn.y=this.getY(n),nn.z=this.getZ(n),nn.applyMatrix3(t),this.setXYZ(n,nn.x,nn.y,nn.z);return this},applyMatrix4:function(t){for(var n=0,i=this.count;n<i;n++)nn.x=this.getX(n),nn.y=this.getY(n),nn.z=this.getZ(n),nn.applyMatrix4(t),this.setXYZ(n,nn.x,nn.y,nn.z);return this},applyNormalMatrix:function(t){for(var n=0,i=this.count;n<i;n++)nn.x=this.getX(n),nn.y=this.getY(n),nn.z=this.getZ(n),nn.applyNormalMatrix(t),this.setXYZ(n,nn.x,nn.y,nn.z);return this},transformDirection:function(t){for(var n=0,i=this.count;n<i;n++)nn.x=this.getX(n),nn.y=this.getY(n),nn.z=this.getZ(n),nn.transformDirection(t),this.setXYZ(n,nn.x,nn.y,nn.z);return this},set:function(t,n){return this.array.set(t,n=void 0===n?0:n),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,n){return this.array[t*this.itemSize]=n,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,n){return this.array[t*this.itemSize+1]=n,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,n){return this.array[t*this.itemSize+2]=n,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,n){return this.array[t*this.itemSize+3]=n,this},setXY:function(t,n,i){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=i,this},setXYZ:function(t,n,i,e){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=i,this.array[t+2]=e,this},setXYZW:function(t,n,i,e,r){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=i,this.array[t+2]=e,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(rn.prototype=Object.create(en.prototype)).constructor=rn,(sn.prototype=Object.create(en.prototype)).constructor=sn,(an.prototype=Object.create(en.prototype)).constructor=an,(hn.prototype=Object.create(en.prototype)).constructor=hn,on.prototype=Object.create(en.prototype),on.prototype.constructor=on,(un.prototype=Object.create(en.prototype)).constructor=un,cn.prototype=Object.create(en.prototype),cn.prototype.constructor=cn,(ln.prototype=Object.create(en.prototype)).constructor=ln,(fn.prototype=Object.create(en.prototype)).constructor=fn,Object.assign(dn.prototype,{computeGroups:function(t){for(var n,i=[],e=void 0,r=t.faces,s=0;s<r.length;s++){var a=r[s];a.materialIndex!==e&&(e=a.materialIndex,void 0!==n&&(n.count=3*s-n.start,i.push(n)),n={start:3*s,materialIndex:e})}void 0!==n&&(n.count=3*s-n.start,i.push(n)),this.groups=i},fromGeometry:function(t){var n=t.faces,i=t.vertices,e=t.faceVertexUvs,r=e[0]&&0<e[0].length,s=e[1]&&0<e[1].length,a=t.morphTargets,h=a.length;if(0<h){for(var o=[],u=0;u<h;u++)o[u]={name:a[u].name,data:[]};this.morphTargets.position=o}var c=t.morphNormals,l=c.length;if(0<l){for(var f=[],u=0;u<l;u++)f[u]={name:c[u].name,data:[]};this.morphTargets.normal=f}var d=t.skinIndices,v=t.skinWeights,p=d.length===i.length,m=v.length===i.length;0<i.length&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var g=n[u];this.vertices.push(i[g.a],i[g.b],i[g.c]);var _=g.vertexNormals;3===_.length?this.normals.push(_[0],_[1],_[2]):(y=g.normal,this.normals.push(y,y,y));var w,y=g.vertexColors;3===y.length?this.colors.push(y[0],y[1],y[2]):(y=g.color,this.colors.push(y,y,y)),!0===r&&(void 0!==(w=e[0][u])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new O,new O,new O))),!0===s&&(void 0!==(w=e[1][u])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new O,new O,new O)));for(var M=0;M<h;M++){var x=a[M].vertices;o[M].data.push(x[g.a],x[g.b],x[g.c])}for(M=0;M<l;M++){var b=c[M].vertexNormals[u];f[M].data.push(b.a,b.b,b.c)}p&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),m&&this.skinWeights.push(v[g.a],v[g.b],v[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var vn=1,pn=new z,mn=new ut,gn=new m,_n=new b,wn=new b,yn=new m;function Mn(){Object.defineProperty(this,"id",{value:vn+=2}),this.uuid=f.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Mn.prototype=Object.assign(Object.create(q.prototype),{constructor:Mn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<function(t){if(0===t.length)return-1/0;for(var n=t[0],i=1,e=t.length;i<e;++i)t[i]>n&&(n=t[i]);return n}(t)?cn:on)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,n){return this.attributes[t]=n,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,n,i){this.groups.push({start:t,count:n,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,n){this.drawRange.start=t,this.drawRange.count=n},applyMatrix4:function(t){var n=this.attributes.position;void 0!==n&&(n.applyMatrix4(t),n.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&(n=(new W).getNormalMatrix(t),i.applyNormalMatrix(n),i.needsUpdate=!0);i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return pn.makeRotationX(t),this.applyMatrix4(pn),this},rotateY:function(t){return pn.makeRotationY(t),this.applyMatrix4(pn),this},rotateZ:function(t){return pn.makeRotationZ(t),this.applyMatrix4(pn),this},translate:function(t,n,i){return pn.makeTranslation(t,n,i),this.applyMatrix4(pn),this},scale:function(t,n,i){return pn.makeScale(t,n,i),this.applyMatrix4(pn),this},lookAt:function(t){return mn.lookAt(t),mn.updateMatrix(),this.applyMatrix4(mn.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(gn).negate(),this.translate(gn.x,gn.y,gn.z),this},setFromObject:function(t){var n,i,e=t.geometry;return t.isPoints||t.isLine?(n=new ln(3*e.vertices.length,3),i=new ln(3*e.colors.length,3),this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(i=new ln(e.lineDistances.length,1),this.setAttribute("lineDistance",i.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())):t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e),this},setFromPoints:function(t){for(var n=[],i=0,e=t.length;i<e;i++){var r=t[i];n.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new ln(n,3)),this},updateFromObject:function(t){var n,i=t.geometry;if(t.isMesh){var e=i.A;if(!0===i.elementsNeedUpdate&&(e=void 0,i.elementsNeedUpdate=!1),void 0===e)return this.fromGeometry(i);e.verticesNeedUpdate=i.verticesNeedUpdate,e.normalsNeedUpdate=i.normalsNeedUpdate,e.colorsNeedUpdate=i.colorsNeedUpdate,e.uvsNeedUpdate=i.uvsNeedUpdate,e.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=e}return!0===i.verticesNeedUpdate&&(void 0!==(n=this.attributes.position)&&(n.copyVector3sArray(i.vertices),n.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(n=this.attributes.normal)&&(n.copyVector3sArray(i.normals),n.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(n=this.attributes.color)&&(n.copyColorsArray(i.colors),n.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(n=this.attributes.uv)&&(n.copyVector2sArray(i.uvs),n.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(n=this.attributes.lineDistance)&&(n.copyArray(i.lineDistances),n.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.A=(new dn).fromGeometry(t),this.fromDirectGeometry(t.A)},fromDirectGeometry:function(t){var n,i,e,r,s=new Float32Array(3*t.vertices.length);for(e in this.setAttribute("position",new en(s,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(n=new Float32Array(3*t.normals.length),this.setAttribute("normal",new en(n,3).copyVector3sArray(t.normals))),0<t.colors.length&&(n=new Float32Array(3*t.colors.length),this.setAttribute("color",new en(n,3).copyColorsArray(t.colors))),0<t.uvs.length&&(i=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new en(i,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(i=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new en(i,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var a=[],h=t.morphTargets[e],o=0,u=h.length;o<u;o++){var c=h[o],l=new ln(3*c.data.length,3);l.name=c.name,a.push(l.copyVector3sArray(c.data))}this.morphAttributes[e]=a}return 0<t.skinIndices.length&&(r=new ln(4*t.skinIndices.length,4),this.setAttribute("skinIndex",r.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(r=new ln(4*t.skinWeights.length,4),this.setAttribute("skinWeight",r.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new b);var t=this.attributes.position,n=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),n)for(var i=0,e=n.length;i<e;i++){var r=n[i];_n.setFromBufferAttribute(r),this.morphTargetsRelative?(yn.addVectors(this.boundingBox.min,_n.min),this.boundingBox.expandByPoint(yn),yn.addVectors(this.boundingBox.max,_n.max),this.boundingBox.expandByPoint(yn)):(this.boundingBox.expandByPoint(_n.min),this.boundingBox.expandByPoint(_n.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new S);var t=this.attributes.position,n=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(_n.setFromBufferAttribute(t),n)for(var e=0,r=n.length;e<r;e++){var s=n[e];wn.setFromBufferAttribute(s),this.morphTargetsRelative?(yn.addVectors(_n.min,wn.min),_n.expandByPoint(yn),yn.addVectors(_n.max,wn.max),_n.expandByPoint(yn)):(_n.expandByPoint(wn.min),_n.expandByPoint(wn.max))}_n.getCenter(i);for(var a=0,e=0,r=t.count;e<r;e++)yn.fromBufferAttribute(t,e),a=Math.max(a,i.distanceToSquared(yn));if(n)for(e=0,r=n.length;e<r;e++)for(var s=n[e],h=this.morphTargetsRelative,o=0,u=s.count;o<u;o++)yn.fromBufferAttribute(s,o),h&&(gn.fromBufferAttribute(t,o),yn.add(gn)),a=Math.max(a,i.distanceToSquared(yn));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,n=this.attributes;if(n.position){var i=n.position.array;if(void 0===n.normal)this.setAttribute("normal",new en(new Float32Array(i.length),3));else for(var e=n.normal.array,r=0,s=e.length;r<s;r++)e[r]=0;var a,h,o,u=n.normal.array,c=new m,l=new m,f=new m,d=new m,v=new m;if(t)for(var p=t.array,r=0,s=t.count;r<s;r+=3)a=3*p[r+0],h=3*p[r+1],o=3*p[r+2],c.fromArray(i,a),l.fromArray(i,h),f.fromArray(i,o),d.subVectors(f,l),v.subVectors(c,l),d.cross(v),u[a]+=d.x,u[1+a]+=d.y,u[2+a]+=d.z,u[h]+=d.x,u[1+h]+=d.y,u[2+h]+=d.z,u[o]+=d.x,u[1+o]+=d.y,u[2+o]+=d.z;else for(r=0,s=i.length;r<s;r+=9)c.fromArray(i,r),l.fromArray(i,r+3),f.fromArray(i,r+6),d.subVectors(f,l),v.subVectors(c,l),d.cross(v),u[r]=d.x,u[r+1]=d.y,u[r+2]=d.z,u[r+3]=d.x,u[r+4]=d.y,u[r+5]=d.z,u[r+6]=d.x,u[r+7]=d.y,u[r+8]=d.z;this.normalizeNormals(),n.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,n=0,i=t.count;n<i;n++)yn.x=t.getX(n),yn.y=t.getY(n),yn.z=t.getZ(n),yn.normalize(),t.setXYZ(n,yn.x,yn.y,yn.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}});var xn=new z,bn=new j,En=new S,Tn=new m,Sn=new m,An=new m,kn=new m,Rn=new m,Dn=new m,Ln=new m,Pn=new m,Cn=new m,On=new O,jn=new O,Fn=new O,Nn=new m,Hn=new m;function Bn(t,n){ut.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Mn,this.material=void 0!==n?n:new $t,this.updateMorphTargets()}function In(t,n,i,e,r,s,a,h){n=n.side===Ot?e.intersectTriangle(a,s,r,!0,h):e.intersectTriangle(r,s,a,n.side!==jt,h);if(null===n)return null;Hn.copy(h),Hn.applyMatrix4(t.matrixWorld);h=i.ray.origin.distanceTo(Hn);return h<i.near||h>i.far?null:{distance:h,point:Hn.clone(),object:t}}function Un(t,n,i,e,r,s,a,h,o,u,c,l){Tn.fromBufferAttribute(r,u),Sn.fromBufferAttribute(r,c),An.fromBufferAttribute(r,l);var f=t.morphTargetInfluences;if(n.morphTargets&&s&&f){Ln.set(0,0,0),Pn.set(0,0,0),Cn.set(0,0,0);for(var d=0,v=s.length;d<v;d++){var p=f[d],m=s[d];0!==p&&(kn.fromBufferAttribute(m,u),Rn.fromBufferAttribute(m,c),Dn.fromBufferAttribute(m,l),a?(Ln.addScaledVector(kn,p),Pn.addScaledVector(Rn,p),Cn.addScaledVector(Dn,p)):(Ln.addScaledVector(kn.sub(Tn),p),Pn.addScaledVector(Rn.sub(Sn),p),Cn.addScaledVector(Dn.sub(An),p)))}Tn.add(Ln),Sn.add(Pn),An.add(Cn)}e=In(t,n,i,e,Tn,Sn,An,Nn);return e&&(h&&(On.fromBufferAttribute(h,u),jn.fromBufferAttribute(h,c),Fn.fromBufferAttribute(h,l),e.uv=Et.getUV(Nn,Tn,Sn,An,On,jn,Fn,new O)),o&&(On.fromBufferAttribute(o,u),jn.fromBufferAttribute(o,c),Fn.fromBufferAttribute(o,l),e.uv2=Et.getUV(Nn,Tn,Sn,An,On,jn,Fn,new O)),o=new Pt(u,c,l),Et.getNormal(Tn,Sn,An,o.normal),e.face=o),e}function Vn(t,n){this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=Qt,this.updateRange={offset:0,count:-1},this.version=0}Bn.prototype=Object.assign(Object.create(ut.prototype),{constructor:Bn,isMesh:!0,copy:function(t){return ut.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,n,i,e=this.geometry;if(e.isBufferGeometry){var r=e.morphAttributes,s=Object.keys(r);if(0<s.length){var a=r[s[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,n=a.length;t<n;t++)i=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{e=e.morphTargets;void 0!==e&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,n){var i=this.geometry,e=this.material,r=this.matrixWorld;if(void 0!==e&&(null===i.boundingSphere&&i.computeBoundingSphere(),En.copy(i.boundingSphere),En.applyMatrix4(r),!1!==t.ray.intersectsSphere(En)&&(xn.getInverse(r),bn.copy(t.ray).applyMatrix4(xn),null===i.boundingBox||!1!==bn.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var s,a,h,o,u,c,l,f,d,v=i.index,p=i.attributes.position,m=i.morphAttributes.position,g=i.morphTargetsRelative,_=i.attributes.uv,w=i.attributes.uv2,y=i.groups,M=i.drawRange;if(null!==v)if(Array.isArray(e))for(o=0,c=y.length;o<c;o++)for(d=e[(f=y[o]).materialIndex],u=Math.max(f.start,M.start),l=Math.min(f.start+f.count,M.start+M.count);u<l;u+=3)s=v.getX(u),a=v.getX(u+1),h=v.getX(u+2),(L=Un(this,d,t,bn,p,m,g,_,w,s,a,h))&&(L.faceIndex=Math.floor(u/3),L.face.materialIndex=f.materialIndex,n.push(L));else for(o=Math.max(0,M.start),c=Math.min(v.count,M.start+M.count);o<c;o+=3)s=v.getX(o),a=v.getX(o+1),h=v.getX(o+2),(L=Un(this,e,t,bn,p,m,g,_,w,s,a,h))&&(L.faceIndex=Math.floor(o/3),n.push(L));else if(void 0!==p)if(Array.isArray(e))for(o=0,c=y.length;o<c;o++)for(d=e[(f=y[o]).materialIndex],u=Math.max(f.start,M.start),l=Math.min(f.start+f.count,M.start+M.count);u<l;u+=3)(L=Un(this,d,t,bn,p,m,g,_,w,s=u,a=u+1,h=u+2))&&(L.faceIndex=Math.floor(u/3),L.face.materialIndex=f.materialIndex,n.push(L));else for(o=Math.max(0,M.start),c=Math.min(p.count,M.start+M.count);o<c;o+=3)(L=Un(this,e,t,bn,p,m,g,_,w,s=o,a=o+1,h=o+2))&&(L.faceIndex=Math.floor(o/3),n.push(L))}else if(i.isGeometry){var x,b=Array.isArray(e),E=i.vertices,T=i.faces,i=i.faceVertexUvs[0];0<i.length&&(x=i);for(var S=0,A=T.length;S<A;S++){var k,R,D,L,P=T[S],C=b?e[P.materialIndex]:e;void 0!==C&&(k=E[P.a],R=E[P.b],D=E[P.c],(L=In(this,C,t,bn,k,R,D,Nn))&&(x&&x[S]&&(C=x[S],On.copy(C[0]),jn.copy(C[1]),Fn.copy(C[2]),L.uv=Et.getUV(Nn,k,R,D,On,jn,Fn,new O)),L.face=P,L.faceIndex=S,n.push(L)))}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.defineProperty(Vn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Vn.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,n,i){t*=this.stride,i*=n.stride;for(var e=0,r=this.stride;e<r;e++)this.array[t+e]=n.array[i+e];return this},set:function(t,n){return this.array.set(t,n=void 0===n?0:n),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var zn=new m;function qn(t,n,i,e){this.data=t,this.itemSize=n,this.offset=i,this.normalized=!0===e}function Zn(t){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yn(t,n){return(Yn=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function Gn(i){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,n=Xn(i);return t=e?(t=Xn(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),n=this,!(t=t)||"object"!==Zn(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(n):t}}function Xn(t){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperties(qn.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(qn.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var n=0,i=this.data.count;n<i;n++)zn.x=this.getX(n),zn.y=this.getY(n),zn.z=this.getZ(n),zn.applyMatrix4(t),this.setXYZ(n,zn.x,zn.y,zn.z);return this},setX:function(t,n){return this.data.array[t*this.data.stride+this.offset]=n,this},setY:function(t,n){return this.data.array[t*this.data.stride+this.offset+1]=n,this},setZ:function(t,n){return this.data.array[t*this.data.stride+this.offset+2]=n,this},setW:function(t,n){return this.data.array[t*this.data.stride+this.offset+3]=n,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=i,this},setXYZ:function(t,n,i,e){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=i,this.data.array[t+2]=e,this},setXYZW:function(t,n,i,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=i,this.data.array[t+2]=e,this.data.array[t+3]=r,this}});var Wn,Qn=function(){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Yn(t,n)}(e,Mn);var i=Gn(e);function e(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e);var t=i.call(this),n=new Vn(new Float32Array([-.5,0,-.5,0,0,.5,0,-.5,1,0,.5,0,.5,1,1,-.5,0,.5,0,1]),5);return t.setIndex([0,1,2,0,2,3]),t.setAttribute("position",new qn(n,3,0,!1)),t.setAttribute("uv",new qn(n,2,3,!1)),t}return e}();function Jn(t){Kt.call(this),this.type="SpriteMaterial",this.color=new kt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}((Jn.prototype=Object.create(Kt.prototype)).constructor=Jn).prototype.isSpriteMaterial=!0,Jn.prototype.copy=function(t){return Kt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Kn=new m,$n=new m,ti=new m,ni=new O,ii=new O,ei=new z,ri=new m,si=new m,ai=new m,hi=new O,oi=new O,ui=new O;function ci(t){var n;ut.call(this),this.type="Sprite",void 0===Wn&&(Wn=new Mn,n=new Vn(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),Wn.setIndex([0,1,2,0,2,3]),Wn.setAttribute("position",new qn(n,3,0,!1)),Wn.setAttribute("uv",new qn(n,2,3,!1))),this.geometry=Wn,this.material=void 0!==t?t:new Jn,this.center=new O(.5,.5)}function li(t,n,i,e,r,s){ni.subVectors(t,i).addScalar(.5).multiply(e),void 0!==r?(ii.x=s*ni.x-r*ni.y,ii.y=r*ni.x+s*ni.y):ii.copy(ni),t.copy(n),t.x+=ii.x,t.y+=ii.y,t.applyMatrix4(ei)}ci.prototype=Object.assign(Object.create(ut.prototype),{constructor:ci,isSprite:!0,raycast:function(t,n){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$n.setFromMatrixScale(this.matrixWorld),ei.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),ti.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&$n.multiplyScalar(-ti.z);var i,e,r=this.material.rotation;0!==r&&(e=Math.cos(r),i=Math.sin(r));var s=this.center;li(ri.set(-.5,-.5,0),ti,s,$n,i,e),li(si.set(.5,-.5,0),ti,s,$n,i,e),li(ai.set(.5,.5,0),ti,s,$n,i,e),hi.set(0,0),oi.set(1,0),ui.set(1,1);r=t.ray.intersectTriangle(ri,si,ai,!1,Kn);null===r&&(li(si.set(-.5,.5,0),ti,s,$n,i,e),oi.set(0,1),null===(r=t.ray.intersectTriangle(ri,ai,si,!1,Kn)))||((r=t.ray.origin.distanceTo(Kn))<t.near||r>t.far||n.push({distance:r,point:Kn.clone(),uv:Et.getUV(Kn,ri,si,ai,hi,oi,ui,new O),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return ut.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var fi=0;function di(t,n,i,e,r,s,a,h,o,u){Object.defineProperty(this,"id",{value:fi++}),this.uuid=f.generateUUID(),this.name="",this.image=void 0!==t?t:di.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==n?n:di.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:Vt,this.wrapT=void 0!==e?e:Vt,this.magFilter=void 0!==r?r:zt,this.minFilter=void 0!==s?s:qt,this.anisotropy=void 0!==o?o:1,this.format=void 0!==a?a:Yt,this.internalFormat=null,this.type=void 0!==h?h:Zt,this.offset=new O(0,0),this.repeat=new O(1,1),this.center=new O(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new W,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Gt,this.version=0,this.onUpdate=null}function vi(t,n,i,e,r,s,a,h,o){di.call(this,t,n,i,e,r,s,a,h,o),this.needsUpdate=!0}di.DEFAULT_IMAGE=void 0,di.DEFAULT_MAPPING=300,di.prototype=Object.assign(Object.create(q.prototype),{constructor:di,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Vt:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Vt:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(di.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((vi.prototype=Object.create(di.prototype)).constructor=vi).prototype.isCanvasTexture=!0;var pi="\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",mi="\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",gi="\n\n#include <envmap_common_pars_fragment>\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",_i="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; // set z to camera.far\n\n}\n",wi="\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\n\t#endif\n\n}\n",yi="\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.\n// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for\n// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvHighPrecisionZW = gl_Position.zw;\n\n}\n",Mi="\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",xi="\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",bi="\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV;\n\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",Ei="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",Ti="\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",Si="\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvLineDistance = scale * lineDistance;\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",Ai="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",ki="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n",Ri="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Di="\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Li="\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",Pi="\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",Ci="\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",Oi="\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",ji="\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",Fi="\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",Ni="\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// this is a stub for the transparency model\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",Hi="\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",Bi="\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",Ii="\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",Ui="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",Vi="\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",zi="\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",qi="\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",Zi="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",Yi="\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n";function Gi(t){var n,i={};for(n in t)for(var e in i[n]={},t[n]){var r=t[n][e];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?i[n][e]=r.clone():Array.isArray(r)?i[n][e]=r.slice():i[n][e]=r}return i}function Xi(t){for(var n={},i=0;i<t.length;i++){var e,r=Gi(t[i]);for(e in r)n[e]=r[e]}return n}var Wi={clone:Gi,merge:Xi},i={common:{diffuse:{value:new kt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new W},uv2Transform:{value:new W},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new O(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new kt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new kt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new W}},sprite:{diffuse:{value:new kt(15658734)},opacity:{value:1},center:{value:new O(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new W}}},Qi={basic:{uniforms:Xi([i.common,i.specularmap,i.envmap,i.aomap,i.lightmap,i.fog]),vertexShader:ki,fragmentShader:Ai},lambert:{uniforms:Xi([i.common,i.specularmap,i.envmap,i.aomap,i.lightmap,i.emissivemap,i.fog,i.lights,{emissive:{value:new kt(0)}}]),vertexShader:Di,fragmentShader:Ri},phong:{uniforms:Xi([i.common,i.specularmap,i.envmap,i.aomap,i.lightmap,i.emissivemap,i.bumpmap,i.normalmap,i.displacementmap,i.fog,i.lights,{emissive:{value:new kt(0)},specular:{value:new kt(1118481)},shininess:{value:30}}]),vertexShader:Fi,fragmentShader:ji},standard:{uniforms:Xi([i.common,i.envmap,i.aomap,i.lightmap,i.emissivemap,i.bumpmap,i.normalmap,i.displacementmap,i.roughnessmap,i.metalnessmap,i.fog,i.lights,{emissive:{value:new kt(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Hi,fragmentShader:Ni},toon:{uniforms:Xi([i.common,i.specularmap,i.aomap,i.lightmap,i.emissivemap,i.bumpmap,i.normalmap,i.displacementmap,i.gradientmap,i.fog,i.lights,{emissive:{value:new kt(0)},specular:{value:new kt(1118481)},shininess:{value:30}}]),vertexShader:Oi,fragmentShader:Ci},matcap:{uniforms:Xi([i.common,i.bumpmap,i.normalmap,i.displacementmap,i.fog,{matcap:{value:null}}]),vertexShader:Pi,fragmentShader:Li},points:{uniforms:Xi([i.points,i.fog]),vertexShader:Vi,fragmentShader:Ui},dashed:{uniforms:Xi([i.common,i.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Si,fragmentShader:Ti},depth:{uniforms:Xi([i.common,i.displacementmap]),vertexShader:yi,fragmentShader:wi},normal:{uniforms:Xi([i.common,i.bumpmap,i.normalmap,i.displacementmap,{opacity:{value:1}}]),vertexShader:Ii,fragmentShader:Bi},sprite:{uniforms:Xi([i.sprite,i.fog]),vertexShader:Yi,fragmentShader:Zi},background:{uniforms:{uvTransform:{value:new W},t2D:{value:null}},vertexShader:mi,fragmentShader:pi},cube:{uniforms:Xi([i.envmap,{opacity:{value:1}}]),vertexShader:_i,fragmentShader:gi},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ei,fragmentShader:bi},distanceRGBA:{uniforms:Xi([i.common,i.displacementmap,{referencePosition:{value:new m},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xi,fragmentShader:Mi},shadow:{uniforms:Xi([i.lights,i.fog,{color:{value:new kt(0)},opacity:{value:1}}]),vertexShader:qi,fragmentShader:zi}};Qi.physical={uniforms:Xi([Qi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new O(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new kt(0)},transparency:{value:0}}]),vertexShader:Hi,fragmentShader:Ni};var Ji="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",Ki="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n";function $i(t){Kt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Ji,this.fragmentShader=Ki,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}(($i.prototype=Object.create(Kt.prototype)).constructor=$i).prototype.isShaderMaterial=!0,$i.prototype.copy=function(t){return Kt.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Gi(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this};function te(t){$i.call(this),this.type="FMMeshBasicMaterial",this.uniforms=Wi.clone(Qi.fmBasic.uniforms),this.vertexShader=Qi.fmBasic.vertexShader,this.fragmentShader=Qi.fmBasic.fragmentShader,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(t){this.uniforms.map.value=t}}}),this.setValues(t)}i.fmcommon={diffuse:{value:new kt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new W}},Qi.fmBasic={uniforms:Wi.merge([i.fmcommon]),vertexShader:"\n#include <common> \n#include <uv_pars_vertex> \n\nvoid main() {\n\n\t#include <uv_vertex> \n\n\t#include <begin_vertex>       \n\t#include <project_vertex>     \n\n\t#include <worldpos_vertex>    \n}\n",fragmentShader:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>                \n#include <uv_pars_fragment>       \n#include <map_pars_fragment>      \n\nvoid main() {\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <map_fragment>    \n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t#ifdef USE_LIGHTMAP\n\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n \n}\n"},((te.prototype=Object.create($i.prototype)).constructor=te).prototype.isFMMeshBasicMaterial=!0,te.prototype.copy=function(t){return $i.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Wi.clone(t.uniforms),this};i={FOV:35,CAMERA_NEAR:1,CAMERA_FAR:1e5,ZOOM_UPPER_BOUND:30,TILT_UPPER_BOUND:90,THOUSAND:1e3,DEG2RAD:.0174532,RAD2DEG:57.2957795,DRAW_TIME:500,EPS:.001};Object.freeze(i);var ne=i;function ie(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var ee=function(){function i(t,n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),this.k=t,this.R=n,this.D=void 0!==n.depth&&n.depth}var t,n,e;return t=i,(n=[{key:"createFlatMaterial",value:function(i){var e=new te;e.depthTest=!1,e.depthWrite=!1,e.transparent=!0,void 0!==this.R.opacity?e.opacity=this.R.opacity:e.opacity=1,e.side=jt,this.createCanvas(function(t){var n=new vi(t);n.minFilter=zt,n.generateMipmaps=!1,e.map=n,e.userData.scaleRatio=t.height/t.width,e.userData.mspriteScale=t.spriteScale,i(e)})}},{key:"myUpdateMaterial",value:function(i){var e=this,r=new Jn;r.sizeAttenuation=!1,r.depthTest=!1,r.depthWrite=!1,r.transparent=!0,void 0!==this.R.opacity?r.opacity=this.R.opacity:r.opacity=1,r.side=jt;var s=this.k.getRenderNode();this.createCanvas(function(t){var n=new vi(t);n.minFilter=zt,n.generateMipmaps=!1,r.map=n,r.userData.scaleRatio=t.height/t.width,r.userData.mspriteScale=t.spriteScale,"image"!==e.R.layout.style&&"text"!==e.R.layout.style&&(r.userData.style=e.R.layout.style,r.userData.itHeightRatio=t.itHeightRatio),r.depthTest=e.D,r.depthWrite=e.D,s.material.map&&s.material.map.dispose(),s.material.dispose(),s.material=r,e.k.updateSize(),setTimeout(function(){i||(e.k.visible=!0,e.k.collision=e.R.collision)},0)})}},{key:"createCanvas",value:function(t){"image"===this.R.layout.style?this.createImageCanvas(t):"text"===this.R.layout.style?this.createTextCanvas(t):this.createImageTextCanvas(t)}},{key:"getCenterByAnchor",value:function(t,n,i){if("all"!==this.k.L.baseon&&"flat"!==this.k.P){var e=n.width/i.width,r=n.height/i.height,n=t.width/i.width,i=t.height/i.height;return"image"===this.k.L.baseon?s(this.k.L.anchor,e,r):s(this.k.L.anchor,n,i)}function s(t,n,i){var e=new O(n/2,i/2);switch(t){case fengmap.FMMarkerAnchor.LEFT:e.setX(0);break;case fengmap.FMMarkerAnchor.RIGHT:e.setX(n);break;case fengmap.FMMarkerAnchor.TOP:e.setY(i);break;case fengmap.FMMarkerAnchor.BOTTOM:e.setY(0);break;case fengmap.FMMarkerAnchor.LEFT_TOP:e.set(0,i);break;case fengmap.FMMarkerAnchor.RIGHT_TOP:e.set(n,i);break;case fengmap.FMMarkerAnchor.LEFT_BOTTOM:e.set(0,0);break;case fengmap.FMMarkerAnchor.RIGHT_BOTTOM:e.set(n,0)}return e}}},{key:"createImageTextCanvas",value:function(e){var r=this;this.createImageCanvas(function(t){var n=r.createTextCanvas(),i=null;(i="limage-rtext"===r.R.layout.style||"ltext-rimage"===r.R.layout.style?r.leftRight(n,t):"timage-btext"===r.R.layout.style||"ttext-bimage"===r.R.layout.style?r.topBottom(n,t):r.overlayText(n,t)).itHeightRatio=t.height/n.height,i.itWidthRatio=t.width/n.width,e&&e(i)})}},{key:"overlayText",value:function(t,n){var i=this.R.layout.align,e=t.width;e<n.width&&(e=n.width);var r=t.height;r<n.height&&(r=n.height);var s=document.createElement("canvas");s.width=e,s.height=r;var a=s.getContext("2d"),h=0,o=0,u=0,c=0;"center"===(i=void 0===i||i.indexOf("-")<0?"center-center":i).split("-")[0]?(o=r/2-t.height/2,c=r/2-n.height/2):"bottom"===i.split("-")[0]&&(o=r-t.height,c=r-n.height),"right"===i.split("-")[1]?(h=e-t.width,u=e-n.width):"center"===i.split("-")[1]&&(h=e/2-t.width/2,u=e/2-n.width/2);i=this.getCenterByAnchor(t,n,s);return i&&("image"===this.k.L.baseon?(i.x=i.x+u/e,i.y=i.y+c/r):(i.x=i.x+h/e,i.y=i.y+o/r),this.k.getRenderNode().center.set(i.x,i.y)),a.drawImage(n,u,c,n.width,n.height),a.drawImage(t,h,o,t.width,t.height),s.spriteScale=r/t.rowHeight,s}},{key:"topBottom",value:function(t,n){var i=n.height+t.height,e=n.width;e<t.width&&(e=t.width);var r=document.createElement("canvas");r.width=e,r.height=i;var s=r.getContext("2d"),a=this.R.layout.align,h=this.R.layout.style,o=0,u=0;"timage-btext"===h?u=n.height:"ttext-bimage"===h&&(o=t.height);var c=0,h=0;t.width>n.width?c=(t.width-n.width)/2:t.width<n.width&&(h=(n.width-t.width)/2),"left"===(a=void 0===a||"left"!==a&&"center"!==a&&"right"!==a?"center":a)?h=c=0:"right"===a&&(t.width>n.width?(c=t.width-n.width,h=0):t.width<n.width&&(h=n.width-t.width,c=0));a=this.getCenterByAnchor(t,n,r);return a&&("image"===this.k.L.baseon?(a.x=a.x+c/e,a.y=a.y+o/i):(a.x=a.x+h/e,a.y=a.y+u/i),this.k.getRenderNode().center.set(a.x,a.y)),s.drawImage(n,c,o,n.width,n.height),s.drawImage(t,h,u,t.width,t.height),r.spriteScale=i/t.rowHeight,r}},{key:"leftRight",value:function(t,n){var i=n.width+t.width,e=n.height;e<t.height&&(e=t.height);var r=document.createElement("canvas");r.width=i,r.height=e;var s=r.getContext("2d"),a=this.R.layout.align,h=this.R.layout.style,o=0,u=0;"center"===(a=void 0===a||"top"!==a&&"center"!==a&&"bottom"!==a?"top":a)?n.height>t.height?(o=0,u=(n.height-t.height)/2):n.height<t.height&&(o=(t.height-n.height)/2,u=0):"bottom"===a&&(n.height>t.height?(o=0,u=n.height-t.height):n.height<t.height&&(o=t.height-n.height,u=0));var c=0,a=0;"limage-rtext"===h?a=n.width:"ltext-rimage"===h&&(c=t.width);h=this.getCenterByAnchor(t,n,r);return h&&("image"===this.k.L.baseon?(h.x=h.x+c/i,h.y=h.y+o/e):(h.x=h.x+a/i,h.y=h.y+u/e),this.k.getRenderNode().center.set(h.x,h.y)),s.drawImage(n,c,o,n.width,n.height),s.drawImage(t,a,u,t.width,t.height),r.spriteScale=e/t.rowHeight,r}},{key:"createImageCanvas",value:function(t){var n=this,i=document.createElement("canvas");i.width=this.k.C[0],i.height=this.k.C[1],i.spriteScale=1;var e,r=i.getContext("2d");this.k.O?((e=new Image).onload=function(){r.drawImage(e,0,0,n.k.C[0],n.k.C[1]),t&&t(i)},e.src=this.k.O):t&&t(i)}},{key:"createTextCanvas",value:function(t){var n=this.getTextInfo(),i=this.getCanvasInfo(n),e=document.createElement("canvas");e.width=i.width,e.height=i.height;var r=e.getContext("2d");this.drawText(r,n,i);var s=this.drawPlate(e,i,n),r=1;if((1<n.length||"text"!==this.R.layout.style)&&(r=e.height/i.rowHeight),s.spriteScale=r,s.rowHeight=i.rowHeight,this.k.size=i.size,!t)return s;t(s)}},{key:"drawPlate",value:function(t,n,i){var e=this.R.text.padding;void 0===e&&(e=[0,0,0,0]);var r=this.R.text.plateColor,s=this.R.text.plateStrokeColor,a=this.R.text.plateStrokeWidth;if(void 0!==s&&void 0===a&&(a=1),void 0===r&&void 0===s)return t;var h=document.createElement("canvas"),o=0;void 0!==s?o=4*a:a=0,h.width=n.width+2*(e[1]+e[3])+o,h.height=n.height+2*(e[0]+e[2])+o;o=h.getContext("2d");return void 0!==r&&(o.rect(0,0,h.width,h.height),o.fillStyle=r,o.fill()),void 0!==s&&(o.lineWidth=a,o.rect(0,0,h.width,h.height),o.strokeStyle=s,o.stroke()),o.drawImage(t,2*(e[3]+a),2*(e[0]+a),t.width,t.height),1<i.length?n.size=n.size+(e[0]+e[2]+2*a)/i.length:n.size=n.size+(e[0]+e[2]+a)/i.length,h}},{key:"drawText",value:function(h,t,n){if(h.textBaseline="Alphabetic",1===t.length){var i=t[0],e=2*i.fontSize*1.2;u(i,2,n,n.height/2+e/3)}else for(var r=0,s=0;s<t.length;s++){var a=t[s],o=2*a.fontSize*1.2;0===s?r+=o:r=r+o+2*a.lineSpacing,u(a,2,n,r)}function u(t,n,i,e){var r=t.text,s=t.fontSize*n*1.2,a=s+"px "+t.fontFamily;void 0!==t.fontWeight&&(a=t.fontWeight+" "+s+"px "+t.fontFamily),h.font=a;a=1;void 0!==t.strokeColor?(h.strokeStyle=t.strokeColor,void 0!==t.strokeWidth&&(isNaN(""+t.strokeWidth)||(a=parseFloat(""+t.strokeWidth))),h.lineWidth=2*n*a):a=0,h.fillStyle=t.fillColor,t.textAlign===fengmap.FMTextAlign.Left?(h.textAlign="left",0!==a&&h.strokeText(r,0,e),h.fillText(r,0,e)):t.textAlign===fengmap.FMTextAlign.Right?(h.textAlign="right",0!==a&&h.strokeText(r,i.width,e),h.fillText(r,i.width,e)):(h.textAlign="center",0!==a&&h.strokeText(r,i.width/2,e),h.fillText(r,i.width/2,e))}}},{key:"getCanvasInfo",value:function(t){var n=document.createElement("canvas").getContext("2d");n.textBaseline="Alphabetic";for(var i=null,e=0,r=null,s=0,a=0,h=0;h<t.length;h++){var o=2*t[h].fontSize*1.2;(null===r||r<t[h].fontSize)&&(r=t[h].fontSize);var u=o+"px "+t[h].fontFamily;void 0!==t[h].fontWeight&&(u=t[h].fontWeight+" "+o+"px "+t[h].fontFamily),n.font=u;var c=n.measureText(t[h].text).width,u=o+2*t[h].lineSpacing,s=s+o+2*t[h].lineSpacing;a+=t[h].lineSpacing,e+=u,(null===i||i<c)&&(i=c)}var l=r;1<t.length&&(l+=a/t.length);var f=this.R.text.padding,d=this.R.text.plateStrokeColor,v=this.R.text.plateStrokeWidth;return{width:i,height:e,fontHeight:e,size:l,rowHeight:(s+2*((f=void 0===f?[0,0,0,0]:f)[0]+f[2])+2*(v=void 0===(v=void 0!==d&&void 0===v?1:v)?0:v)*2)/t.length}}},{key:"getTextInfo",value:function(){var t=this.k.j,n=this.R.text.content,i=n.lineSpacing;(i=void 0===i?2:i)<2&&(i=2);var e=n.textAlign;void 0===e&&(e=fengmap.FMTextAlign.Center);var r=n.fontSize;void 0===r&&(r=20);var s=n.fontWeight,a=n.fontFamily;void 0===a&&(a=t.getMapOptions().fontFamily);var h=n.fillColor;void 0===h&&(h="#000000");var o=n.strokeColor,u=n.strokeWidth;void 0===u&&(u=0),void 0!==o&&0===u&&(u=1);var c=n.text,l=[];if("string"==typeof c)if(c.indexOf("%rn%")<0)l.push({textAlign:e,fontSize:r,fontWeight:s,fontFamily:a,fillColor:h,strokeColor:o,strokeWidth:u,lineSpacing:0,text:c});else for(var f=c.split("%rn%"),d=0;d<f.length;d++)l.push({textAlign:e,fontSize:r,fontWeight:s,fontFamily:a,fillColor:h,strokeColor:o,strokeWidth:u,lineSpacing:i,text:f[d]});else for(var v=0;v<c.length;v++){var p=c[v];void 0===p.textAlign&&(p.textAlign=e),void 0===p.fontSize&&(p.fontSize=r),void 0===p.fontWeight&&(p.fontWeight=s),void 0===p.fontFamily&&(p.fontFamily=a),void 0===p.fillColor&&(p.fillColor=h),void 0===p.strokeColor&&(p.strokeColor=o),void 0===p.strokeWidth&&(p.strokeWidth=u),void 0===p.lineSpacing&&(p.lineSpacing=i),l.push(p)}return l}},{key:"getLocationScale",value:function(t,n){if(this.k.j.camera.isPerspectiveCamera){var i=new z;t.updateMatrixWorld(),this.k.j.camera.updateMatrixWorld(),i.multiplyMatrices(this.k.j.camera.matrixWorldInverse,t.matrixWorld);i=(new m).applyMatrix4(i);return this.getScale(n)*Math.abs(i.z)}return this.getScale(n)}},{key:"getScale",value:function(t){var n=0,n=this.k.j.camera.isPerspectiveCamera?t/(this.k.j.getRenderManager().renderer.domElement.clientHeight/(2*Math.tan(this.k.j.camera.fov*ne.DEG2RAD/2))):t*Math.abs(this.k.j.camera.top-this.k.j.camera.bottom)/this.k.j.camera.zoom/this.k.j.getRenderManager().renderer.domElement.clientHeight;return n=isNaN(n)?1:n}}])&&ie(t.prototype,n),e&&ie(t,e),i}();function re(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var se=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,i,e;return n=t,e=[{key:"round",value:function(t){return 0<t.toFixed(2)?Math.ceil(t.toFixed(2)):Math.floor(t.toFixed(2))}},{key:"generateUUID",value:function(){for(var t=[],n=0;n<256;n++)t[n]=(n<16?"0":"")+n.toString(16);var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,s=4294967295*Math.random()|0,s=t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255];return t.length=0,s.toUpperCase()}},{key:"findNearNthPowerOfTwo",value:function(t){t-=1;return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)<0?1:1+t}},{key:"toRgba",value:function(t){if(void 0===t)return t;if("number"==typeof t)return"rgba("+parseInt(255*new kt(t).r)+","+parseInt(255*new kt(t).g)+","+parseInt(255*new kt(t).b)+",1)";var n=t.split(",");return 3<=n.length?"rgba("+parseInt(n[0])+","+parseInt(n[1])+","+parseInt(n[2])+",1)":t}},{key:"toColor",value:function(t){if("number"==typeof t)return t;var n=t.split(",");return 3<=n.length?parseInt(n[0])<<16|parseInt(n[1])<<8|parseInt(n[2]):(console.error("color format error",t),0)}}],(i=null)&&re(n.prototype,i),e&&re(n,e),t}();function ae(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}i=function(){function n(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),this.F=(t=t||{}).src,this.N=t.dest,this.k=null,this.H=[],this.B=0,this.I=0,this.U=0,this.V=ne.THOUSAND,this.q=!1,this.Z=!1,this.Y=!0,this.G=null,this.X=null,this.W=se.generateUUID()}var t,i,e;return t=n,(i=[{key:"play",value:function(){return this.Q()}},{key:"pause",value:function(){return this.Z=!0,this}},{key:"resume",value:function(){return this.Z=!1,this.B+=this.U,this.U=0,this}},{key:"stop",value:function(){return this.Y=!0,this}},{key:"finish",value:function(){return this.Y=!0,this.X&&this.X(),this.H=[],this}}])&&ae(t.prototype,i),e&&ae(t,e),n}();Object.assign(i.prototype,{J:function(){for(var t in this)this[""+t]=null,delete this[""+t]},K:function(t){return this.F=t,this},$:function(t){return this.N=t,this},tt:function(t){return this.V=t*ne.THOUSAND,this},nt:function(t){return this.I=t*ne.THOUSAND,this},it:function(t){return this.G=t,this},et:function(t){return this.X=t,this},rt:function(t){return this.q=t,this},Q:function(){return this.Y=!1,this.k&&(this.B=this.k.st),this},ht:function(){var t=new this.constructor({src:this.F,dest:this.N});return t.B=this.B,t.I=this.I,t.V=this.V,t.q=this.q,t.G=this.G,t.X=this.X,t},ot:function(){var t=this.N.concat(),n=this.F.concat();return this.F=t,this.N=n,this}});var he=i;i=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.ut=new Map,this.ct=[],this.st=(new Date).getTime(),this.lt=new Map,this.ft()};Object.assign(i.prototype,{dt:function(t){if(Array.isArray(t)){this.ut.set(t[0].W,t[0]),t[0].k=this;for(var n=1;n<t.length;n++)t[n].B=t[n-1].B+t[n-1].V,t[n].I=t[n-1].I+t[n-1].V,this.ut.set(t[n].W,t[n]),t[n].k=this}else this.ut.has(t.W)||(this.ut.set(t.W,t),t.k=this,t.B=this.st)},vt:function(t){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.ut.delete(t[n].W);else this.ut.delete(t.W)},pt:function(t){this.ct.push(t)},mt:function(t){t=this.ct.indexOf(t);-1<t&&this.ct.splice(t,1)},gt:function(t){this.lt.set(t.W=se.generateUUID(),t)},_t:function(t){this.lt.delete(t.W)},G:function(t,n,i){for(var e=[],r=[],s=0;s<t.F.length;s++)void 0===t.H[s]&&(t.H[s]=0),1<=n?(e.push(t.N[s]),r.push(t.N[s]-t.F[s]-t.H[s])):(e.push((t.N[s]-t.F[s])*n+t.F[s]),r.push((t.N[s]-t.F[s])*i),t.H[s]+=(t.N[s]-t.F[s])*i);t.G({destination:e,delta:r}),e.length=0,r.length=0},ft:function(){var e=this;requestAnimationFrame(this.ft.bind(this));var r=(new Date).getTime(),s=r-this.st;this.lt.forEach(function(t){return t(s)});for(var t=0;t<this.ct.length;t++)this.ct[t].update(s/1e3);this.ut.forEach(function(t){var n,i;t.Y||(t.Z?t.U+=s:(n=(r-t.B)/t.V,i=s/t.V,e.G(t,n,i),i=r-t.B-t.I,t.V<=i&&(t.H=[],t.q?(t.B=r,t.X&&t.X()):(i=t.Y,t.Y=!0,!i&&t.X&&t.X()))))}),this.st=r},J:function(){this.ut.forEach(function(t){t.J()}),this.ut.clear(),this.ct=[],this.lt.clear()}});var oe=i;function ue(t){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ce(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function le(t,n,i,e){return(le="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,n,i,e){var r,t=ve(t,n);if(t){if((r=Object.getOwnPropertyDescriptor(t,n)).set)return r.set.call(e,i),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(e,n)){if(!r.writable)return!1;r.value=i,Object.defineProperty(e,n,r)}else i=i,!void((n=n)in(e=e)?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i);return!0})(t,n,i,e)}function fe(t,n,i,e,r){if(!le(t,n,i,e||t)&&r)throw new Error("failed to set property");return i}function de(t,n,i){return(de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,n,i){t=ve(t,n);if(t){n=Object.getOwnPropertyDescriptor(t,n);return n.get?n.get.call(i):n.value}})(t,n,i||t)}function ve(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=_e(t)););return t}function pe(t,n){return(pe=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function me(i){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,n=_e(i);return t=e?(t=_e(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),n=this,!(t=t)||"object"!==ue(t)&&"function"!=typeof t?ge(n):t}}function ge(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _e(t){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}i=window.fengmap||{};i.FMCompositeMarker=function(){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&pe(t,n)}(r,fengmap.FMTextMarker);var t,n,i,e=me(r);function r(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r),void 0===t.anchor&&(t.anchor={baseon:"all",anchor:fengmap.FMMarkerAnchor.CENTER}),"image"!==t.layout.style&&"text"!==t.layout.style||(t.anchor.baseon="all"),void 0===t.collision&&(t.collision=!0),void 0!==t.render&&"flat"===t.render&&(t.collision=!1);var n={text:"",x:t.x,y:t.y,height:t.height,collision:!1};return"all"===t.anchor.baseon&&(n.anchor=t.anchor.anchor),(n=e.call(this,n)).L=t.anchor,n.j=null,n.R=t,n.tool=new ee(ge(n),t),n.D=void 0!==t.depth&&t.depth,n.O=null,n.C=[32,32],n.P=t.render,n.wt=null,void 0===n.P&&(n.P="billboard"),t.image&&(n.O=t.image.url,t.image.size&&(n.C=t.image.size)),n.rotateAnimation=null,n.animator=new oe,n.myUpdateSize=n.myUpdateSize.bind(ge(n)),n.renderUpdate=n.renderUpdate.bind(ge(n)),n.zoomUpdate=n.zoomUpdate.bind(ge(n)),n}return t=r,(n=[{key:"addTo",value:function(t){de(_e(r.prototype),"addTo",this).call(this,t),this.j=t.parent.parent,this.size=this.C[1],this.j.on("zoom",this.zoomUpdate),"billboard"===this.P?(this.R.collision&&(this.visible=!1),this.tool.myUpdateMaterial()):this.myInit()}},{key:"stop",value:function(){de(_e(r.prototype),"stop",this).call(this),this.rotateAnimation&&(this.animator.vt(this.rotateAnimation),this.rotateAnimation=null)}},{key:"remove",value:function(){de(_e(r.prototype),"remove",this).call(this),this.j.off("zoom",this.zoomUpdate),"flat"===this.P&&this.wt&&this.wt.parent&&(this.rotateAnimation&&(this.animator.vt(this.rotateAnimation),this.rotateAnimation=null),this.wt.parent.remove(this.wt),this.wt=null,this.j.off("zoom",this.myUpdateSize),this.j.off("resize",this.myUpdateSize),this.j.off("viewChanged",this.myUpdateSize),this.j.off("update",this.renderUpdate))}},{key:"setText",value:function(t){this.R.text.content.text=t}},{key:"getText",value:function(){return this.R.text.content.text}},{key:"setImage",value:function(t,n){this.O=t,this.C=n}},{key:"getImage",value:function(){return{url:this.O,size:this.C}}},{key:"update",value:function(){var i=this;"billboard"===this.P?this.tool.myUpdateMaterial(!0):this.tool.createFlatMaterial(function(t){new Qn;var n=i.wt;n.material.map&&n.material.map.dispose(),n.material.dispose(),n.material=t,i.myUpdateSize()})}},{key:"moveTo",value:function(t){de(_e(r.prototype),"moveTo",this).call(this,t)}},{key:"rotateTo",value:function(t){var n,i,e,r,s,a=this;"flat"===this.P&&(n=this.j,i=t.duration||.5,e=this.wt.rotation.y,r=t.heading%360*ne.DEG2RAD,s=0,s=e+(s=(r=-Math.PI+r)-e!=0?Math.sin(r-e)/Math.abs(Math.sin(r-e))*Math.acos(Math.cos(r-e)):s),t.animate?(this.rotateAnimation?(this.rotateAnimation.K([e]),this.rotateAnimation.$([r])):this.rotateAnimation=new he({src:[e],dest:[s]}),this.rotateAnimation.tt(i).it(function(t){a.wt&&(a.wt.rotation.y=t.destination[0],n.enableUpdateRender())}).et(function(){a.animator.vt(a.rotateAnimation),a.rotateAnimation=null,n.enableUpdateRender(),t.finish&&t.finish()}),this.animator.dt(this.rotateAnimation.Q())):this.wt&&(this.wt.rotation.y=s,n.enableUpdateRender()))}},{key:"visible",get:function(){return de(_e(r.prototype),"visible",this)},set:function(t){fe(_e(r.prototype),"visible",t,this,!0),"flat"===this.P&&(this.getRenderNode().visible=!1,null!==this.wt&&(this.wt.visible=t))}},{key:"plateColor",get:function(){return this.R.text.plateColor},set:function(t){this.R.text.plateColor=t}},{key:"plateStrokeColor",get:function(){return this.R.text.plateStrokeColor},set:function(t){this.R.text.plateStrokeColor=t}},{key:"height",get:function(){return de(_e(r.prototype),"height",this)},set:function(t){fe(_e(r.prototype),"height",t,this,!0),this.renderUpdate(),this.j.enableUpdateRender()}},{key:"x",get:function(){return de(_e(r.prototype),"x",this)}},{key:"y",get:function(){return de(_e(r.prototype),"y",this)}},{key:"zoomRange",get:function(){var t=this.R.zoomRange;return t=void 0===t?[16,29]:t},set:function(t){this.R.zoomRange=t,this.zoomUpdate()}},{key:"opacity",get:function(){var t=this.R.opacity;return void 0===t?1:t},set:function(t){this.R.opacity=t}},{key:"level",get:function(){return de(_e(r.prototype),"level",this)}},{key:"text",get:function(){return"image"!==this.R.layout.style?this.getText():" "}},{key:"type",get:function(){return de(_e(r.prototype),"type",this)}},{key:"myInit",value:function(){var i=this;this.getRenderNode().visible=!1,this.tool.createFlatMaterial(function(t){var n=new Qn;i.wt=new Bn(n,t),i.wt.rotation.set(0,-Math.PI,-Math.PI,"XYZ"),i.wt.updateMatrixWorld(!0),i.wt.renderOrder=1,i.wt.mapNode=i.getRenderNode().mapNode,i.getRenderNode().parent.add(i.wt),i.wt.position.x=i.getRenderNode().position.x,i.wt.position.y=i.getRenderNode().position.y,i.wt.position.z=i.getRenderNode().position.z,i.j.enableUpdateRender(),i.myUpdateSize(),i.j.on("zoom",i.myUpdateSize),i.j.on("resize",i.myUpdateSize),i.j.on("viewChanged",i.myUpdateSize),i.j.on("update",i.renderUpdate),i.zoomUpdate()})}},{key:"myUpdateSize",value:function(){var t,n,i=this.j;i&&(t=this.wt.position,n=!1,(n=isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||"number"!=typeof t.x||"number"!=typeof t.y||"number"!=typeof t.z?!0:n)||(n=this.tool.getLocationScale(this.wt,this.size),this.wt.scale.set(n,n,n),this.wt.scale.multiplyScalar(this.wt.material.userData.mspriteScale),this.wt.scale.setX(this.wt.scale.x/this.wt.material.userData.scaleRatio),i.enableUpdateRender()))}},{key:"renderUpdate",value:function(){var t;null!==this.wt&&(t=this.getRenderNode(),this.wt.position.x===t.position.x&&this.wt.position.y===t.position.y&&this.wt.position.z===t.position.z||(this.wt.position.x=t.position.x,this.wt.position.y=t.position.y,this.wt.position.z=t.position.z,this.j.enableUpdateRender()))}},{key:"zoomUpdate",value:function(){var t=this.R.zoomRange;void 0===t&&(t=[16,29]);var n=this.j.getZoom();n<t[0]||n>t[1]?this.visible=!1:this.visible=!0}},{key:"dispose",value:function(){this.remove()}},{key:"getAnchor",value:function(){var t="billboard"===this.P?{x:this.getRenderNode().center.x,y:this.getRenderNode().center.y}:{x:.5,y:.5};return t}},{key:"getScreenSize",value:function(){var t,n;return"billboard"===this.P?{width:(n=this.size*this.getRenderNode().material.userData.mspriteScale*1.1)/this.getRenderNode().material.userData.scaleRatio,height:n}:(t=this.R.layout.style,n=this.wt.material.map.image,"image"===t?{width:n.width,height:n.height}:{width:n.width/2,height:n.height/2})}}])&&ce(t.prototype,n),i&&ce(t,i),r}();n.default=i}],r.c=e,r.d=function(t,n,i){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"yt",{value:!0})},r.t=function(n,t){if(1&t&&(n=r(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.yt)return n;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var e in n)r.d(i,e,function(t){return n[t]}.bind(null,e));return i},r.n=function(t){var n=t&&t.yt?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0).default;function r(t){if(e[t])return e[t].exports;var n=e[t]={i:t,l:!1,exports:{}};return i[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}var i,e});