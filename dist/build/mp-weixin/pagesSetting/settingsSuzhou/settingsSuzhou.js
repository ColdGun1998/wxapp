(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesSetting/settingsSuzhou/settingsSuzhou"],{"1fc9":function(t,e,a){"use strict";a.r(e);var o=a("b699"),i=a("ca32");for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("4f8f");var s,r=a("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"19d81d28",null,!1,o["a"],s);e["default"]=c.exports},"33a5":function(t,e,a){},4592:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return o}));var o={qiunDataCharts:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts")]).then(a.bind(null,"ed8a"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,0==t.recodeStatus?a("63be"):null),i=2==t.recodeStatus&&0==t.playStatus?a("a5ec"):null,n=2==t.recodeStatus&&0!=t.playStatus?a("e007"):null,s=2==t.recodeStatus&&0==t.playStatus?a("6bb6"):null,r=2==t.recodeStatus&&0!=t.playStatus?a("2c4a"):null;t.$mp.data=Object.assign({},{$root:{m0:o,m1:i,m2:n,m3:s,m4:r}})},n=[]},"47ed":function(t,e,a){"use strict";(function(t){a("6cdc");o(a("66fd"));var e=o(a("1fc9"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"4f8f":function(t,e,a){"use strict";var o=a("e0b3"),i=a.n(o);i.a},8069:function(t,e,a){"use strict";a.r(e);var o=a("da67"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e["default"]=i.a},a9b6:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(a("f75a")),i=a("4579");function n(t){return t&&t.__esModule?t:{default:t}}var s={data:function(){return{settingSuzhou:null,positionSele:!0,positionlist:[{id:0,onename:"频率范围设置",oneliststare:!1,positiontwo:[]},{id:1,onename:"基站数量设置",oneliststare:!1,positiontwo:[]},{id:2,onename:"基站位置设置:x,y,z(m)",oneliststare:!1,positiontwo:[{twoid:0,twoname:"二维基站A基站1",twoliststare:!1,twoparameter:0,disable:!1},{twoid:1,twoname:"二维基站A基站2",twoliststare:!1,twoparameter:0,disable:!1},{twoid:2,twoname:"二维基站A基站3",twoliststare:!1,twoparameter:0,disable:!1},{twoid:3,twoname:"二维基站A基站4",twoliststare:!1,twoparameter:0,disable:!1},{twoid:4,twoname:"二维基站B基站1",twoliststare:!1,twoparameter:0,disable:!1},{twoid:5,twoname:"二维基站B基站2",twoliststare:!1,twoparameter:0,disable:!1},{twoid:6,twoname:"二维基站B基站3",twoliststare:!1,twoparameter:0,disable:!1},{twoid:7,twoname:"二维基站B基站4",twoliststare:!1,twoparameter:0,disable:!1},{twoid:8,twoname:"一维基站3",twoliststare:!1,twoparameter:0,disable:!1},{twoid:9,twoname:"一维基站5",twoliststare:!1,twoparameter:0,disable:!1}]},{id:3,onename:"惯导设置",oneliststare:!1,positiontwo:[{twoid:0,twoname:"Alpha角度",twoliststare:!1,twoparameter:0,disable:!1}]}]}},onLoad:function(){this.commonInit()},methods:{onelist:function(t){var e=this.positionlist;0==e[t]["oneliststare"]?e[t]["oneliststare"]=!0:e[t]["oneliststare"]=!1},twolist:function(t,e){var a=this.positionlist[t].positiontwo[e]["twoliststare"],o=this.positionlist[t].positiontwo[e]["disable"];0==o&&(this.positionlist[t].positiontwo[e]["twoliststare"]=0==a)},cancel:function(t,e){this.positionlist[t].positiontwo[e]["twoliststare"]=!1},confirm:function(e,a){this.fixSetting(e,a,this.twoparameter),this.positionlist[e].positiontwo[a]["twoparameter"]=this.twoparameter,console.log(this.settingSuzhou),t.$emit("updateSettingEvent",{settingSuzhou:this.settingSuzhou,locType:i.LocationSceneTypeArrayTypeSuzhou}),this.positionlist[e].positiontwo[a]["twoliststare"]=!1,t.setStorageSync("settingSuzhou",this.settingSuzhou)},_input:function(t){this.twoparameter=t.detail.value},commonInit:function(){this.settingSuzhou=o.default.settingSuzhou,this.refreshUI()},refreshUI:function(){var e=t.getStorageSync("settingSuzhou",this.settingSuzhou);this.positionlist[2].positiontwo[0]["twoparameter"]=e.coordinate[0],this.positionlist[2].positiontwo[1]["twoparameter"]=e.coordinate[1],this.positionlist[2].positiontwo[2]["twoparameter"]=e.coordinate[2],this.positionlist[2].positiontwo[3]["twoparameter"]=e.coordinate[3],this.positionlist[2].positiontwo[4]["twoparameter"]=e.coordinate[4],this.positionlist[2].positiontwo[5]["twoparameter"]=e.coordinate[5],this.positionlist[2].positiontwo[6]["twoparameter"]=e.coordinate[6],this.positionlist[2].positiontwo[7]["twoparameter"]=e.coordinate[7],this.positionlist[2].positiontwo[8]["twoparameter"]=e.coordinate[8],this.positionlist[2].positiontwo[9]["twoparameter"]=e.coordinate[9],this.positionlist[3].positiontwo[0]["twoparameter"]=e.imuAlpha},fixSetting:function(t,e,a){if(2==t){var o=a.split(",");e>=0&&e<=5&&(o.length>2?console.log("请输入正确的二维坐标点，如： 1,2"):(this.settingSuzhou.coordinate[e][0]=parseFloat(o[0]),this.settingSuzhou.coordinate[e][1]=parseFloat(o[1])))}3==t&&0==e&&(this.settingSuzhou.imuAlpha=parseFloat(a))}}};e.default=s}).call(this,a("543d")["default"])},b699:function(t,e,a){"use strict";var o;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement;t._self._c},n=[]},ca32:function(t,e,a){"use strict";a.r(e);var o=a("a9b6"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e["default"]=i.a},da67:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(a("a34a")),i=r(a("0ab6")),n=(r(a("4d65")),a("4579")),s=a("93df");function r(t){return t&&t.__esModule?t:{default:t}}function c(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function u(t,e,a,o,i,n,s){try{var r=t[n](s),c=r.value}catch(u){return void a(u)}r.done?e(c):Promise.resolve(c).then(o,i)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(o,i){var n=t.apply(e,a);function s(t){u(n,o,i,s,r,"next",t)}function r(t){u(n,o,i,s,r,"throw",t)}s(void 0)}))}}function g(t){return d(t)||y(t)||h(t)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){if(t){if("string"===typeof t)return S(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?S(t,e):void 0}}function y(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d(t){if(Array.isArray(t))return S(t)}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,o=new Array(e);a<e;a++)o[a]=t[a];return o}var m={vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:1.5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:30,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[0,0],[30,0]],height:1,imuAlpha:0},T={vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:1.5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:30,soundSpeed:340,lngStart:1529,lngEnd:1472,latStart:403,latEnd:512,timeInterval:.15,coordinate:[[30,0],[60,0]],height:1,imuAlpha:0},f={vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:24,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[0,0],[24,0]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7},L={vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:21e3,durationTime:.01,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[2.09,1.56],[6.519,1.56],[6.46,6.51],[2,6.46]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:0,acousticImuStaticFlag:0},A={settings:[[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:11.5,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[11.5,16.5],[23,16.5]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:11.5,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[11.5,11],[23,11]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0,acousticHaveVerticalFlag:!0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:11.5,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[11.5,5.5],[23,5.5]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0,acousticHaveVerticalFlag:!0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:15e3,frequencyEnd:17e3,durationTime:.03,totalLength:11.5,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[11.5,0],[23,0]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0}]]},D={coordinate:[[0,0],[0,15.2],[5.847,15.2],[5.847,0],[0,33.4],[0,15.2],[5.847,15.2],[6,33.4],[20.24,28.35],[7.24,28.35]],imuAlpha:0},x={autoFloorRec:1,settings:[[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[26.17,-5.797],[26.17,1.632],[19.2,-2.297],[19.2,-5.797],[22.78,-5.797],[22.75,1.632]],limitPoly:[[26.17,-5.797],[26.17,1.632],[22.75,1.632],[19.2,-2.297],[19.2,-5.797],[22.78,-5.797]],closeCoordinate:[[0,0,0,6.47,1,-1],[0,6.47,8.94,6.47,1,-1],[8.94,6.47,8.94,1.632,1,-1],[8.94,1.632,26.17,1.632,1,-1],[26.17,1.632,26.17,-5.797,1,1],[22.78,-5.797,19.2,-5.797,1,-1],[19.2,-5.797,19.2,-2.297,1,-1],[17.76,-1.657,6.76,-1.657,1,-1],[6.76,0,0,0,.5,-1],[3.38,3.35,7.85,3.35,1,-1]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:11.5,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[26.17,-1.628],[26.17,1.632],[17.76,1.632],[8.94,2.39],[6.76,-1.657],[17.76,-1.657]],limitPoly:[[26.17,-1.628],[26.17,1.632],[17.76,1.632],[8.94,2.39],[6.76,-1.657],[17.76,-1.657]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:11.5,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[0,0],[0,6.47],[8.94,6.47],[8.94,2.39],[6.76,0]],limitPoly:[[0,0],[0,6.47],[8.94,6.47],[8.94,2.39],[6.76,0]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.73,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0}],[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[24,-3.15],[24,2.9],[18.29,2.9],[12.756,3.476],[12.756,-.378],[20.29,-.378]],limitPoly:[],closeCoordinate:[[24,2.9,24,-3.15,1,-1],[0,3.476,18.29,2.9,1,-1],[18.29,2.9,24,2.9,1,-1],[0,0,12.756,-.378,1,-1],[0,0,0,3.476,1,1],[20.29,-.378,12.756,-.378,1,-1]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:4.23,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[24,-3.15],[24,2.9],[18.29,2.9],[12.756,3.476],[12.756,-.378],[20.29,-.378]],limitPoly:[[24,-3.15],[20.29,-.378],[12.756,-.378],[12.756,3.476],[18.29,2.9],[24,2.9]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:4.23,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[0,0],[0,3.476],[6.847,3.476],[12.756,3.476],[12.756,-.378],[6.847,-.378]],limitPoly:[[0,0],[0,3.476],[6.847,3.476],[12.756,3.476],[12.756,-.378],[6.847,-.378]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:4.23,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0}],[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[26.27,-3.6],[26.27,3.02],[20.57,3.02],[12.41,3.14],[12.41,-1.07],[20.57,-1.07]],limitPoly:[[26.27,-3.6],[20.57,-1.07],[12.41,-1.07],[12.41,3.14],[20.57,3.02],[26.27,3.02]],closeCoordinate:[[0,0,0,6.99,1,-1],[0,6.99,11.9,6.99,1,-1],[11.9,6.99,12.41,3.14,1,-1],[13.41,3.14,26.27,3.02,1,-1],[26.27,3.02,26.27,-3.6,1,1],[20.57,-1.07,12.41,-1.07,1,-1],[12.41,-1.07,0,0,1,-1],[11.41,2.14,4.82,3.22,.5,1]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:4.6,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[3.82,0],[3.82,4.22],[12.41,3.14],[12.41,-1.07]],limitPoly:[[3.82,0],[3.82,4.22],[12.41,3.14],[12.41,-1.07]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:4.6,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[0,0],[3.82,0],[3.82,4.22],[0,6.99],[11.9,6.99]],limitPoly:[[0,0],[0,6.99],[11.9,6.99],[12.41,3.14],[3.82,4.22],[3.82,0]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:4.6,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0}],[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[26.17,-5.797],[26.17,1.632],[19.2,-2.297],[19.2,-5.797],[22.78,-5.797],[22.75,1.632]],limitPoly:[[26.17,-5.797],[26.17,1.632],[22.75,1.632],[19.2,-2.297],[19.2,-5.797],[22.78,-5.797]],closeCoordinate:[[0,0,0,6.47,1,-1],[0,6.47,8.94,6.47,1,-1],[8.94,6.47,8.94,1.632,1,-1],[8.94,1.632,26.17,1.632,1,-1],[26.17,1.632,26.17,-5.797,1,1],[22.78,-5.797,19.2,-5.797,1,-1],[19.2,-5.797,19.2,-2.297,1,-1],[17.76,-1.657,6.76,-1.657,1,-1],[6.76,0,0,0,.5,-1],[3.38,3.35,7.85,3.35,1,-1]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[26.17,-1.628],[26.17,1.632],[17.76,1.632],[8.94,2.39],[6.76,-1.657],[17.76,-1.657]],limitPoly:[[26.17,-1.628],[26.17,1.632],[17.76,1.632],[8.94,2.39],[6.76,-1.657],[17.76,-1.657]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[0,0],[0,6.47],[8.94,6.47],[8.94,2.39],[6.76,0]],limitPoly:[[0,0],[0,6.47],[8.94,6.47],[8.94,2.39],[6.76,0]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.73,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0}],[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:21e3,frequencyEnd:23e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[27.56,-12.77],[23.56,-12.77],[23.56,-17.79],[27.56,-17.79]],limitPoly:[[27.56,-12.77],[27.56,-17.79],[23.56,-17.79],[23.56,-12.77]],closeCoordinate:[[27.56,-12.77,27.56,-17.79,1,-1],[27.56,-17.79,23.56,-17.79,1,-1],[23.56,-17.79,23.56,-12.77,1,-1],[23.56,-12.77,27.56,-12.77,1,-1]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[27.56,-12.77],[23.56,-12.77],[23.56,-17.79],[27.56,-17.79]],limitPoly:[[27.56,-12.77],[27.56,-17.79],[23.56,-17.79],[23.56,-12.77]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2047,maxRatioTh:5,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:8.4,soundSpeed:340,lngStart:1588,lngEnd:1529,latStart:286,latEnd:403,timeInterval:.15,coordinate:[[27.56,-12.77],[23.56,-12.77],[23.56,-17.79],[27.56,-17.79]],limitPoly:[[27.56,-12.77],[27.56,-17.79],[23.56,-17.79],[23.56,-12.77]],closeCoordinate:[],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:3.1,acousticSmoothFlag:0,acousticMapLimitFlag:1,acousticImuStaticFlag:0}]]},v={settings:[[{vMaxTh:.5,vRatioTh:.3,pMaxTh:2e3,maxRatioTh:0,frequencyStart:17e3,frequencyEnd:19e3,durationTime:.03,totalLength:9.85,soundSpeed:340,lngStart:120.0006,lngEnd:120.0007,latStart:30,latEnd:30,timeIntervals:[.15,.15,.15,.15],timeInterval:.15,coordinate:[[0,0],[0,3.4],[4.4,3.4],[4.4,0]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:0,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2e3,maxRatioTh:0,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:9.85,soundSpeed:340,lngStart:120.0006,lngEnd:120.0007,latStart:30,latEnd:30,timeIntervals:[.15,.15,.15,.15],timeInterval:.15,coordinate:[[0,8.6],[0,3.4],[4.4,3.4],[4.4,8.6]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:0,acousticImuStaticFlag:0},{vMaxTh:.5,vRatioTh:.3,pMaxTh:2e3,maxRatioTh:0,frequencyStart:19e3,frequencyEnd:21e3,durationTime:.03,totalLength:9.85,soundSpeed:340,lngStart:120.0006,lngEnd:120.0007,latStart:30,latEnd:30,timeIntervals:[.15,.15,.15,.15],timeInterval:.15,coordinate:[[0,0],[4.4,0],[0,8.6],[4.4,8.6]],imuAlpha:0,imuSteps:.5,imuMaxDrift:3,acousticMaxDrift:2.5,acousticC64Flag:0,acousticHeight:2.7,acousticSmoothFlag:0,acousticMapLimitFlag:0,acousticImuStaticFlag:0}]]},w={setting1:m,setting2:T,setting1D:f,setting2D:L,settingSuzhou:D,settingShengBo:x,settingCangKu:A,settingYanjiuyuan:v,props:["frequencystart"],components:{},data:function(){return{version:"develop",inited:!1,menushow:!1,audioValue:"",duration:0,recodeStatus:0,playStatus:0,recoderAuthStatus:!1,recorderManager:null,leftArray:[],lastFrame:[],lastfftFrame:[],socketStatus:null,signalRef:[],frameSequence:1,chartData:{series:[{name:"基站",data:[]},{name:"声波",data:[]},{name:"IMU",data:[]},{name:"融合",data:[]}]},worker:null,consoleText:"",timeStamps1:[],timeStamps2:[],startTime:null,examinationTypeArray:["userId01","userId02","testFile"],examinationTypeIndex:2,examinationTypeArrayType:"userId01",LocationSceneTypeArray:["二维定位","一维定位三基站","一维定位","体育馆定位","苏州定位","省博定位","仓库定位","湖州研究院定位"],LocationSceneTypeIndex:5,LocationSceneTypeArrayType:"二维定位",LocationTypeArray:["声波","IMU","融合","数据录制"],LocationTypeIndex:0,LocationTypeArrayType:"声波",lastInfo2:[],count2:0,isOneCluster:!0,chartskey:!0,imuTimestamp:99,waitAccel:!0,acceleration:{},orientation:{},imuData:{},imuDataList:[],lastLoc:null,lostCount:0,lastDis:null,needFuse:!1,recordStartTime:0,fuseAcoOnly:!0,commonParameters:{}}},onLoad:function(){this.commonInit(),this.overrideConsole(),this.getAuthSetting();var t=this;this.worker=wx.createWorker("static/workers/worker.js",{useExperimentalWorker:!0}),this.worker.onProcessKilled((function(){t.worker=wx.createWorker("static/workers/worker.js",{useExperimentalWorker:!0}),t.initWorkerListener(),t.updateSetting()})),this.initWorkerListener(),this.worker&&this.updateSetting(),this.initRecorderManager(),this.storageData()},onShow:function(){var t=this;this.getStorageData(),console.log("onShow"),this.inited?(this.chartskey=!1,setTimeout((function(){t.chartskey=!0}),500)):this.inited=!0},onUnload:function(){console.log("卸载页面"),this.worker&&(this.worker.terminate(),this.worker=null)},methods:{storageData:function(){wx.getStorageSync("setting1")||(t.setStorageSync("setting1",m),t.setStorageSync("setting2",T)),wx.getStorageSync("setting1D")||t.setStorageSync("setting1D",f),wx.getStorageSync("setting2D")||(t.setStorageSync("setting2D",L),console.log("setting2d",this.setting2D)),wx.getStorageSync("settingSuzhou")||t.setStorageSync("settingSuzhou",D),wx.getStorageSync("settingShengBo")?x!=!wx.getStorageSync("settingShengBo")&&t.setStorageSync("settingShengBo",x):t.setStorageSync("settingShengBo",x),wx.getStorageSync("settingYanjiuyuan")?v!=!wx.getStorageSync("settingYanjiuyuan")&&t.setStorageSync("settingYanjiuyuan",v):t.setStorageSync("settingYanjiuyuan",v),wx.getStorageSync("settingCangKu")?A!=!wx.getStorageSync("settingCangKu")&&t.setStorageSync("settingCangKu",A):t.setStorageSync("settingCangKu",A)},getStorageData:function(){if(this.commonParameters=wx.getStorageSync("commonParameters"),""==this.commonParameters&&(this.commonParameters={}),this.setting1=t.getStorageSync("setting1",this.setting1),this.setting2=t.getStorageSync("setting2",this.setting2),this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1DThreeBeacon&&(this.chartData["series"][0]["data"][0]=this.setting1.coordinate[0],this.chartData["series"][0]["data"][1]=this.setting1.coordinate[1],this.chartData["series"][0]["data"][2]=this.setting2.coordinate[1],this.updateSetting()),this.setting1D=t.getStorageSync("setting1D",this.setting1D),this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1D&&(this.chartData["series"][0]["data"]=this.setting1D.coordinate,this.updateSetting()),this.setting2D=t.getStorageSync("setting2D",this.setting2D),console.log("缓存的setting2d",this.setting2D),this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType2D&&(this.chartData["series"][0]["data"]=this.setting2D.coordinate,this.updateSetting()),this.settingSuzhou=t.getStorageSync("settingSuzhou",this.settingSuzhou),this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeSuzhou&&(this.chartData["series"][0]["data"]=this.settingSuzhou.coordinate,this.updateSetting()),this.settingShengBo=t.getStorageSync("settingShengBo",this.settingShengBo),"省博定位"==this.LocationSceneTypeArrayType){for(var e=[],a=0;a<this.settingShengBo["settings"][0].length;a++){this.settingShengBo["settings"][0][a].coordinate;e.push.apply(e,g(this.settingShengBo["settings"][0][a].coordinate))}console.log("coordinates:",e),this.chartData["series"][0]["data"]=e,this.updateSetting()}if(this.settingYanjiuyuan=t.getStorageSync("settingYanjiuyuan",this.settingYanjiuyuan),"湖州研究院定位"==this.LocationSceneTypeArrayType){for(var o=[],i=0;i<this.settingYanjiuyuan["settings"][0].length;i++){var s=this.settingYanjiuyuan["settings"][0][i].coordinate;console.log("coordinate:",s),o.push.apply(o,g(this.settingYanjiuyuan["settings"][0][i].coordinate))}console.log("coordinates:",o),this.chartData["series"][0]["data"]=o,this.settingYanjiuyuan.settings[0][0].imuAlpha=this.commonParameters.alpha,this.updateSetting()}if(this.settingCangKu=t.getStorageSync("settingCangKu",this.settingCangKu),"仓库定位"==this.LocationSceneTypeArrayType){for(var r=[],c=0;c<this.settingCangKu["settings"][0].length;c++){var u=this.settingCangKu["settings"][0][c].coordinate;console.log("coordinate:",u),r.push.apply(r,g(this.settingCangKu["settings"][0][c].coordinate))}console.log("coordinates:",r),this.chartData["series"][0]["data"]=r,this.settingCangKu.settings[0][0].imuAlpha=this.commonParameters.alpha,this.updateSetting()}},initSensorListening:function(){var t=this;wx.startAccelerometer({interval:"game"}),wx.startDeviceMotionListening({interval:"game"}),wx.onAccelerometerChange((function(e){!0===t.waitAccel&&(t.imuTimestamp=(new Date).getTime(),t.acceleration={timestamp:t.imuTimestamp,x:e.x,y:e.y,z:e.z},t.waitAccel=!1)})),wx.onDeviceMotionChange((function(e){!1===t.waitAccel&&(t.orientation={timestamp:t.imuTimestamp,alpha:e.alpha,beta:e.beta,gamma:e.gamma},t.imuData={timestamp:t.imuTimestamp,alpha:t.orientation.alpha,beta:t.orientation.beta,gamma:t.orientation.gamma,x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z},"融合"===t.LocationTypeArrayType||"IMU"==t.LocationTypeArrayType?(t.imuDataList.push(t.imuData),t.imuDataList.length>=25&&(t.worker.postMessage({code:"updateStepList",dataType:"imuDataList",locationType:t.LocationSceneTypeArrayType,imuDataList:t.imuDataList,acoOnly:t.fuseAcoOnly}),t.imuDataList=[])):"数据录制"===t.LocationTypeArrayType?t.imuDataList.push({timestamp:t.imuTimestamp,alpha:t.orientation.alpha,beta:t.orientation.beta,gamma:t.orientation.gamma,x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z}):t.worker.postMessage({code:"pdr",imuData:t.imuData}),t.waitAccel=!0)}))},uploadJsonData:function(t,e){var a=wx.getFileSystemManager(),o="".concat(wx.env.USER_DATA_PATH)+"/"+e,i=JSON.stringify(t);a.writeFileSync(o,i,"utf8"),wx.uploadFile({url:n.DEBUGUPLOADSERVER+"acoustic_loc/upload/?filename="+e,name:"file",filePath:o,formData:{type:"txt"},success:function(t){console.log("上传文件成功")},fail:function(t){console.log("上传文件失败"+t)}})},stopSensorListening:function(){wx.stopAccelerometer(),wx.stopDeviceMotionListening(),wx.offDeviceMotionChange(),wx.offAccelerometerChange(),this.imuData={orientation:[],acceleration:[]}},changeMenu:function(){this.menushow=!this.menushow},toScanSettingCode:function(){var t=this;console.log("in scanCode"),wx.scanCode({success:function(e){var a=JSON.parse(e.result);console.log(a),t.worker.postMessage({code:"updateSetting",locType:t.LocationSceneTypeArrayType,setting:a})}})},toShowSettingCode:function(){var t;this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType2D?t=this.setting2D:this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1DThreeBeacon?t=[this.setting1,this.setting2]:this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1D?t=this.setting1D:this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeSuzhou?t=this.settingSuzhou:this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeShengBo?t=this.settingShengBo:this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeCangKu?t=this.settingCangKu:this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeYanjiuyuan&&(t=this.settingYanjiuyuan),t=JSON.stringify(t),new i.default("settingQrcode",{text:t,width:200,height:200,padding:12,correctLevel:i.default.CorrectLevel.L,callback:function(t){wx.showShareImageMenu({path:t.path})}})},toSettings:function(){if(console.log("toSettings in "),this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType2D)console.log("toSettings "+n.LocationSceneTypeArrayType2D),t.navigateTo({url:"../../pagesSetting/settings2d/settings2d"});else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1DThreeBeacon)console.log("toSettings "+n.LocationSceneTypeArrayType1DThreeBeacon),t.navigateTo({url:"../../pagesSetting/settings1dThreeBeacon/settings1dThreeBeacon"});else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1D)console.log("toSettings "+n.LocationSceneTypeArrayType1D),t.navigateTo({url:"../../pagesSetting/settings1d/settings1d"});else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeSuzhou)console.log("toSettings "+n.LocationSceneTypeArrayTypeSuzhou),t.navigateTo({url:"../../pagesSetting/settingsSuzhou/settingsSuzhou"});else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeShengBo)console.log("toSettings "+n.LocationSceneTypeArrayTypeShengBo),t.navigateTo({url:"../../pagesSetting/settingsShengBo/settingsShengBo"});else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeYanjiuyuan)console.log("toSettings "+n.LocationSceneTypeArrayTypeYanjiuyuan),t.navigateTo({url:"../../pagesSetting/settingsYanjiuyuan/settingsYanjiuyuan"});else{if(this.LocationSceneTypeArrayType!=n.LocationSceneTypeArrayTypeCangKu)return void console.log("toSettings "+this.LocationSceneTypeArrayType+"未实现");console.log("toSettings "+n.LocationSceneTypeArrayTypeCangKu),t.navigateTo({url:"../../pagesSetting/settingsCangKu/settingsCangKu"})}},toAbout:function(){console.log("toAbout in "),t.navigateTo({url:"../../pagesSetting/about/about"})},examinationType:function(t){this.examinationTypeIndex=t.target.value,this.examinationTypeArrayType=this.examinationTypeArray[this.examinationTypeIndex],this.updateSetting()},LocationSceneType:function(t){if(this.LocationSceneTypeIndex=t.target.value,this.LocationSceneTypeArrayType=this.LocationSceneTypeArray[this.LocationSceneTypeIndex],this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType2D)console.log("LocationSceneType "+n.LocationSceneTypeArrayType2D),this.getStorageData();else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1DThreeBeacon)console.log("LocationSceneType "+n.LocationSceneTypeArrayType1DThreeBeacon),this.getStorageData();else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1D)console.log("LocationSceneType "+n.LocationSceneTypeArrayType1D),this.getStorageData();else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeStadium)console.log("LocationSceneType "+n.LocationSceneTypeArrayTypeStadium),this.chartData={series:[{name:"beacon坐标",data:[[5,18],[0,18],[0,0],[10,0],[10,18],[15,18],[20,18],[20,0],[10,0],[10,18],[25,18],[20,18],[20,0],[30,0],[30,18]]},{name:"定位位置",data:[[.1,0]]}]},this.getStorageData();else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeSuzhou)console.log("LocationSceneType "+n.LocationSceneTypeArrayTypeSuzhou),this.getStorageData();else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeShengBo)console.log("LocationSceneType "+n.LocationSceneTypeArrayTypeShengBo),this.getStorageData();else if(this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeYanjiuyuan)console.log("LocationSceneType "+n.LocationSceneTypeArrayTypeYanjiuyuan),this.getStorageData();else{if(this.LocationSceneTypeArrayType!=n.LocationSceneTypeArrayTypeCangKu)return void console.log("LocationSceneType "+this.LocationSceneTypeArrayType+"未实现");console.log("LocationSceneType "+n.LocationSceneTypeArrayTypeCangKu),this.getStorageData()}this.updateSetting()},LocationType:function(t){this.LocationTypeIndex=t.target.value,this.LocationTypeArrayType=this.LocationTypeArray[this.LocationTypeIndex],this.updateSetting()},commonInit:function(){this.version=wx.getAccountInfoSync().miniProgram.envVersion},updateSetting:function(){this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType2D?this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,beaconCluster2D:this.setting2D}):this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1DThreeBeacon?this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,beaconCluster1:this.setting1,beaconCluster2:this.setting2}):this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1D?this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,beaconCluster1D:this.setting1D}):this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeSuzhou?this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,setting:this.settingSuzhou}):this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeShengBo?this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,setting:this.settingShengBo}):this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeYanjiuyuan?(console.log("worker send",this.settingYanjiuyuan),this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,setting:this.settingYanjiuyuan})):this.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeCangKu&&(this.worker.postMessage({code:"updateSetting",locType:this.LocationSceneTypeArrayType,setting:this.settingCangKu,commonParameters:this.commonParameters}),Object.keys(this.commonParameters).length>0&&t.setStorageSync("commonParameters",this.commonParameters))},overrideConsole:function(){if(console.log){var t=console.log,e=this;console.log=function(){e.consoleText+=(new Date).format("hh:mm:ss")+" "+JSON.stringify(arguments)+"\n",t.apply(this,arguments)}}},startRecorder:function(t){wx.showToast({title:"alpha="+this.commonParameters.alpha,duration:500});var e=this;this.recoderAuthStatus?"testFile"===this.examinationTypeArrayType?(this.testWithFile(),this.recodeStatus=1,this.postStartRecordTime()):("数据录制"!==this.LocationTypeArrayType&&"融合"!==this.LocationTypeArrayType&&"IMU"!==this.LocationTypeArrayType||this.initSensorListening(),this.recorderManagerStart(),this.postStartRecordTime()):wx.openSetting({success:function(t){t.authSetting["scope.record"]&&(e.recoderAuthStatus=!0,e.recorderManagerStart())}})},recorderManagerStart:function(){this.recorderManager.start({format:"pcm",duration:6e5,numberOfChannels:2,sampleRate:48e3,encodeBitRate:32e4,frameSize:36}),this.recodeStatus=1},playVoice:function(t){if(0==this.playStatus){if(!this.audioValue)return void this.tip("请先录音！");this.playStatus=1,this.innerAudioContext.src=this.audioValue,this.innerAudioContext.play()}else this.playStatus=0,this.innerAudioContext.stop()},stopRecorder:function(t){this.recodeStatus=2,this.recorderManager.stop(),"testFile"!=this.examinationTypeArrayType&&["IMU","融合","数据录制"].includes(this.LocationTypeArrayType)&&this.stopSensorListening(),this.worker.postMessage({code:"reset"}),console.log("stopRecorder")},removeRecoder:function(t){this.audioValue="",this.recodeStatus=0,this.playStatus=0,this.duration=0,this.imuDataList=[],this.chartData.series[1].data=[],this.worker.postMessage({code:"fuse",dataType:"startPosition",startPosition:{timestamp:0,x:0,y:0}})},getAuthSetting:function(){var e=this;t.getSetting({success:function(t){t.authSetting["scope.record"]?e.recoderAuthStatus=!0:wx.authorize({scope:"scope.record",success:function(){e.recoderAuthStatus=!0},fail:function(){e.recoderAuthStatus=!1}})}})},fmtRecoderTime:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t/=1e3;var e=t.toString().split(".")[0];return e},tip:function(e){t.showModal({title:"提示",content:e,showCancel:!1})},postLocationResolveRequest:function(e){return l(o.default.mark((function a(){return o.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log("postLocationResolveRequest 参数",e),console.log("发送数据"),t.sendSocketMessage({data:JSON.stringify(e)});case 3:case"end":return a.stop()}}),a)})))()},initWorkerListener:function(){var t=this;this.worker&&this.worker.onMessage((function(e){switch(e.code){case"console":console.log("wconsole",e.context);break;case"tdoaInfo":e.tdoaInfo&&e.tdoaInfo.forEach((function(t){t.tdoa>0&&console.log("worker rec tdoa",{freq:"17-21",tdoa:t.tdoa})})),e.tdoaInfo2&&e.tdoaInfo2.forEach((function(t){t.tdoa>0&&console.log("tdoa2",t.tdoa)}));break;case"distances1":e.distances.forEach((function(t){console.log("距离",t)}));break;case"distances":var a=function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e/t.length};if(e.distances1.length>0){console.log("distances1",e.distances1);var o=a(e.distances1);o>m.totalLength-.4&&o<m.totalLength+.9?Math.abs(t.chartData.series[1].data[0][0]-o)>.3&&(t.chartData.series[1].data[0][0]=o):o<=m.totalLength-.2&&(t.chartData.series[1].data[0][0]=o),console.log(" 位置:",t.chartData.series[1].data[0][0])}if(e.distances2.length>0){console.log("distances2",e.distances2);var i=a(e.distances2);i>-.4&&i<.9?Math.abs(t.chartData.series[1].data[0][0]-i-m.totalLength)>.3&&(t.chartData.series[1].data[0][0]=i):i>=.9&&(t.chartData.series[1].data[0][0]=a(e.distances2)+m.totalLength)}break;case"distances_nanchang":var n=function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e/t.length};if(e.distances1.length>0){console.log("distances1",e.distances1);var s=n(e.distances1);null==t.lastDis?(t.chartData.series[1].data[0][0]=s,t.lastDis=s):Math.abs(s-t.lastDis)>7?(t.lostCount++,t.lostCount>2&&(t.lastDis=null,t.lostCount=0)):(t.chartData.series[1].data[0][0]=s,t.lastDis=s,t.lostCount=0)}if(e.distances2.length>0){console.log("distances2",e.distances2);var r=n(e.distances2);console.log("avgdis2 + setting1.totalLength",r+m.totalLength),null==t.lastDis?(t.chartData.series[1].data[0][0]=r+m.totalLength,t.lastDis=r+m.totalLength):Math.abs(r+m.totalLength-t.lastDis)>7?(t.lostCount++,t.lostCount>2&&(t.lastDis=null,t.lostCount=0)):(t.chartData.series[1].data[0][0]=r+m.totalLength,t.lastDis=r+m.totalLength,t.lostCount=0)}break;case"coordinate":if(e.coordinate2&&e.coordinate2.length>0)e.coordinate2[0];else if(e.coordinate1&&e.coordinate1.length>0)e.coordinate1[0];break;case"clusterIndex":break;case"location":if(null!=e.location)if(e.type&&"suzhou"==e.type){var c=e.location;console.log("suzhou locations",c);for(var u=c.length-1;u>=0;u--){var l=c[u];null!=t.lastLoc?Math.abs(t.lastLoc[0]-l[0])<4&&Math.abs(t.lastLoc[1]-l[1])<4?(t.chartData.series[1].data[0][0]=l[0],t.chartData.series[1].data[0][1]=l[1],t.lastLoc=[l[0],l[1]]):(t.lostCount++,3==t.lostCount&&(t.lastLoc=null,t.lostCount=0)):(t.chartData.series[1].data[0][0]=l[0],t.chartData.series[1].data[0][1]=l[1],t.lastLoc=[l[0],l[1]])}}else if(e.type&&"1D"==e.type)t.chartData.series[1].data=[[e.location.x,0]];else if(e.type&&"shengbo"==e.type){if(console.log("update the location as "+JSON.stringify(e.location)),console.log("楼层:"+e.floorString),1==t.settingShengBo.autoFloorRec){var p=-1;"通用层"==e.floorString?p=0:"-1层"==e.floorString?p=1:"1层"==e.floorString?p=2:"2层"==e.floorString?p=3:"2层小房间"==e.floorString?p=4:"大厅"==e.floorString&&(p=-1);var h=[];if(-1!=p)for(var y=0;y<t.settingShengBo["settings"][p].length;y++){t.settingShengBo["settings"][p][y].coordinate;h.push.apply(h,g(t.settingShengBo["settings"][p][y].coordinate))}t.chartData["series"][0]["data"]=h}t.chartData.series[1].data[0]=[e.location.x,e.location.y]}else e.type&&"yanjiuyuan"==e.type?"{}"!=JSON.stringify(e.location)&&(console.log("yanjiuyuan----location:",{x:e.location.x.toFixed(2),y:e.location.y.toFixed(2)}),t.chartData.series[1].data=[[e.location.x,e.location.y]],"userId01"!=t.examinationTypeArrayType&&"testFile"!=t.examinationTypeArrayType||t.postLocation(e)):e.type&&"cangku"==e.type?(console.log("cangku----location:",e.location),t.chartData.series[1].data=[[e.location.x,e.location.y]],"userId01"!=t.examinationTypeArrayType&&"testFile"!=t.examinationTypeArrayType||t.postLocation(e)):e.type&&"IMU"==e.type?(console.log("进入IMU循环"),t.chartData.series[2].data=[[e.location.x,0]]):e.type&&"Fusion"==e.type?(console.log("进入Fusion循环"),t.chartData.series[3].data=[[e.location.x,e.location.y]]):(console.log("reslocation:",e.location),t.chartData["series"][1]["data"][0]=[e.location[0],e.location[1]]);break;case"console":break;case"fused-track":case"pdr_track":t.chartData.series[1].data=e.track;break;case"log":t.consoleText="["+(new Date).format("hh:mm:ss")+"]"+e.msg+"\n"+t.consoleText;break;case"debug":t.uploadJsonData(e.data,"debugData."+t.recordStartTime+".json");break;default:break}}))},initRecorderManager:function(){var e=this,a=t.getRecorderManager();this.recorderManager=a,a.onError((function(t){console.log(t)}));var o=this;a.onFrameRecorded((function(t){var a,i=t.frameBuffer;if(e.worker){if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType2D)a="frameBuffer2d";else if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1DThreeBeacon)a="frameBuffer1DThreeBeacon";else if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayType1D)a="frameBuffer1D";else if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeStadium)a="frameBuffer_stadium";else if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeSuzhou)a="frameBuffer_suzhou";else if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeShengBo)a="frameBuffer_shengbo";else if(e.LocationSceneTypeArrayType==n.LocationSceneTypeArrayTypeShengBo)a="frameBuffer_yanjiuyuan";else{if(e.LocationSceneTypeArrayType!=n.LocationSceneTypeArrayTypeYanjiuyuan)return void console.log("onFrameRecorded "+e.LocationSceneTypeArrayType+"未实现");a="frameBuffer_yanjiuyuan",e.LocationSceneTypeArrayType,n.LocationSceneTypeArrayTypeYanjiuyuan}var s=!1;"融合"==e.LocationTypeArrayType&&(s=!0),e.worker.postMessage({code:"updateRecordTime",recordStartTime:e.imuTimestamp}),e.worker.postMessage({code:a,data:i.slice(0),chartData:JSON.parse(JSON.stringify(o.chartData.series[0])),needFuse:s})}})),a.onStop((function(a){console.log(a);var o=e.fmtRecoderTime(a.duration);console.log("录音时长:"+o+"秒"),e.duration=o;t.getFileSystemManager();e.audioValue=a.tempFilePath;var i=e.version;console.log("version",i),"数据录制"===e.LocationTypeArrayType&&(wx.uploadFile({url:n.DEBUGUPLOADSERVER+"acoustic_loc/upload/?filename=acoustic."+e.recordStartTime+".pcm",name:"file",filePath:a.tempFilePath}),e.uploadJsonData(e.imuDataList,"imuData."+e.recordStartTime+".json"))}));var i=wx.createInnerAudioContext();this.innerAudioContext=i,i.onEnded((function(){e.playStatus=0})),i.onError((function(t){console.log(t)}))},destoryInnerAudioContext:function(){this.innerAudioContext.destroy(),console.log("音频实例销毁")},downloadFile:function(t){var e=null;return console.log("start download "+t),wx.downloadFile({url:t,success:function(t){200===t.statusCode&&(console.log("download"+t.tempFilePath),e=t.tempFilePath)},fail:function(t){console.log(t)}}),e},json_load:function(t){var e=[],a=wx.getFileSystemManager();return a.readFile({filePath:"".concat(t),success:function(t){e=JSON.parse(t.data)},fail:function(e){console.log("json-load "+t+" failed"),console.log(e)}}),e},postLocation:function(t){var e={beaconId:"1",seceneId:"2",userId:this.examinationTypeArrayType,xpos:t.location.x,ypos:t.location.y,zpos:0,originX:t.location.x,originY:t.location.y,originZ:0,timestamp:(0,s.formatDate)(new Date,"yyyy-MM-dd hh:mm:ss"),backup1:"backup1",backup2:"backup2",backup3:"backup3",backup4:"backup4",backup5:"backup5"};wx.request({url:"http://47.100.0.129:8066/infor/add",method:"POST",data:e,dataType:"json",success:function(t){console.log("postLocation success")},fail:function(t){console.log("postLocation fail")}})},getTrackData:function(t,e){var a=this;wx.request({url:t,data:{},method:"get",dataType:"json",success:function(t){console.log(a),a.worker.postMessage({code:"fuse",dataType:e,data:t.data})},fail:function(t){console.log("submit fail")},complete:function(){console.log("submit comlete")}})},testWithFile:function(){var t,e=this,a=(t={},c(t,n.LocationSceneTypeArrayType1DThreeBeacon,{url:n.DEBUGDOWNLOADSERVER+"static/data/acoustic_loc/standard/acoustic_1d_data.wav"}),c(t,n.LocationSceneTypeArrayType1D,{url:n.DEBUGDOWNLOADSERVER+"static/data/acoustic_loc/1d/20220109/Recording%20%23119.wav"}),c(t,n.LocationSceneTypeArrayType2D,{url:n.DEBUGDOWNLOADSERVER+"static/data/acoustic_loc/standard/acoustic_2d_data.wav"}),c(t,n.LocationSceneTypeArrayTypeStadium,{url:n.DEBUGDOWNLOADSERVER+"static/data/acoustic_loc/standard/stadium/forward_1.wav"}),c(t,n.LocationSceneTypeArrayTypeSuzhou,{url:n.DEBUGDOWNLOADSERVER+"static/data/acoustic_loc/suzhou/Q.wav"}),c(t,n.LocationSceneTypeArrayTypeShengBo,{url:n.DEBUGDOWNLOADSERVER+"static/data/acoustic_loc/shengbo/c2/20220328_c2/2_Recording%20%23129.wav"}),c(t,n.LocationSceneTypeArrayTypeCangKu,{url:"http://localhost:8088/file/download/B1517.wav"}),c(t,n.LocationSceneTypeArrayTypeYanjiuyuan,{url:"http://localhost:8088/file/download/yanjiuyuan.wav"}),t);if(null!==a[this.LocationSceneTypeArrayType]){if(["融合","声波"].includes(this.LocationTypeArrayType)){console.log(a),console.log(a[this.LocationSceneTypeArrayType]);var o=a[this.LocationSceneTypeArrayType].url,i=44;"pcm"==o.substr(o.length-3,3)&&(i=0),console.log("从服务器 "+o+" 下载文件"),wx.downloadFile({url:o,success:function(t){200==t.statusCode&&(console.log("成功下载文件"+t.tempFilePath),e.readFile(t.tempFilePath,0,i))}})}if(["融合","IMU"].includes(this.LocationTypeArrayType)){var s=a[this.LocationSceneTypeArrayType].imuDataUrl;console.log("Get imuData from "+s);var r=this;wx.request({url:s,data:{},method:"get",dataType:"json",success:function(t){r.worker.postMessage({code:"updateStepList",dataType:"imuDataList",imuDataList:t.data}),r.worker.postMessage({code:"timeCalibrate",timestamp:t.data[0].timestamp})},fail:function(t){console.log("submit fail")},complete:function(){console.log("submit comlete")}})}}},readFile:function(t,e){var a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:44,i=this.version;if("release"!=i&&null!=e&&!(e>=500)){var n=wx.getFileSystemManager(),s=!1;"融合"==this.LocationTypeArrayType&&(s=!0),n.readFile({filePath:"".concat(t),encoding:"binary",position:o+9600*e,length:9600,success:function(i){for(var n=[],r=0;r<i.data.length;r++)n.push(i.data.charCodeAt(r));a.worker.postMessage({code:"inputDataList",data:n.slice(0),locType:a.LocationSceneTypeArrayType,chartData:JSON.parse(JSON.stringify(a.chartData.series[0])),needFuse:s}),a.readFile(t,e+1,o)},fail:function(t){console.log(t)}})}},postStartRecordTime:function(){this.startTime=(new Date).getTime(),this.recordStartTime=this.startTime}},created:function(){var e=this;t.$on("updateSettingEvent",(function(t){if(t.locType==n.LocationSceneTypeArrayType2D)e.setting2D=t.setting2D,e.chartData["series"][0]["data"]=e.setting2D.coordinate,e.updateSetting();else if(t.locType==n.LocationSceneTypeArrayType1DThreeBeacon)e.setting1=t.setting1,e.setting2=t.setting2,e.chartData["series"][0]["data"][0]=e.setting1.coordinate[0],e.chartData["series"][0]["data"][1]=e.setting1.coordinate[1],e.chartData["series"][0]["data"][2]=e.setting2.coordinate[1],e.updateSetting();else if(t.locType==n.LocationSceneTypeArrayType1D)e.setting1D=t.setting1D,e.chartData["series"][0]["data"]=e.setting1D.coordinate,e.updateSetting();else if(t.locType==n.LocationSceneTypeArrayTypeSuzhou)e.settingSuzhou=t.settingSuzhou,e.chartData["series"][0]["data"]=e.settingSuzhou.coordinate,e.updateSetting();else if(t.locType==n.LocationSceneTypeArrayTypeShengBo){e.settingShengBo=t.settingShengBo;for(var a=[],o=0;o<e.settingShengBo["settings"][0].length;o++){var i=e.settingShengBo["settings"][0][o].coordinate;console.log("coordinate:",i),a.push.apply(a,g(e.settingShengBo["settings"][0][o].coordinate))}console.log("coordinates:",a),e.chartData["series"][0]["data"]=a,e.updateSetting()}else if(t.locType==n.LocationSceneTypeArrayTypeCangKu){e.settingCangKu=t.settingCangKu,e.commonParameters.alpha=t.alpha;for(var s=[],r=0;r<e.settingCangKu["settings"][0].length;r++){var c=e.settingCangKu["settings"][0][r].coordinate;console.log("coordinate:",c),s.push.apply(s,g(e.settingCangKu["settings"][0][r].coordinate))}console.log("coordinates:",s),e.chartData["series"][0]["data"]=s,e.updateSetting()}else if(t.locType==n.LocationSceneTypeArrayTypeYanjiuyuan){e.settingYanjiuyuan=t.settingYanjiuyuan,e.commonParameters.alpha=t.alpha;for(var u=[],l=0;l<e.settingYanjiuyuan["settings"][0].length;l++){var p=e.settingYanjiuyuan["settings"][0][l].coordinate;console.log("coordinate:",p),u.push.apply(u,g(e.settingYanjiuyuan["settings"][0][l].coordinate))}console.log("coordinates:",u),e.chartData["series"][0]["data"]=u,e.updateSetting()}}))}};e.default=w}).call(this,a("543d")["default"])},e0b3:function(t,e,a){},f5ea:function(t,e,a){"use strict";var o=a("33a5"),i=a.n(o);i.a},f75a:function(t,e,a){"use strict";a.r(e);var o=a("4592"),i=a("8069");for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("f5ea");var s,r=a("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"48fd58e4",null,!1,o["a"],s);e["default"]=c.exports}},[["47ed","common/runtime","common/vendor"]]]);